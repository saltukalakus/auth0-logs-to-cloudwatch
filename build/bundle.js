module.exports=function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=61)}([function(t,e){t.exports=require("auth0-extension-tools@1.2.1")},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(14);n(103),n(104),n(105),n(106),n(107),n(108),n(109),n(110),n(113),n(111),n(112),t.exports=r},function(t,e,n){"use strict";t.exports=n(0).config()},function(t,e,n){const r=n(50),o=n(18),i=n(43),s=n(49);t.exports.createServer=r.createServer,t.exports.urlHelpers=o,t.exports.middlewares=i,t.exports.routes=s},function(t,e){t.exports=require("express@4.12.4")},function(t,e,n){"use strict";var r=n(134);r.emitErrs=!0;var o=new r.Logger({transports:[new r.transports.Console({timestamp:!0,level:"debug",handleExceptions:!0,json:!1,colorize:!0})],exitOnError:!1});t.exports=o,t.exports.stream={write:function(t){o.info(t.replace(/\n$/,""))}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.JwksClient=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(15),c=r(u),a=n(36),l=r(a),f=n(27),h=(r(f),n(28)),p=r(h),d=n(30),v=r(d),m=n(95),y=n(97);e.JwksClient=function(){function t(e){var n=this;o(this,t),this.getSigningKey=function(t,e){n.logger("Fetching signing key for '"+t+"'"),n.getSigningKeys(function(r,o){if(r)return e(r);var i=o.find(function(e){return e.kid===t});return i?e(null,i):(n.logger("Unable to find a signing key that matches '"+t+"'"),e(new v.default("Unable to find a signing key that matches '"+t+"'")))})},this.options=i({rateLimit:!1,cache:!1,strictSsl:!0},e),this.logger=(0,c.default)("jwks"),this.options.rateLimit&&(this.getSigningKey=(0,y.rateLimitSigningKey)(this,e)),this.options.cache&&(this.getSigningKey=(0,y.cacheSigningKey)(this,e))}return s(t,[{key:"getKeys",value:function(t){var e=this;this.logger("Fetching keys from '"+this.options.jwksUri+"'"),(0,l.default)({json:!0,uri:this.options.jwksUri,strictSSL:this.options.strictSsl},function(n,r){return n||r.statusCode<200||r.statusCode>=300?(e.logger("Failure:",r&&r.body||n),t(r?new p.default(r.body&&(r.body.message||r.body)||r.statusMessage||"Http Error "+r.statusCode):n)):(e.logger("Keys:",r.body.keys),t(null,r.body.keys))})}},{key:"getSigningKeys",value:function(t){var e=this;this.getKeys(function(n,r){if(n)return t(n);if(!r||!r.length)return t(new p.default("The JWKS endpoint did not contain any keys"));var o=r.filter(function(t){return"sig"===t.use&&"RSA"===t.kty&&t.kid&&(t.x5c&&t.x5c.length||t.n&&t.e)}).map(function(t){return t.x5c&&t.x5c.length?{kid:t.kid,nbf:t.nbf,publicKey:(0,m.certToPEM)(t.x5c[0])}:{kid:t.kid,nbf:t.nbf,rsaPublicKey:(0,m.rsaPublicKeyToPEM)(t.n,t.e)}});return o.length?(e.logger("Signing Keys:",o),t(null,o)):t(new p.default("The JWKS endpoint did not contain any signing keys"))})}}]),t}()},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.SigningKeyNotFoundError=e.JwksRateLimitError=e.JwksError=e.ArgumentError=void 0;var o=n(27),i=r(o),s=n(28),u=r(s),c=n(29),a=r(c),l=n(30),f=r(l);e.ArgumentError=i.default,e.JwksError=u.default,e.JwksRateLimitError=a.default,e.SigningKeyNotFoundError=f.default},function(t,e){var n=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)},function(t,e,n){t.exports=!n(11)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){(function(t){var r;(function(o){function i(t){for(var e=[],n=0,r=t.length;n<r;n++)e.push(t[n]);return e}function u(t,e){if(ct&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(ft)){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var o=n.join("\n"+ft+"\n");t.stack=c(o)}}function c(t){for(var e=t.split("\n"),n=[],r=0,o=e.length;r<o;r++){var i=e[r];a(i)||l(i)||!i||n.push(i)}return n.join("\n")}function a(t){var e=h(t);if(!e)return!1;var n=e[0],r=e[1];return n===at&&r>=lt&&r<=jn}function l(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function f(){if(ct)try{throw new Error}catch(r){var t=r.stack.split("\n"),e=t[0].indexOf("@")>0?t[1]:t[2],n=h(e);if(!n)return;return at=n[0],n[1]}}function h(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function p(t){var e=[];if(!zt(t))return e;Ft.nonEnumArgs&&t.length&&Kt(t)&&(t=Ht.call(t));var n=Ft.enumPrototypes&&"function"==typeof t,r=Ft.enumErrorProps&&(t===qt||t instanceof Error);for(var o in t)n&&"prototype"==o||r&&("message"==o||"name"==o)||e.push(o);if(Ft.nonEnumShadows&&t!==Wt){var i=t.constructor,s=-1,u=kt;if(t===(i&&i.prototype))var c=t===Mt?jt:t===qt?Tt:Lt.call(t),a=Ut[c];for(;++s<u;)o=St[s],a&&a[o]||!Pt.call(t,o)||e.push(o)}return e}function d(t,e,n){for(var r=-1,o=n(t),i=o.length;++r<i;){var s=o[r];if(!1===e(t[s],s,t))break}return t}function v(t,e){return d(t,e,p)}function m(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function y(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;var o=typeof t,i=typeof e;if(t===t&&(null==t||null==e||"function"!=o&&"object"!=o&&"function"!=i&&"object"!=i))return!1;var s=Lt.call(t),u=Lt.call(e);if(s==Ct&&(s=Rt),u==Ct&&(u=Rt),s!=u)return!1;switch(s){case Nt:case _t:return+t==+e;case Ot:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case Dt:case jt:return t==String(e)}var c=s==At;if(!c){if(s!=Rt||!Ft.nodeClass&&(m(t)||m(e)))return!1;var a=!Ft.argsObject&&Kt(t)?Object:t.constructor,l=!Ft.argsObject&&Kt(e)?Object:e.constructor;if(!(a==l||Pt.call(t,"constructor")&&Pt.call(e,"constructor")||ut(a)&&a instanceof a&&ut(l)&&l instanceof l||!("constructor"in t&&"constructor"in e)))return!1}n||(n=[]),r||(r=[]);for(var f=n.length;f--;)if(n[f]==t)return r[f]==e;var h=0,p=!0;if(n.push(t),r.push(e),c){if(f=t.length,h=e.length,p=h==f)for(;h--;){var d=e[h];if(!(p=y(t[h],d,n,r)))break}}else v(e,function(e,o,i){if(Pt.call(i,o))return h++,p=Pt.call(t,o)&&y(t[o],e,n,r)}),p&&v(t,function(t,e,n){if(Pt.call(n,e))return p=--h>-1});return n.pop(),r.pop(),p}function b(t,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=e();return n}function g(){try{return Vt.apply(this,arguments)}catch(t){return Yt.e=t,Yt}}function w(t){if(!ut(t))throw new TypeError("fn must be a function");return Vt=t,g}function x(t){throw t}function E(t,e){this.id=t,this.value=e}function S(t,e){this.scheduler=t,this.disposable=e,this.isDisposed=!1}function k(t,e){e.isDisposed||(e.isDisposed=!0,e.disposable.dispose())}function C(t){this._s=s}function A(t){this._s=s,this._l=s.length,this._i=0}function N(t){this._a=t}function _(t){this._a=t,this._l=D(t),this._i=0}function T(t){return"number"==typeof t&&G.isFinite(t)}function O(t){var e,n=t[bt];if(!n&&"string"==typeof t)return e=new C(t),e[bt]();if(!n&&t.length!==o)return e=new N(t),e[bt]();if(!n)throw new TypeError("Object is not iterable");return t[bt]()}function R(t){var e=+t;return 0===e?e:isNaN(e)?e:e<0?-1:1}function D(t){var e=+t.length;return isNaN(e)?0:0!==e&&T(e)?(e=R(e)*Math.floor(Math.abs(e)),e<=0?0:e>Qe?Qe:e):e}function j(t,e){this.observer=t,this.parent=e}function L(t,e){return pe(t)||(t=ye),new Xe(e,t)}function P(t,e){this.observer=t,this.parent=e}function I(t,e){this.observer=t,this.parent=e}function q(t,e){return new _n(function(n){var r=new ue,o=new ce;return o.setDisposable(r),r.setDisposable(t.subscribe(function(t){n.onNext(t)},function(t){try{var r=e(t)}catch(t){return n.onError(t)}st(r)&&(r=Ke(r));var i=new ue;o.setDisposable(i),i.setDisposable(r.subscribe(n))},function(t){n.onCompleted(t)})),o},t)}function W(){return!1}function M(t,e){var n=this;return new _n(function(r){var o=0,i=t.length;return n.subscribe(function(n){if(o<i){var s=t[o++],u=w(e)(n,s);if(u===Yt)return r.onError(u.e);r.onNext(u)}else r.onCompleted()},function(t){r.onError(t)},function(){r.onCompleted()})},n)}function W(){return!1}function B(){return[]}function W(){return!1}function U(){return[]}function F(t,e){this.observer=t,this.accumulator=e.accumulator,this.hasSeed=e.hasSeed,this.seed=e.seed,this.hasAccumulation=!1,this.accumulation=null,this.hasValue=!1,this.isStopped=!1}function z(t,e,n){var r=Et(e,n,3);return t.map(function(e,n){var o=r(e,n,t);return st(o)&&(o=Ke(o)),(xt(o)||wt(o))&&(o=Ye(o)),o}).concatAll()}function K(t,e,n){for(var r=0,o=t.length;r<o;r++)if(n(t[r],e))return r;return-1}function V(t){this.comparer=t,this.set=[]}function J(t,e,n){var r=Et(e,n,3);return t.map(function(e,n){var o=r(e,n,t);return st(o)&&(o=Ke(o)),(xt(o)||wt(o))&&(o=Ye(o)),o}).mergeAll()}var H={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},G=H[typeof window]&&window||this,$=H[typeof e]&&e&&!e.nodeType&&e,Q=H[typeof t]&&t&&!t.nodeType&&t,Y=Q&&Q.exports===$&&$,X=H[typeof global]&&global;!X||X.global!==X&&X.window!==X||(G=X);var Z={internals:{},config:{Promise:G.Promise},helpers:{}},tt=Z.helpers.noop=function(){},et=(Z.helpers.notDefined=function(t){return void 0===t},Z.helpers.identity=function(t){return t}),nt=(Z.helpers.pluck=function(t){return function(e){return e[t]}},Z.helpers.just=function(t){return function(){return t}},Z.helpers.defaultNow=Date.now),rt=Z.helpers.defaultComparer=function(t,e){return Jt(t,e)},ot=Z.helpers.defaultSubComparer=function(t,e){return t>e?1:t<e?-1:0},it=(Z.helpers.defaultKeySerializer=function(t){return t.toString()},Z.helpers.defaultError=function(t){throw t}),st=Z.helpers.isPromise=function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then},ut=(Z.helpers.asArray=function(){return Array.prototype.slice.call(arguments)},Z.helpers.not=function(t){return!t},Z.helpers.isFunction=function(){var t=function(t){return"function"==typeof t||!1};return t(/x/)&&(t=function(t){return"function"==typeof t&&"[object Function]"==Lt.call(t)}),t}());Z.config.longStackSupport=!1;var ct=!1;try{throw new Error}catch(t){ct=!!t.stack}var at,lt=f(),ft="From previous event:";(Z.EmptyError=function(){this.message="Sequence contains no elements.",Error.call(this)}).prototype=Error.prototype;var ht=Z.ObjectDisposedError=function(){this.message="Object has been disposed",Error.call(this)};ht.prototype=Error.prototype;var pt=Z.ArgumentOutOfRangeError=function(){this.message="Argument out of range",Error.call(this)};pt.prototype=Error.prototype;var dt=Z.NotSupportedError=function(t){this.message=t||"This operation is not supported",Error.call(this)};dt.prototype=Error.prototype;var vt=Z.NotImplementedError=function(t){this.message=t||"This operation is not implemented",Error.call(this)};vt.prototype=Error.prototype;var mt=Z.helpers.notImplemented=function(){throw new vt},yt=Z.helpers.notSupported=function(){throw new dt},bt="function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_";G.Set&&"function"==typeof(new G.Set)["@@iterator"]&&(bt="@@iterator");var gt=Z.doneEnumerator={done:!0,value:o},wt=Z.helpers.isIterable=function(t){return t[bt]!==o},xt=Z.helpers.isArrayLike=function(t){return t&&t.length!==o};Z.helpers.iterator=bt;var Et=Z.internals.bindCallback=function(t,e,n){if(void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},St=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],kt=St.length,Ct="[object Arguments]",At="[object Array]",Nt="[object Boolean]",_t="[object Date]",Tt="[object Error]",Ot="[object Number]",Rt="[object Object]",Dt="[object RegExp]",jt="[object String]",Lt=Object.prototype.toString,Pt=Object.prototype.hasOwnProperty,It=Lt.call(arguments)==Ct,qt=Error.prototype,Wt=Object.prototype,Mt=String.prototype,Bt=Wt.propertyIsEnumerable;try{!(Lt.call(document)==Rt&&!({toString:0}+""))}catch(t){!0}var Ut={};Ut[At]=Ut[_t]=Ut[Ot]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},Ut[Nt]=Ut[jt]={constructor:!0,toString:!0,valueOf:!0},Ut[Tt]=Ut["[object Function]"]=Ut[Dt]={constructor:!0,toString:!0},Ut[Rt]={constructor:!0};var Ft={};!function(){var t=function(){this.x=1},e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments);Ft.enumErrorProps=Bt.call(qt,"message")||Bt.call(qt,"name"),Ft.enumPrototypes=Bt.call(t,"prototype"),Ft.nonEnumArgs=0!=n,Ft.nonEnumShadows=!/valueOf/.test(e)}(1);var zt=Z.internals.isObject=function(t){var e=typeof t;return t&&("function"==e||"object"==e)||!1},Kt=function(t){return!(!t||"object"!=typeof t)&&Lt.call(t)==Ct};It||(Kt=function(t){return!(!t||"object"!=typeof t)&&Pt.call(t,"callee")});var Vt,Jt=Z.internals.isEqual=function(t,e){return y(t,e,[],[])},Ht=Array.prototype.slice,Gt=this.inherits=Z.internals.inherits=function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n},$t=Z.internals.addProperties=function(t){for(var e=[],n=1,r=arguments.length;n<r;n++)e.push(arguments[n]);for(var o=0,i=e.length;o<i;o++){var s=e[o];for(var u in s)t[u]=s[u]}},Qt=Z.internals.addRef=function(t,e){return new _n(function(n){return new te(e.getDisposable(),t.subscribe(n))})},Yt={e:{}};E.prototype.compareTo=function(t){var e=this.value.compareTo(t.value);return 0===e&&(e=this.id-t.id),e};var Xt=Z.internals.PriorityQueue=function(t){this.items=new Array(t),this.length=0},Zt=Xt.prototype;Zt.isHigherPriority=function(t,e){return this.items[t].compareTo(this.items[e])<0},Zt.percolate=function(t){if(!(t>=this.length||t<0)){var e=t-1>>1;if(!(e<0||e===t)&&this.isHigherPriority(t,e)){var n=this.items[t];this.items[t]=this.items[e],this.items[e]=n,this.percolate(e)}}},Zt.heapify=function(t){if(+t||(t=0),!(t>=this.length||t<0)){var e=2*t+1,n=2*t+2,r=t;if(e<this.length&&this.isHigherPriority(e,r)&&(r=e),n<this.length&&this.isHigherPriority(n,r)&&(r=n),r!==t){var o=this.items[t];this.items[t]=this.items[r],this.items[r]=o,this.heapify(r)}}},Zt.peek=function(){return this.items[0].value},Zt.removeAt=function(t){this.items[t]=this.items[--this.length],this.items[this.length]=o,this.heapify()},Zt.dequeue=function(){var t=this.peek();return this.removeAt(0),t},Zt.enqueue=function(t){var e=this.length++;this.items[e]=new E(Xt.count++,t),this.percolate(e)},Zt.remove=function(t){for(var e=0;e<this.length;e++)if(this.items[e].value===t)return this.removeAt(e),!0;return!1},Xt.count=0;var te=Z.CompositeDisposable=function(){var t,e,n=[];if(Array.isArray(arguments[0]))n=arguments[0],e=n.length;else for(e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];for(t=0;t<e;t++)if(!ie(n[t]))throw new TypeError("Not a disposable");this.disposables=n,this.isDisposed=!1,this.length=n.length},ee=te.prototype;ee.add=function(t){this.isDisposed?t.dispose():(this.disposables.push(t),this.length++)},ee.remove=function(t){var e=!1;if(!this.isDisposed){var n=this.disposables.indexOf(t);-1!==n&&(e=!0,this.disposables.splice(n,1),this.length--,t.dispose())}return e},ee.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=this.disposables.length,e=new Array(t),n=0;n<t;n++)e[n]=this.disposables[n];for(this.disposables=[],this.length=0,n=0;n<t;n++)e[n].dispose()}};var ne=Z.Disposable=function(t){this.isDisposed=!1,this.action=t||tt};ne.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var re=ne.create=function(t){return new ne(t)},oe=ne.empty={dispose:tt},ie=ne.isDisposable=function(t){return t&&ut(t.dispose)},se=ne.checkDisposed=function(t){if(t.isDisposed)throw new ht},ue=Z.SingleAssignmentDisposable=function(){this.isDisposed=!1,this.current=null};ue.prototype.getDisposable=function(){return this.current},ue.prototype.setDisposable=function(t){if(this.current)throw new Error("Disposable has already been assigned");var e=this.isDisposed;!e&&(this.current=t),e&&t&&t.dispose()},ue.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null}t&&t.dispose()};var ce=Z.SerialDisposable=function(){this.isDisposed=!1,this.current=null};ce.prototype.getDisposable=function(){return this.current},ce.prototype.setDisposable=function(t){var e=this.isDisposed;if(!e){var n=this.current;this.current=t}n&&n.dispose(),e&&t&&t.dispose()},ce.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null}t&&t.dispose()};var ae=Z.RefCountDisposable=function(){function t(t){this.disposable=t,this.disposable.count++,this.isInnerDisposed=!1}function e(t){this.underlyingDisposable=t,this.isDisposed=!1,this.isPrimaryDisposed=!1,this.count=0}return t.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,0===--this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))},e.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))},e.prototype.getDisposable=function(){return this.isDisposed?oe:new t(this)},e}();S.prototype.dispose=function(){this.scheduler.scheduleWithState(this,k)};var le=Z.internals.ScheduledItem=function(t,e,n,r,o){this.scheduler=t,this.state=e,this.action=n,this.dueTime=r,this.comparer=o||ot,this.disposable=new ue};le.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())},le.prototype.compareTo=function(t){return this.comparer(this.dueTime,t.dueTime)},le.prototype.isCancelled=function(){return this.disposable.isDisposed},le.prototype.invokeCore=function(){return this.action(this.scheduler,this.state)};var fe=Z.Scheduler=function(){function t(t,e,n,r){this.now=t,this._schedule=e,this._scheduleRelative=n,this._scheduleAbsolute=r}function e(t,e){return e(),oe}t.isScheduler=function(e){return e instanceof t};var n=t.prototype;return n.schedule=function(t){return this._schedule(t,e)},n.scheduleWithState=function(t,e){return this._schedule(t,e)},n.scheduleWithRelative=function(t,n){return this._scheduleRelative(n,t,e)},n.scheduleWithRelativeAndState=function(t,e,n){return this._scheduleRelative(t,e,n)},n.scheduleWithAbsolute=function(t,n){return this._scheduleAbsolute(n,t,e)},n.scheduleWithAbsoluteAndState=function(t,e,n){return this._scheduleAbsolute(t,e,n)},t.now=nt,t.normalize=function(t){return t<0&&(t=0),t},t}(),he=fe.normalize,pe=fe.isScheduler;!function(t){function e(t,e){function n(e){o(e,function(e){var r=!1,o=!1,s=t.scheduleWithState(e,function(t,e){return r?i.remove(s):o=!0,n(e),oe});o||(i.add(s),r=!0)})}var r=e[0],o=e[1],i=new te;return n(r),i}function n(t,e,n){function r(e){i(e,function(e,o){var i=!1,u=!1,c=t[n](e,o,function(t,e){return i?s.remove(c):u=!0,r(e),oe});u||(s.add(c),i=!0)})}var o=e[0],i=e[1],s=new te;return r(o),s}function r(t,e){t(function(n){e(t,n)})}t.scheduleRecursive=function(t){return this.scheduleRecursiveWithState(t,r)},t.scheduleRecursiveWithState=function(t,n){return this.scheduleWithState([t,n],e)},t.scheduleRecursiveWithRelative=function(t,e){return this.scheduleRecursiveWithRelativeAndState(e,t,r)},t.scheduleRecursiveWithRelativeAndState=function(t,e,r){return this._scheduleRelative([t,r],e,function(t,e){return n(t,e,"scheduleWithRelativeAndState")})},t.scheduleRecursiveWithAbsolute=function(t,e){return this.scheduleRecursiveWithAbsoluteAndState(e,t,r)},t.scheduleRecursiveWithAbsoluteAndState=function(t,e,r){return this._scheduleAbsolute([t,r],e,function(t,e){return n(t,e,"scheduleWithAbsoluteAndState")})}}(fe.prototype),function(t){fe.prototype.schedulePeriodic=function(t,e){return this.schedulePeriodicWithState(null,t,e)},fe.prototype.schedulePeriodicWithState=function(t,e,n){if(void 0===G.setInterval)throw new dt;e=he(e);var r=t,o=G.setInterval(function(){r=n(r)},e);return re(function(){G.clearInterval(o)})}}(fe.prototype),function(t){t.catchError=t.catch=function(t){return new xe(this,t)}}(fe.prototype);var de,ve,me=(Z.internals.SchedulePeriodicRecursive=function(){function t(t,e){e(0,this._period);try{this._state=this._action(this._state)}catch(t){throw this._cancel.dispose(),t}}function e(t,e,n,r){this._scheduler=t,this._state=e,this._period=n,this._action=r}return e.prototype.start=function(){var e=new ue;return this._cancel=e,e.setDisposable(this._scheduler.scheduleRecursiveWithRelativeAndState(0,this._period,t.bind(this))),e},e}(),fe.immediate=function(){function t(t,e){return e(this,t)}return new fe(nt,t,yt,yt)}()),ye=fe.currentThread=function(){function t(){for(;n.length>0;){var t=n.dequeue();!t.isCancelled()&&t.invoke()}}function e(e,r){var o=new le(this,e,r,this.now());if(n)n.enqueue(o);else{n=new Xt(4),n.enqueue(o);var i=w(t)();if(n=null,i===Yt)return x(i.e)}return o.disposable}var n,r=new fe(nt,e,yt,yt);return r.scheduleRequired=function(){return!n},r}(),be=function(){var t,e=tt;if(G.setTimeout)t=G.setTimeout,e=G.clearTimeout;else{if(!G.WScript)throw new dt;t=function(t,e){G.WScript.Sleep(e),t()}}return{setTimeout:t,clearTimeout:e}}(),ge=be.setTimeout,we=be.clearTimeout;!function(){function t(e){if(o)ge(function(){t(e)},0);else{var n=r[e];if(n){o=!0;var i=w(n)();if(ve(e),o=!1,i===Yt)return x(i.e)}}}function e(e){"string"==typeof e.data&&e.data.substring(0,u.length)===u&&t(e.data.substring(u.length))}var n=1,r={},o=!1;ve=function(t){delete r[t]};var i=RegExp("^"+String(Lt).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),s="function"==typeof(s=X&&Y&&X.setImmediate)&&!i.test(s)&&s;if(ut(s))de=function(e){var o=n++;return r[o]=e,s(function(){t(o)}),o};else if("undefined"!=typeof process&&"[object process]"==={}.toString.call(process))de=function(e){var o=n++;return r[o]=e,process.nextTick(function(){t(o)}),o};else if(function(){if(!G.postMessage||G.importScripts)return!1;var t=!1,e=G.onmessage;return G.onmessage=function(){t=!0},G.postMessage("","*"),G.onmessage=e,t}()){var u="ms.rx.schedule"+Math.random();G.addEventListener?G.addEventListener("message",e,!1):G.attachEvent?G.attachEvent("onmessage",e):G.onmessage=e,de=function(t){var e=n++;return r[e]=t,G.postMessage(u+currentId,"*"),e}}else if(G.MessageChannel){var c=new G.MessageChannel;c.port1.onmessage=function(e){t(e.data)},de=function(t){var e=n++;return r[e]=t,c.port2.postMessage(e),e}}else de="document"in G&&"onreadystatechange"in G.document.createElement("script")?function(e){var o=G.document.createElement("script"),i=n++;return r[i]=e,o.onreadystatechange=function(){t(i),o.onreadystatechange=null,o.parentNode.removeChild(o),o=null},G.document.documentElement.appendChild(o),i}:function(e){var o=n++;return r[o]=e,ge(function(){t(o)},0),o}}();var xe=(fe.timeout=fe.default=function(){function t(t,e){var n=this,r=new ue,o=de(function(){!r.isDisposed&&r.setDisposable(e(n,t))});return new te(r,re(function(){ve(o)}))}function e(t,e,n){var r=this,o=fe.normalize(e),i=new ue;if(0===o)return r.scheduleWithState(t,n);var s=ge(function(){!i.isDisposed&&i.setDisposable(n(r,t))},o);return new te(i,re(function(){we(s)}))}function n(t,e,n){return this.scheduleWithRelativeAndState(t,e-this.now(),n)}return new fe(nt,t,e,n)}(),function(t){function e(t,e){return this._scheduler.scheduleWithState(t,this._wrap(e))}function n(t,e,n){return this._scheduler.scheduleWithRelativeAndState(t,e,this._wrap(n))}function r(t,e,n){return this._scheduler.scheduleWithAbsoluteAndState(t,e,this._wrap(n))}function o(o,i){this._scheduler=o,this._handler=i,this._recursiveOriginal=null,this._recursiveWrapper=null,t.call(this,this._scheduler.now.bind(this._scheduler),e,n,r)}return Gt(o,t),o.prototype._clone=function(t){return new o(t,this._handler)},o.prototype._wrap=function(t){var e=this;return function(n,r){try{return t(e._getRecursiveWrapper(n),r)}catch(t){if(!e._handler(t))throw t;return oe}}},o.prototype._getRecursiveWrapper=function(t){if(this._recursiveOriginal!==t){this._recursiveOriginal=t;var e=this._clone(t);e._recursiveOriginal=t,e._recursiveWrapper=e,this._recursiveWrapper=e}return this._recursiveWrapper},o.prototype.schedulePeriodicWithState=function(t,e,n){var r=this,o=!1,i=new ue;return i.setDisposable(this._scheduler.schedulePeriodicWithState(t,e,function(t){if(o)return null;try{return n(t)}catch(t){if(o=!0,!r._handler(t))throw t;return i.dispose(),null}})),i},o}(fe)),Ee=Z.Notification=function(){function t(t,e,n,r,o,i){this.kind=t,this.value=e,this.exception=n,this._accept=r,this._acceptObservable=o,this.toString=i}return t.prototype.accept=function(t,e,n){return t&&"object"==typeof t?this._acceptObservable(t):this._accept(t,e,n)},t.prototype.toObservable=function(t){var e=this;return pe(t)||(t=me),new _n(function(n){return t.scheduleWithState(e,function(t,e){e._acceptObservable(n),"N"===e.kind&&n.onCompleted()})})},t}(),Se=Ee.createOnNext=function(){function t(t){return t(this.value)}function e(t){return t.onNext(this.value)}function n(){return"OnNext("+this.value+")"}return function(r){return new Ee("N",r,null,t,e,n)}}(),ke=Ee.createOnError=function(){function t(t,e){return e(this.exception)}function e(t){return t.onError(this.exception)}function n(){return"OnError("+this.exception+")"}return function(r){return new Ee("E",null,r,t,e,n)}}(),Ce=Ee.createOnCompleted=function(){function t(t,e,n){return n()}function e(t){return t.onCompleted()}function n(){return"OnCompleted()"}return function(){return new Ee("C",null,null,t,e,n)}}(),Ae=Z.Observer=function(){};Ae.prototype.toNotifier=function(){var t=this;return function(e){return e.accept(t)}},Ae.prototype.asObserver=function(){return new Oe(this.onNext.bind(this),this.onError.bind(this),this.onCompleted.bind(this))},Ae.prototype.checked=function(){return new Re(this)};var Ne=Ae.create=function(t,e,n){return t||(t=tt),e||(e=it),n||(n=tt),new Oe(t,e,n)};Ae.fromNotifier=function(t,e){return new Oe(function(n){return t.call(e,Se(n))},function(n){return t.call(e,ke(n))},function(){return t.call(e,Ce())})},Ae.prototype.notifyOn=function(t){return new je(t,this)},Ae.prototype.makeSafe=function(t){return new AnonymousSafeObserver(this._onNext,this._onError,this._onCompleted,t)};var _e,Te=Z.internals.AbstractObserver=function(t){function e(){this.isStopped=!1,t.call(this)}return Gt(e,t),e.prototype.next=mt,e.prototype.error=mt,e.prototype.completed=mt,e.prototype.onNext=function(t){this.isStopped||this.next(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.error(t))},e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.error(t),!0)},e}(Ae),Oe=Z.AnonymousObserver=function(t){function e(e,n,r){t.call(this),this._onNext=e,this._onError=n,this._onCompleted=r}return Gt(e,t),e.prototype.next=function(t){this._onNext(t)},e.prototype.error=function(t){this._onError(t)},e.prototype.completed=function(){this._onCompleted()},e}(Te),Re=function(t){function e(e){t.call(this),this._observer=e,this._state=0}Gt(e,t);var n=e.prototype;return n.onNext=function(t){this.checkAccess();var e=w(this._observer.onNext).call(this._observer,t);this._state=0,e===Yt&&x(e.e)},n.onError=function(t){this.checkAccess();var e=w(this._observer.onError).call(this._observer,t);this._state=2,e===Yt&&x(e.e)},n.onCompleted=function(){this.checkAccess();var t=w(this._observer.onCompleted).call(this._observer);this._state=2,t===Yt&&x(t.e)},n.checkAccess=function(){if(1===this._state)throw new Error("Re-entrancy detected");if(2===this._state)throw new Error("Observer completed");0===this._state&&(this._state=1)},e}(Ae),De=Z.internals.ScheduledObserver=function(t){function e(e,n){t.call(this),this.scheduler=e,this.observer=n,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new ce}return Gt(e,t),e.prototype.next=function(t){var e=this;this.queue.push(function(){e.observer.onNext(t)})},e.prototype.error=function(t){var e=this;this.queue.push(function(){e.observer.onError(t)})},e.prototype.completed=function(){var t=this;this.queue.push(function(){t.observer.onCompleted()})},e.prototype.ensureActive=function(){var t=!1,e=this;!this.hasFaulted&&this.queue.length>0&&(t=!this.isAcquired,this.isAcquired=!0),t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(function(t){var n;if(!(e.queue.length>0))return void(e.isAcquired=!1);n=e.queue.shift();try{n()}catch(t){throw e.queue=[],e.hasFaulted=!0,t}t()}))},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.disposable.dispose()},e}(Te),je=function(t){function e(e,n,r){t.call(this,e,n),this._cancel=r}return Gt(e,t),e.prototype.next=function(e){t.prototype.next.call(this,e),this.ensureActive()},e.prototype.error=function(e){t.prototype.error.call(this,e),this.ensureActive()},e.prototype.completed=function(){t.prototype.completed.call(this),this.ensureActive()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._cancel&&this._cancel.dispose(),this._cancel=null},e}(De),Le=Z.Observable=function(){function t(t){if(Z.config.longStackSupport&&ct){try{throw new Error}catch(t){this.stack=t.stack.substring(t.stack.indexOf("\n")+1)}var e=this;this._subscribe=function(n){var r=n.onError.bind(n);return n.onError=function(t){u(t,e),r(t)},t.call(e,n)}}else this._subscribe=t}return _e=t.prototype,_e.subscribe=_e.forEach=function(t,e,n){return this._subscribe("object"==typeof t?t:Ne(t,e,n))},_e.subscribeOnNext=function(t,e){return this._subscribe(Ne(void 0!==e?function(n){t.call(e,n)}:t))},_e.subscribeOnError=function(t,e){return this._subscribe(Ne(null,void 0!==e?function(n){t.call(e,n)}:t))},_e.subscribeOnCompleted=function(t,e){return this._subscribe(Ne(null,null,void 0!==e?function(){t.call(e)}:t))},t}(),Pe=Z.ObservableBase=function(t){function e(t){return t&&ut(t.dispose)?t:ut(t)?re(t):oe}function n(t,n){var r=n[0],o=n[1],i=w(o.subscribeCore).call(o,r);if(i===Yt&&!r.fail(Yt.e))return x(Yt.e);r.setDisposable(e(i))}function r(t){var e=new Tn(t),r=[e,this];return ye.scheduleRequired()?ye.scheduleWithState(r,n):n(null,r),e}function o(){t.call(this,r)}return Gt(o,t),o.prototype.subscribeCore=mt,o}(Le),Ie=Z.internals.Enumerable=function(){},qe=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e,n){this.o=t,this.s=e,this.e=n,this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){var e,r=new ce,o=me.scheduleRecursiveWithState(this.sources[bt](),function(o,i){if(!e){var s=w(o.next).call(o);if(s===Yt)return t.onError(s.e);if(s.done)return t.onCompleted();var u=s.value;st(u)&&(u=Ke(u));var c=new ue;r.setDisposable(c),c.setDisposable(u.subscribe(new n(t,i,o)))}});return new te(r,o,re(function(){e=!0}))},n.prototype.onNext=function(t){this.isStopped||this.o.onNext(t)},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.s(this.e))},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e}(Pe);Ie.prototype.concat=function(){return new qe(this)};var We=function(t){function e(e){this.sources=e,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){var e,n=this.sources[bt](),r=new ce,o=me.scheduleRecursiveWithState(null,function(o,i){if(!e){var s=w(n.next).call(n);if(s===Yt)return t.onError(s.e);if(s.done)return null!==o?t.onError(o):t.onCompleted();var u=s.value;st(u)&&(u=Ke(u));var c=new ue;r.setDisposable(c),c.setDisposable(u.subscribe(function(e){t.onNext(e)},i,function(){t.onCompleted()}))}});return new te(r,o,re(function(){e=!0}))},e}(Pe);Ie.prototype.catchError=function(){return new We(this)},Ie.prototype.catchErrorWhen=function(t){var e=this;return new _n(function(n){var r,o=new Rn,i=new Rn,s=t(o),u=s.subscribe(i),c=e[bt](),a=new ce,l=me.scheduleRecursive(function(t){if(!r){var e=w(c.next).call(c);if(e===Yt)return n.onError(e.e);if(e.done)return void n.onCompleted();var s=e.value;st(s)&&(s=Ke(s));var u=new ue,l=new ue;a.setDisposable(new te(l,u)),u.setDisposable(s.subscribe(function(t){n.onNext(t)},function(e){l.setDisposable(i.subscribe(t,function(t){n.onError(t)},function(){n.onCompleted()})),o.onNext(e)},function(){n.onCompleted()}))}});return new te(u,a,l,re(function(){r=!0}))})};var Me=function(t){function e(t,e){this.v=t,this.c=null==e?-1:e}function n(t){this.v=t.v,this.l=t.c}return Gt(e,t),e.prototype[bt]=function(){return new n(this)},n.prototype.next=function(){return 0===this.l?gt:(this.l>0&&this.l--,{done:!1,value:this.v})},e}(Ie),Be=Ie.repeat=function(t,e){return new Me(t,e)},Ue=function(t){function e(t,e,n){this.s=t,this.fn=e?Et(e,n,3):null}function n(t){this.i=-1,this.s=t.s,this.l=this.s.length,this.fn=t.fn}return Gt(e,t),e.prototype[bt]=function(){return new n(this)},n.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:gt},e}(Ie),Fe=Ie.of=function(t,e,n){return new Ue(t,e,n)};_e.observeOn=function(t){var e=this;return new _n(function(n){return e.subscribe(new je(t,n))},e)},_e.subscribeOn=function(t){var e=this;return new _n(function(n){var r=new ue,o=new ce;return o.setDisposable(r),r.setDisposable(t.schedule(function(){o.setDisposable(new S(t,e.subscribe(n)))})),o},e)};var ze=function(t){function e(e){this.p=e,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){return this.p.then(function(e){t.onNext(e),t.onCompleted()},function(e){t.onError(e)}),oe},e}(Pe),Ke=Le.fromPromise=function(t){return new ze(t)};_e.toPromise=function(t){if(t||(t=Z.config.Promise),!t)throw new dt("Promise type not provided nor in Rx.config.Promise");var e=this;return new t(function(t,n){var r,o=!1;e.subscribe(function(t){r=t,o=!0},n,function(){o&&t(r)})})};var Ve=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.a=[],this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},n.prototype.onNext=function(t){this.isStopped||this.a.push(t)},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onNext(this.a),this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e}(Pe);_e.toArray=function(){return new Ve(this)},Le.create=Le.createWithDisposable=function(t,e){return new _n(t,e)};var Je=(Le.defer=function(t){return new _n(function(e){var n;try{n=t()}catch(t){return an(t).subscribe(e)}return st(n)&&(n=Ke(n)),n.subscribe(e)})},function(t){function e(e){this.scheduler=e,t.call(this)}function n(t,e){this.observer=t,this.parent=e}function r(t,e){e.onCompleted()}return Gt(e,t),e.prototype.subscribeCore=function(t){return new n(t,this).run()},n.prototype.run=function(){return this.parent.scheduler.scheduleWithState(this.observer,r)},e}(Pe)),He=Le.empty=function(t){return pe(t)||(t=me),new Je(t)},Ge=function(t){function e(e,n,r){this.iterable=e,this.mapper=n,this.scheduler=r,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){return new $e(t,this).run()},e}(Pe),$e=function(){function t(t,e){this.observer=t,this.parent=e}return t.prototype.run=function(){function t(t,e){try{var i=n.next()}catch(t){return r.onError(t)}if(i.done)return r.onCompleted();var s=i.value;if(o)try{s=o(s,t)}catch(t){return r.onError(t)}r.onNext(s),e(t+1)}var e=Object(this.parent.iterable),n=O(e),r=this.observer,o=this.parent.mapper;return this.parent.scheduler.scheduleRecursiveWithState(0,t)},t}(),Qe=Math.pow(2,53)-1;C.prototype[bt]=function(){return new A(this._s)},A.prototype[bt]=function(){return this},A.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:gt},N.prototype[bt]=function(){return new _(this._a)},_.prototype[bt]=function(){return this},_.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:gt};var Ye=Le.from=function(t,e,n,r){if(null==t)throw new Error("iterable cannot be null.");if(e&&!ut(e))throw new Error("mapFn when provided must be a function");if(e)var o=Et(e,n,2);return pe(r)||(r=ye),new Ge(t,o,r)},Xe=function(t){function e(e,n){this.args=e,this.scheduler=n,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){return new j(t,this).run()},e}(Pe);j.prototype.run=function(){function t(t,o){t<r?(e.onNext(n[t]),o(t+1)):e.onCompleted()}var e=this.observer,n=this.parent.args,r=n.length;return this.parent.scheduler.scheduleRecursiveWithState(0,t)};var Ze=Le.fromArray=function(t,e){return pe(e)||(e=ye),new Xe(t,e)};Le.generate=function(t,e,n,r,o){return pe(o)||(o=ye),new _n(function(i){var s=!0;return o.scheduleRecursiveWithState(t,function(t,o){var u,c;try{s?s=!1:t=n(t),u=e(t),u&&(c=r(t))}catch(t){return i.onError(t)}u?(i.onNext(c),o(t)):i.onCompleted()})})};var tn=function(t){function e(){t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){return oe},e}(Pe),en=Le.never=function(){return new tn};Le.of=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Xe(e,ye)},Le.ofWithScheduler=function(t){for(var e=arguments.length,n=new Array(e-1),r=1;r<e;r++)n[r-1]=arguments[r];return new Xe(n,t)};var nn=function(t){function e(e,n){this.obj=e,this.keys=Object.keys(e),this.scheduler=n,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){return new P(t,this).run()},e}(Pe);P.prototype.run=function(){function t(t,i){if(t<o){var s=r[t];e.onNext([s,n[s]]),i(t+1)}else e.onCompleted()}var e=this.observer,n=this.parent.obj,r=this.parent.keys,o=r.length;return this.parent.scheduler.scheduleRecursiveWithState(0,t)},Le.pairs=function(t,e){return e||(e=ye),new nn(t,e)};var rn=function(t){function e(e,n,r){this.start=e,this.rangeCount=n,this.scheduler=r,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){return new on(t,this).run()},e}(Pe),on=function(){function t(t,e){this.observer=t,this.parent=e}return t.prototype.run=function(){function t(t,o){t<n?(r.onNext(e+t),o(t+1)):r.onCompleted()}var e=this.parent.start,n=this.parent.rangeCount,r=this.observer;return this.parent.scheduler.scheduleRecursiveWithState(0,t)},t}();Le.range=function(t,e,n){return pe(n)||(n=ye),new rn(t,e,n)};var sn=function(t){function e(e,n,r){this.value=e,this.repeatCount=null==n?-1:n,this.scheduler=r,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){return new I(t,this).run()},e}(Pe);I.prototype.run=function(){function t(t,r){if((-1===t||t>0)&&(e.onNext(n),t>0&&t--),0===t)return e.onCompleted();r(t)}var e=this.observer,n=this.parent.value;return this.parent.scheduler.scheduleRecursiveWithState(this.parent.repeatCount,t)},Le.repeat=function(t,e,n){return pe(n)||(n=ye),new sn(t,e,n)};var un=function(t){function e(e,n){this.value=e,this.scheduler=n,t.call(this)}function n(t,e){this.observer=t,this.parent=e}function r(t,e){var n=e[0],r=e[1];r.onNext(n),r.onCompleted()}return Gt(e,t),e.prototype.subscribeCore=function(t){return new n(t,this).run()},n.prototype.run=function(){return this.parent.scheduler.scheduleWithState([this.parent.value,this.observer],r)},e}(Pe),cn=(Le.return=Le.just=Le.returnValue=function(t,e){return pe(e)||(e=me),new un(t,e)},function(t){function e(e,n){this.error=e,this.scheduler=n,t.call(this)}function n(t,e){this.o=t,this.p=e}function r(t,e){var n=e[0];e[1].onError(n)}return Gt(e,t),e.prototype.subscribeCore=function(t){return new n(t,this).run()},n.prototype.run=function(){return this.p.scheduler.scheduleWithState([this.p.error,this.o],r)},e}(Pe)),an=Le.throw=Le.throwError=Le.throwException=function(t,e){return pe(e)||(e=me),new cn(t,e)};Le.using=function(t,e){return new _n(function(n){var r,o,i=oe;try{r=t(),r&&(i=r),o=e(r)}catch(t){return new te(an(t).subscribe(n),i)}return new te(o.subscribe(n),i)})},_e.amb=function(t){var e=this;return new _n(function(n){function r(){i||(i=s,a.dispose())}function o(){i||(i=u,c.dispose())}var i,s="L",u="R",c=new ue,a=new ue;return st(t)&&(t=Ke(t)),c.setDisposable(e.subscribe(function(t){r(),i===s&&n.onNext(t)},function(t){r(),i===s&&n.onError(t)},function(){r(),i===s&&n.onCompleted()})),a.setDisposable(t.subscribe(function(t){o(),i===u&&n.onNext(t)},function(t){o(),i===u&&n.onError(t)},function(){o(),i===u&&n.onCompleted()})),new te(c,a)})},Le.amb=function(){var t=en(),e=[];if(Array.isArray(arguments[0]))e=arguments[0];else for(var n=0,r=arguments.length;n<r;n++)e.push(arguments[n]);for(var n=0,r=e.length;n<r;n++)t=function(t,e){return t.amb(e)}(t,e[n]);return t},_e.catch=_e.catchError=_e.catchException=function(t){return"function"==typeof t?q(this,t):ln([this,t])};var ln=Le.catchError=Le.catch=Le.catchException=function(){var t=[];if(Array.isArray(arguments[0]))t=arguments[0];else for(var e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return Fe(t).catchError()};_e.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Array.isArray(e[0])?e[0].unshift(this):e.unshift(this),fn.apply(this,e)};var fn=Le.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.pop();return Array.isArray(e[0])&&(e=e[0]),new _n(function(t){function n(e){if(u[e]=!0,c||(c=u.every(et))){try{var n=r.apply(null,l)}catch(e){return t.onError(e)}t.onNext(n)}else a.filter(function(t,n){return n!==e}).every(et)&&t.onCompleted()}function o(e){a[e]=!0,a.every(et)&&t.onCompleted()}for(var i=e.length,s=function(){return!1},u=b(i,s),c=!1,a=b(i,s),l=new Array(i),f=new Array(i),h=0;h<i;h++)!function(r){var i=e[r],s=new ue;st(i)&&(i=Ke(i)),s.setDisposable(i.subscribe(function(t){l[r]=t,n(r)},function(e){t.onError(e)},function(){o(r)})),f[r]=s}(h);return new te(f)},this)};_e.concat=function(){for(var t=[],e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return t.unshift(this),pn.apply(null,t)};var hn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){this.sources=t,this.o=e}return Gt(e,t),e.prototype.subscribeCore=function(t){return new n(this.sources,t).run()},n.prototype.run=function(){var t,e=new ce,n=this.sources,r=n.length,o=this.o,i=me.scheduleRecursiveWithState(0,function(i,s){if(!t){if(i===r)return o.onCompleted();var u=n[i];st(u)&&(u=Ke(u));var c=new ue;e.setDisposable(c),c.setDisposable(u.subscribe(function(t){o.onNext(t)},function(t){o.onError(t)},function(){s(i+1)}))}});return new te(e,i,re(function(){t=!0}))},e}(Pe),pn=Le.concat=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(arguments.length);for(var e=0,n=arguments.length;e<n;e++)t[e]=arguments[e]}return new hn(t)};_e.concatAll=_e.concatObservable=function(){return this.merge(1)};var dn=function(t){function e(e,n){this.source=e,this.maxConcurrent=n,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){var e=new te;return e.add(this.source.subscribe(new vn(t,this.maxConcurrent,e))),e},e}(Pe),vn=function(){function t(t,e,n){this.o=t,this.max=e,this.g=n,this.done=!1,this.q=[],this.activeCount=0,this.isStopped=!1}function e(t,e){this.parent=t,this.sad=e,this.isStopped=!1}return t.prototype.handleSubscribe=function(t){var n=new ue;this.g.add(n),st(t)&&(t=Ke(t)),n.setDisposable(t.subscribe(new e(this,n)))},t.prototype.onNext=function(t){this.isStopped||(this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(t)):this.q.push(t))},t.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},t.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.done=!0,0===this.activeCount&&this.o.onCompleted())},t.prototype.dispose=function(){this.isStopped=!0},t.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e.prototype.onNext=function(t){this.isStopped||this.parent.o.onNext(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.o.onError(t))},e.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var t=this.parent;t.g.remove(this.sad),t.q.length>0?t.handleSubscribe(t.q.shift()):(t.activeCount--,t.done&&0===t.activeCount&&t.o.onCompleted())}},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.parent.o.onError(t),!0)},t}();_e.merge=function(t){return"number"!=typeof t?mn(this,t):new dn(this,t)};var mn=Le.merge=function(){var t,e,n=[],r=arguments.length;if(arguments[0])if(pe(arguments[0]))for(t=arguments[0],e=1;e<r;e++)n.push(arguments[e]);else for(t=me,e=0;e<r;e++)n.push(arguments[e]);else for(t=me,e=1;e<r;e++)n.push(arguments[e]);return Array.isArray(n[0])&&(n=n[0]),L(t,n).mergeAll()},yn=Z.CompositeError=function(t){this.name="NotImplementedError",this.innerErrors=t,this.message="This contains multiple errors. Check the innerErrors",Error.call(this)};yn.prototype=Error.prototype,Le.mergeDelayError=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;n<e;n++)t[n]=arguments[n]}var r=L(null,t);return new _n(function(t){function e(){0===s.length?t.onCompleted():1===s.length?t.onError(s[0]):t.onError(new yn(s))}var n=new te,o=new ue,i=!1,s=[];return n.add(o),o.setDisposable(r.subscribe(function(r){var o=new ue;n.add(o),st(r)&&(r=Ke(r)),o.setDisposable(r.subscribe(function(e){t.onNext(e)},function(t){s.push(t),n.remove(o),i&&1===n.length&&e()},function(){n.remove(o),i&&1===n.length&&e()}))},function(t){s.push(t),i=!0,1===n.length&&e()},function(){i=!0,1===n.length&&e()})),n})};var bn=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.g=e,this.isStopped=!1,this.done=!1}function r(t,e,n){this.parent=t,this.g=e,this.sad=n,this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){var e=new te,r=new ue;return e.add(r),r.setDisposable(this.source.subscribe(new n(t,e))),e},n.prototype.onNext=function(t){if(!this.isStopped){var e=new ue;this.g.add(e),st(t)&&(t=Ke(t)),e.setDisposable(t.subscribe(new r(this,this.g,e)))}},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.done=!0,1===this.g.length&&this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},r.prototype.onNext=function(t){this.isStopped||this.parent.o.onNext(t)},r.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.o.onError(t))},r.prototype.onCompleted=function(){if(!this.isStopped){var t=this.parent;this.isStopped=!0,t.g.remove(this.sad),t.done&&1===t.g.length&&t.o.onCompleted()}},r.prototype.dispose=function(){this.isStopped=!0},r.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.parent.o.onError(t),!0)},e}(Pe);_e.mergeAll=_e.mergeObservable=function(){return new bn(this)},_e.onErrorResumeNext=function(t){if(!t)throw new Error("Second observable is required");return gn([this,t])};var gn=Le.onErrorResumeNext=function(){var t=[];if(Array.isArray(arguments[0]))t=arguments[0];else for(var e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return new _n(function(e){var n=0,r=new ce,o=me.scheduleRecursive(function(o){var i,s;n<t.length?(i=t[n++],st(i)&&(i=Ke(i)),s=new ue,r.setDisposable(s),s.setDisposable(i.subscribe(e.onNext.bind(e),o,o))):e.onCompleted()});return new te(r,o)})};_e.skipUntil=function(t){var e=this;return new _n(function(n){var r=!1,o=new te(e.subscribe(function(t){r&&n.onNext(t)},function(t){n.onError(t)},function(){r&&n.onCompleted()}));st(t)&&(t=Ke(t));var i=new ue;return o.add(i),i.setDisposable(t.subscribe(function(){r=!0,i.dispose()},function(t){n.onError(t)},function(){i.dispose()})),o},e)};var wn=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.inner=e,this.stopped=!1,this.latest=0,this.hasLatest=!1,this.isStopped=!1}function r(t,e){this.parent=t,this.id=e,this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){var e=new ce,r=this.source.subscribe(new n(t,e));return new te(r,e)},n.prototype.onNext=function(t){if(!this.isStopped){var e=new ue,n=++this.latest;this.hasLatest=!0,this.inner.setDisposable(e),st(t)&&(t=Ke(t)),e.setDisposable(t.subscribe(new r(this,n)))}},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.stopped=!0,!this.hasLatest&&this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},r.prototype.onNext=function(t){this.isStopped||this.parent.latest===this.id&&this.parent.o.onNext(t)},r.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.latest===this.id&&this.parent.o.onError(t))},r.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.isStopped&&this.parent.o.onCompleted()))},r.prototype.dispose=function(){this.isStopped=!0},r.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.parent.o.onError(t),!0)},e}(Pe);_e.switch=_e.switchLatest=function(){return new wn(this)};var xn=function(t){function e(e,n){this.source=e,this.other=st(n)?Ke(n):n,t.call(this)}function n(t){this.o=t,this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){return new te(this.source.subscribe(t),this.other.subscribe(new n(t)))},n.prototype.onNext=function(t){this.isStopped||this.o.onCompleted()},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){!this.isStopped&&(this.isStopped=!0)},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e}(Pe);_e.takeUntil=function(t){return new xn(this,t)},_e.withLatestFrom=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.pop(),o=this;return Array.isArray(e[0])&&(e=e[0]),new _n(function(t){for(var n=e.length,i=b(n,W),s=!1,u=new Array(n),c=new Array(n+1),a=0;a<n;a++)!function(n){var r=e[n],o=new ue;st(r)&&(r=Ke(r)),o.setDisposable(r.subscribe(function(t){u[n]=t,i[n]=!0,s=i.every(et)},function(e){t.onError(e)},tt)),c[n]=o}(a);var l=new ue;return l.setDisposable(o.subscribe(function(e){var n=[e].concat(u);if(s){var o=w(r).apply(null,n);if(o===Yt)return t.onError(o.e);t.onNext(o)}},function(e){t.onError(e)},function(){t.onCompleted()})),c[n]=l,new te(c)},this)},_e.zip=function(){if(Array.isArray(arguments[0]))return M.apply(this,arguments);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=this,o=e.pop();return e.unshift(r),new _n(function(t){for(var n=e.length,i=b(n,B),s=b(n,W),u=new Array(n),c=0;c<n;c++)!function(n){var c=e[n],a=new ue;st(c)&&(c=Ke(c)),a.setDisposable(c.subscribe(function(e){if(i[n].push(e),i.every(function(t){return t.length>0})){var u=i.map(function(t){return t.shift()}),c=w(o).apply(r,u);if(c===Yt)return t.onError(c.e);t.onNext(c)}else s.filter(function(t,e){return e!==n}).every(et)&&t.onCompleted()},function(e){t.onError(e)},function(){s[n]=!0,s.every(et)&&t.onCompleted()})),u[n]=a}(c);return new te(u)},r)},Le.zip=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.shift();return r.zip.apply(r,e)},Le.zipArray=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;n<e;n++)t[n]=arguments[n]}return new _n(function(e){for(var n=t.length,r=b(n,U),o=b(n,W),i=new Array(n),s=0;s<n;s++)!function(n){i[n]=new ue,i[n].setDisposable(t[n].subscribe(function(t){if(r[n].push(t),r.every(function(t){return t.length>0})){var i=r.map(function(t){return t.shift()});e.onNext(i)}else if(o.filter(function(t,e){return e!==n}).every(et))return e.onCompleted()},function(t){e.onError(t)},function(){o[n]=!0,o.every(et)&&e.onCompleted()}))}(s);return new te(i)})},_e.asObservable=function(){var t=this;return new _n(function(e){return t.subscribe(e)},t)},_e.bufferWithCount=function(t,e){return"number"!=typeof e&&(e=t),this.windowWithCount(t,e).selectMany(function(t){return t.toArray()}).where(function(t){return t.length>0})},_e.dematerialize=function(){var t=this;return new _n(function(e){return t.subscribe(function(t){return t.accept(e)},function(t){e.onError(t)},function(){e.onCompleted()})},this)},_e.distinctUntilChanged=function(t,e){var n=this;return e||(e=rt),new _n(function(r){var o,i=!1;return n.subscribe(function(n){var s=n;if(t&&(s=w(t)(n))===Yt)return r.onError(s.e);if(i){var u=w(e)(o,s);if(u===Yt)return r.onError(u.e)}i&&u||(i=!0,o=s,r.onNext(n))},function(t){r.onError(t)},function(){r.onCompleted()})},this)};var En=function(t){function e(e,n,r,o){this.source=e,this.t=!n||ut(n)?Ne(n||tt,r||tt,o||tt):n,t.call(this)}function n(t,e){this.o=t,this.t=e,this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.t))},n.prototype.onNext=function(t){if(!this.isStopped){var e=w(this.t.onNext).call(this.t,t);e===Yt&&this.o.onError(e.e),this.o.onNext(t)}},n.prototype.onError=function(t){if(!this.isStopped){this.isStopped=!0;var e=w(this.t.onError).call(this.t,t);if(e===Yt)return this.o.onError(e.e);this.o.onError(t)}},n.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var t=w(this.t.onCompleted).call(this.t);if(t===Yt)return this.o.onError(t.e);this.o.onCompleted()}},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e}(Pe);_e.do=_e.tap=_e.doAction=function(t,e,n){return new En(this,t,e,n)},_e.doOnNext=_e.tapOnNext=function(t,e){return this.tap(void 0!==e?function(n){t.call(e,n)}:t)},_e.doOnError=_e.tapOnError=function(t,e){return this.tap(tt,void 0!==e?function(n){t.call(e,n)}:t)},_e.doOnCompleted=_e.tapOnCompleted=function(t,e){return this.tap(tt,null,void 0!==e?function(){t.call(e)}:t)},_e.finally=_e.ensure=function(t){var e=this;return new _n(function(n){var r;try{r=e.subscribe(n)}catch(e){throw t(),e}return re(function(){try{r.dispose()}catch(t){throw t}finally{t()}})},this)},_e.finallyAction=function(t){return this.ensure(t)};var Sn=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},n.prototype.onNext=tt,n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.observer.onError(t),!0)},e}(Pe);_e.ignoreElements=function(){return new Sn(this)},_e.materialize=function(){var t=this;return new _n(function(e){return t.subscribe(function(t){e.onNext(Se(t))},function(t){e.onNext(ke(t)),e.onCompleted()},function(){e.onNext(Ce()),e.onCompleted()})},t)},_e.repeat=function(t){return Be(this,t).concat()},_e.retry=function(t){return Be(this,t).catchError()},_e.retryWhen=function(t){return Be(this).catchErrorWhen(t)};var kn=function(t){function e(e,n,r,o){this.source=e,this.accumulator=n,this.hasSeed=r,this.seed=o,t.call(this)}return Gt(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new F(t,this))},e}(Pe);F.prototype.onNext=function(t){if(!this.isStopped){!this.hasValue&&(this.hasValue=!0);try{this.hasAccumulation?this.accumulation=this.accumulator(this.accumulation,t):(this.accumulation=this.hasSeed?this.accumulator(this.seed,t):t,this.hasAccumulation=!0)}catch(t){return this.observer.onError(t)}this.observer.onNext(this.accumulation)}},F.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.observer.onError(t))},F.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,!this.hasValue&&this.hasSeed&&this.observer.onNext(this.seed),this.observer.onCompleted())},F.prototype.dispose=function(){this.isStopped=!0},F.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.observer.onError(t),!0)},_e.scan=function(){var t,e,n=!1;return 2===arguments.length?(n=!0,t=arguments[0],e=arguments[1]):e=arguments[0],new kn(this,e,n,t)},_e.skipLast=function(t){if(t<0)throw new pt;var e=this;return new _n(function(n){var r=[];return e.subscribe(function(e){r.push(e),r.length>t&&n.onNext(r.shift())},function(t){n.onError(t)},function(){n.onCompleted()})},e)},_e.startWith=function(){var t,e=0;arguments.length&&pe(arguments[0])?(t=arguments[0],e=1):t=me;for(var n=[],r=e,o=arguments.length;r<o;r++)n.push(arguments[r]);return Fe([Ze(n,t),this]).concat()},_e.takeLast=function(t){if(t<0)throw new pt;var e=this;return new _n(function(n){var r=[];return e.subscribe(function(e){r.push(e),r.length>t&&r.shift()},function(t){n.onError(t)},function(){for(;r.length>0;)n.onNext(r.shift());n.onCompleted()})},e)},_e.takeLastBuffer=function(t){var e=this;return new _n(function(n){var r=[];return e.subscribe(function(e){r.push(e),r.length>t&&r.shift()},function(t){n.onError(t)},function(){n.onNext(r),n.onCompleted()})},e)},_e.windowWithCount=function(t,e){var n=this;if(+t||(t=0),Math.abs(t)===1/0&&(t=0),t<=0)throw new pt;if(null==e&&(e=t),+e||(e=0),Math.abs(e)===1/0&&(e=0),e<=0)throw new pt;return new _n(function(r){function o(){var t=new Rn;c.push(t),r.onNext(Qt(t,s))}var i=new ue,s=new ae(i),u=0,c=[];return o(),i.setDisposable(n.subscribe(function(n){for(var r=0,i=c.length;r<i;r++)c[r].onNext(n);var s=u-t+1;s>=0&&s%e==0&&c.shift().onCompleted(),++u%e==0&&o()},function(t){for(;c.length>0;)c.shift().onError(t);r.onError(t)},function(){for(;c.length>0;)c.shift().onCompleted();r.onCompleted()})),s},n)},_e.selectConcat=_e.concatMap=function(t,e,n){return ut(t)&&ut(e)?this.concatMap(function(n,r){var o=t(n,r);return st(o)&&(o=Ke(o)),(xt(o)||wt(o))&&(o=Ye(o)),o.map(function(t,o){return e(n,t,r,o)})}):ut(t)?z(this,t,n):z(this,function(){return t})},_e.concatMapObserver=_e.selectConcatObserver=function(t,e,n,r){var o=this,i=Et(t,r,2),s=Et(e,r,1),u=Et(n,r,0);return new _n(function(t){var e=0;return o.subscribe(function(n){var r;try{r=i(n,e++)}catch(e){return void t.onError(e)}st(r)&&(r=Ke(r)),t.onNext(r)},function(e){var n;try{n=s(e)}catch(e){return void t.onError(e)}st(n)&&(n=Ke(n)),t.onNext(n),t.onCompleted()},function(){var e;try{e=u()}catch(e){return void t.onError(e)}st(e)&&(e=Ke(e)),t.onNext(e),t.onCompleted()})},this).concatAll()},_e.defaultIfEmpty=function(t){var e=this;return t===o&&(t=null),new _n(function(n){var r=!1;return e.subscribe(function(t){r=!0,n.onNext(t)},function(t){n.onError(t)},function(){!r&&n.onNext(t),n.onCompleted()})},e)},V.prototype.push=function(t){var e=-1===K(this.set,t,this.comparer);return e&&this.set.push(t),e},_e.distinct=function(t,e){var n=this;return e||(e=rt),new _n(function(r){var o=new V(e);return n.subscribe(function(e){var n=e;if(t)try{n=t(e)}catch(t){return void r.onError(t)}o.push(n)&&r.onNext(e)},function(t){r.onError(t)},function(){r.onCompleted()})},this)};var Cn=function(t){function e(e,n,r){this.source=e,this.selector=Et(n,r,3),t.call(this)}function n(t,e){return function(n,r,o){return t.call(this,e.selector(n,r,o),r,o)}}function r(t,e,n){this.o=t,this.selector=e,this.source=n,this.i=0,this.isStopped=!1}return Gt(e,t),e.prototype.internalMap=function(t,r){return new e(this.source,n(t,this),r)},e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.selector,this))},r.prototype.onNext=function(t){if(!this.isStopped){var e=w(this.selector)(t,this.i++,this.source);if(e===Yt)return this.o.onError(e.e);this.o.onNext(e)}},r.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},r.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},r.prototype.dispose=function(){this.isStopped=!0},r.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e}(Pe);_e.map=_e.select=function(t,e){var n="function"==typeof t?t:function(){return t};return this instanceof Cn?this.internalMap(n,e):new Cn(this,n,e)},_e.pluck=function(){var t=arguments,e=arguments.length;if(0===e)throw new Error("List of properties cannot be empty.");return this.map(function(n){for(var r=n,i=0;i<e;i++){var s=r[t[i]];if(void 0===s)return o;r=s}return r})},_e.flatMapObserver=_e.selectManyObserver=function(t,e,n,r){var o=this;return new _n(function(i){var s=0;return o.subscribe(function(e){var n;try{n=t.call(r,e,s++)}catch(t){return void i.onError(t)}st(n)&&(n=Ke(n)),i.onNext(n)},function(t){var n;try{n=e.call(r,t)}catch(t){return void i.onError(t)}st(n)&&(n=Ke(n)),i.onNext(n),i.onCompleted()},function(){var t;try{t=n.call(r)}catch(t){return void i.onError(t)}st(t)&&(t=Ke(t)),i.onNext(t),i.onCompleted()})},o).mergeAll()},_e.selectMany=_e.flatMap=function(t,e,n){return ut(t)&&ut(e)?this.flatMap(function(n,r){var o=t(n,r);return st(o)&&(o=Ke(o)),(xt(o)||wt(o))&&(o=Ye(o)),o.map(function(t,o){return e(n,t,r,o)})},n):ut(t)?J(this,t,n):J(this,function(){return t})},_e.selectSwitch=_e.flatMapLatest=_e.switchMap=function(t,e){return this.select(t,e).switchLatest()};var An=function(t){function e(e,n){this.source=e,this.skipCount=n,t.call(this)}function n(t,e){this.c=e,this.r=e,this.o=t,this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.skipCount))},n.prototype.onNext=function(t){this.isStopped||(this.r<=0?this.o.onNext(t):this.r--)},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e}(Pe);_e.skip=function(t){if(t<0)throw new pt;return new An(this,t)},_e.skipWhile=function(t,e){var n=this,r=Et(t,e,3);return new _n(function(t){var e=0,o=!1;return n.subscribe(function(i){if(!o)try{o=!r(i,e++,n)}catch(e){return void t.onError(e)}o&&t.onNext(i)},function(e){t.onError(e)},function(){t.onCompleted()})},n)},_e.take=function(t,e){if(t<0)throw new pt;if(0===t)return He(e);var n=this;return new _n(function(e){var r=t;return n.subscribe(function(t){r-- >0&&(e.onNext(t),r<=0&&e.onCompleted())},function(t){e.onError(t)},function(){e.onCompleted()})},n)},_e.takeWhile=function(t,e){var n=this,r=Et(t,e,3);return new _n(function(t){var e=0,o=!0;return n.subscribe(function(i){if(o){try{o=r(i,e++,n)}catch(e){return void t.onError(e)}o?t.onNext(i):t.onCompleted()}},function(e){t.onError(e)},function(){t.onCompleted()})},n)};var Nn=function(t){function e(e,n,r){this.source=e,this.predicate=Et(n,r,3),t.call(this)}function n(t,e){return function(n,r,o){return e.predicate(n,r,o)&&t.call(this,n,r,o)}}function r(t,e,n){this.o=t,this.predicate=e,this.source=n,this.i=0,this.isStopped=!1}return Gt(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.predicate,this))},e.prototype.internalFilter=function(t,r){return new e(this.source,n(t,this),r)},r.prototype.onNext=function(t){if(!this.isStopped){var e=w(this.predicate)(t,this.i++,this.source);if(e===Yt)return this.o.onError(e.e);e&&this.o.onNext(t)}},r.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},r.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},r.prototype.dispose=function(){this.isStopped=!0},r.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e}(Pe);_e.filter=_e.where=function(t,e){return this instanceof Nn?this.internalFilter(t,e):new Nn(this,t,e)},_e.transduce=function(t){function e(t){return{"@@transducer/init":function(){return t},"@@transducer/step":function(t,e){return t.onNext(e)},"@@transducer/result":function(t){return t.onCompleted()}}}var n=this;return new _n(function(r){var o=t(e(r));return n.subscribe(function(t){try{o["@@transducer/step"](r,t)}catch(t){r.onError(t)}},function(t){r.onError(t)},function(){o["@@transducer/result"](r)})},n)};var _n=Z.AnonymousObservable=function(t){function e(t){return t&&ut(t.dispose)?t:ut(t)?re(t):oe}function n(t,n){var r=n[0],o=n[1],i=w(o)(r);if(i===Yt&&!r.fail(Yt.e))return x(Yt.e);r.setDisposable(e(i))}function r(e,r){function o(t){var r=new Tn(t),o=[r,e];return ye.scheduleRequired()?ye.scheduleWithState(o,n):n(null,o),r}this.source=r,t.call(this,o)}return Gt(r,t),r}(Le),Tn=function(t){function e(e){t.call(this),this.observer=e,this.m=new ue}Gt(e,t);var n=e.prototype;return n.next=function(t){var e=w(this.observer.onNext).call(this.observer,t);e===Yt&&(this.dispose(),x(e.e))},n.error=function(t){var e=w(this.observer.onError).call(this.observer,t);this.dispose(),e===Yt&&x(e.e)},n.completed=function(){var t=w(this.observer.onCompleted).call(this.observer);this.dispose(),t===Yt&&x(t.e)},n.setDisposable=function(t){this.m.setDisposable(t)},n.getDisposable=function(){return this.m.getDisposable()},n.dispose=function(){t.prototype.dispose.call(this),this.m.dispose()},e}(Te),On=function(t,e){this.subject=t,this.observer=e};On.prototype.dispose=function(){if(!this.subject.isDisposed&&null!==this.observer){var t=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(t,1),this.observer=null}};var Rn=Z.Subject=function(t){function e(t){return se(this),this.isStopped?this.hasError?(t.onError(this.error),oe):(t.onCompleted(),oe):(this.observers.push(t),new On(this,t))}function n(){t.call(this,e),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return Gt(n,t),$t(n.prototype,Ae.prototype,{hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(se(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=i(this.observers),n=e.length;t<n;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(se(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;for(var e=0,n=i(this.observers),r=n.length;e<r;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(se(this),!this.isStopped)for(var e=0,n=i(this.observers),r=n.length;e<r;e++)n[e].onNext(t)},dispose:function(){this.isDisposed=!0,this.observers=null}}),n.create=function(t,e){return new Dn(t,e)},n}(Le),Dn=(Z.AsyncSubject=function(t){function e(t){return se(this),this.isStopped?(this.hasError?t.onError(this.error):this.hasValue?(t.onNext(this.value),t.onCompleted()):t.onCompleted(),oe):(this.observers.push(t),new On(this,t))}function n(){t.call(this,e),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return Gt(n,t),$t(n.prototype,Ae,{hasObservers:function(){return se(this),this.observers.length>0},onCompleted:function(){var t,e;if(se(this),!this.isStopped){this.isStopped=!0;var n=i(this.observers),e=n.length;if(this.hasValue)for(t=0;t<e;t++){var r=n[t];r.onNext(this.value),r.onCompleted()}else for(t=0;t<e;t++)n[t].onCompleted();this.observers.length=0}},onError:function(t){if(se(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=i(this.observers),r=n.length;e<r;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){se(this),this.isStopped||(this.value=t,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.exception=null,this.value=null}}),n}(Le),Z.AnonymousSubject=function(t){function e(t){return this.observable.subscribe(t)}function n(n,r){this.observer=n,this.observable=r,t.call(this,e)}return Gt(n,t),$t(n.prototype,Ae.prototype,{onCompleted:function(){this.observer.onCompleted()},onError:function(t){this.observer.onError(t)},onNext:function(t){this.observer.onNext(t)}}),n}(Le));G.Rx=Z,(r=function(){return Z}.call(e,n,e,t))!==o&&(t.exports=r);var jn=f()}).call(this)}).call(e,n(1)(t))},function(t,e){t.exports=require("debug@2.2.0")},function(t,e){t.exports=require("lodash@3.10.1")},function(t,e){t.exports=require("url")},function(t,e,n){function r(t){if(!t.container)return null;const e=t.container.replace(c,"\\$&"),n=t.jtn?t.jtn.replace(c,"\\$&"):"";if(t.url_format===u)return new RegExp("^/api/run/"+e+"/(?:"+n+"/?)?");if(t.url_format===s)return new RegExp("^/"+e+"/(?:"+n+"/?)?");if(t.url_format===i)return new RegExp("^/(?:"+n+"/?)?");throw new Error("Unsupported webtask URL format.")}const o=n(17),i=3,s=2,u=1,c=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,a=function(t,e){var n=o.parse(t).pathname||"";return n=n.replace(e,"").replace(/^\/|\/$/g,""),n.startsWith("/")||(n="/"+n),n.endsWith("/")||(n+="/"),n};t.exports.getBasePath=function(t){return a(t.originalUrl||"",t.path)},t.exports.getBaseUrl=function(t,e){var n=e;const r=o.parse(t.originalUrl||"").pathname||"";return o.format({protocol:n||"https",host:t.headers.host,pathname:r.replace(t.path,"").replace(/\/$/g,"")})},t.exports.getWebtaskUrl=function(t){const e=r(t.x_wt),n=t.url,i=t.url.replace(e,"/"),s=o.parse(i||"").pathname,u=o.parse(n||"").pathname||"";var c=o.format({protocol:"https",host:t.headers.host,pathname:u.replace(s,"").replace(/\/$/g,"")});return t.x_wt&&(0===c.indexOf("https://sandbox.it.auth0.com")?c=c.replace("https://sandbox.it.auth0.com/api/run/"+t.x_wt.container+"/","https://"+t.x_wt.container+".us.webtask.io/"):0===c.indexOf("https://sandbox-eu.it.auth0.com")?c=c.replace("https://sandbox-eu.it.auth0.com/api/run/"+t.x_wt.container+"/","https://"+t.x_wt.container+".eu.webtask.io/"):0===c.indexOf("https://sandbox-au.it.auth0.com")&&(c=c.replace("https://sandbox-au.it.auth0.com/api/run/"+t.x_wt.container+"/","https://"+t.x_wt.container+".au.webtask.io/"))),c}},function(t,e,n){function r(t){if(null===t||void 0===t)throw new u.ArgumentError("Must provide an options object");if(null===t.domain||void 0===t.domain)throw new u.ArgumentError("Must provide a valid domain");if("string"!=typeof t.domain||0===t.domain.length)throw new u.ArgumentError("The provided domain is invalid: "+t.domain);if(null===t.clientId||void 0===t.clientId)throw new u.ArgumentError("Must provide a valid clientId");if("string"!=typeof t.clientId||0===t.clientId.length)throw new u.ArgumentError("The provided clientId is invalid: "+t.clientId);if(null===t.clientSecret||void 0===t.clientSecret)throw new u.ArgumentError("Must provide a valid clientSecret");if("string"!=typeof t.clientSecret||0===t.clientSecret.length)throw new u.ArgumentError("The provided clientSecret is invalid: "+t.clientSecret);this.options=t,this.tokenCache=t.tokenCache||{getToken:function(){return o.resolve()},setToken:function(){return o.resolve()}}}const o=n(33),i=n(37),s=n(131),u=n(0);r.prototype.getAccessToken=function(){var t=this;return new o(function(e,n){i.post("https://"+t.options.domain+"/oauth/token").send({audience:"https://"+t.options.domain+"/api/v2/",client_id:t.options.clientId,client_secret:t.options.clientSecret,grant_type:"client_credentials"}).set("Accept","application/json").end(function(r,o){if(r&&401===r.status)return n(new u.ManagementApiError("unauthorized","Invalid credentials for "+t.options.clientId,r.status));if(r&&o&&o.body&&o.body.error)return n(new u.ManagementApiError(o.body.error,o.body.error_description||o.body.error,r.status));if(r)return n(r);if(!o.ok||!o.body.access_token)return n(new u.ManagementApiError("unknown_error","Unknown error from Management API or no access_token was provided: "+(o.text||o.status)));const i=new Date;return e({token:o.body.access_token,expiresAt:i.setSeconds(i.getSeconds()+o.body.expires_in)})})})},r.prototype.getAccessTokenCached=function(){var t=this;return t.tokenCache.getToken().then(function(e){if(e&&e.token){const n=(new Date).valueOf();if(e.expiresAt-n>1e4)return e}return t.getAccessToken(t.options).then(function(e){return t.tokenCache.setToken(e).then(function(){return e})})})},r.prototype.getLogs=function(t){const e=this;return new o(function(n,r){e.getAccessTokenCached(e.options,e.storage).then(function(o){const c=s.stringify(t);i.get("https://"+e.options.domain+"/api/v2/logs?"+c).set("Authorization","Bearer "+o.token).set("Content-Type","application/json").end(function(t,o){if(t&&403===t.status){const i=function(){return r(new u.ManagementApiError(o.body.error,o.body.error_description||o.body.error,t.status))};e.tokenCache.setToken(null).then(i).catch(i)}return t&&o&&o.body&&o.body.error?r(new u.ManagementApiError(o.body.error,o.body.error_description||o.body.error,t.status)):t?r(t):o.ok?n({logs:o.body,limits:{limit:o.headers["x-ratelimit-limit"],remaining:o.headers["x-ratelimit-remaining"],reset:o.headers["x-ratelimit-reset"]}}):r(new u.ManagementApiError("unknown_error","Unknown error from Management API: "+(o.text||o.status)))})})})},t.exports=r},function(t,e){const n={s:{name:"Success Login",icon:"icon-budicon-448",level:1},ssa:{name:"Success Silent Auth",icon:"icon-budicon-448",level:1},fsa:{name:"Failed Silent Auth",icon:"icon-budicon-448",level:3},seacft:{name:"Success Exchange",description:"Authorization Code for Access Token",icon:"icon-budicon-456",level:1},feacft:{name:"Failed Exchange",description:"Authorization Code for Access Token",icon:"icon-budicon-456",level:3},seccft:{name:"Success Exchange",description:"Client Credentials for Access Token",icon:"icon-budicon-456",level:1},feccft:{name:"Failed Exchange",description:"Client Credentials for Access Token",icon:"icon-budicon-456",level:3},sepft:{name:"Success Exchange",description:"Password for Access Token",icon:"icon-budicon-456",level:1},fepft:{name:"Failed Exchange",description:"Password for Access Token",icon:"icon-budicon-456",level:3},sertft:{name:"Success Exchange",description:"Refresh Token for Access Token",icon:"icon-budicon-456",level:1},fertft:{name:"Failed Exchange",description:"Refresh Token for Access Token",icon:"icon-budicon-456",level:3},seoobft:{name:"Success Exchange",description:"Password and OOB Challenge for Access Token",icon:"icon-budicon-456",level:1},feoobft:{name:"Failed Exchange",description:"Password and OOB Challenge for Access Token",icon:"icon-budicon-456",level:3},seotpft:{name:"Success Exchange",description:"Password and OTP Challenge for Access Token",icon:"icon-budicon-456",level:1},feotpft:{name:"Failed Exchange",description:"Password and OTP Challenge for Access Token",icon:"icon-budicon-456",level:3},sercft:{name:"Success Exchange",description:"Password and MFA Recovery code for Access Token",icon:"icon-budicon-456",level:1},fercft:{name:"Failed Exchange",description:"Password and MFA Recovery code for Access Token",icon:"icon-budicon-456",level:3},f:{name:"Failed Login",icon:"icon-budicon-448",level:3},w:{name:"Warning",icon:"icon-budicon-354",level:2},du:{name:"Deleted User",icon:"icon-budicon-311",level:3},fu:{name:"Failed Login (invalid email/username)",icon:"icon-budicon-311",level:3},fp:{name:"Failed Login (wrong password)",icon:"icon-budicon-311",level:3},fc:{name:"Failed by Connector",icon:"icon-budicon-313",level:3},fco:{name:"Failed by CORS",icon:"icon-budicon-313",level:3},con:{name:"Connector Online",icon:"icon-budicon-143",level:1},coff:{name:"Connector Offline",icon:"icon-budicon-143",level:3},fcpro:{name:"Failed Connector Provisioning",icon:"icon-budicon-143",level:4},ss:{name:"Success Signup",icon:"icon-budicon-314",level:1},fs:{name:"Failed Signup",icon:"icon-budicon-311",level:3},cs:{name:"Code Sent",icon:"icon-budicon-243",level:1},cls:{name:"Code/Link Sent",icon:"icon-budicon-781",level:1},sv:{name:"Success Verification Email",icon:"icon-budicon-781",level:1},fv:{name:"Failed Verification Email",icon:"icon-budicon-311",level:3},scp:{name:"Success Change Password",icon:"icon-budicon-280",level:1},fcp:{name:"Failed Change Password",icon:"icon-budicon-266",level:3},sce:{name:"Success Change Email",icon:"icon-budicon-266",level:1},fce:{name:"Failed Change Email",icon:"icon-budicon-266",level:3},scu:{name:"Success Change Username",icon:"icon-budicon-266",level:1},fcu:{name:"Failed Change Username",icon:"icon-budicon-266",level:3},scpn:{name:"Success Change Phone Number",icon:"icon-budicon-266",level:1},fcpn:{name:"Failed Change Phone Number",icon:"icon-budicon-266",level:3},svr:{name:"Success Verification Email Request",icon:"icon-budicon-781",level:0},fvr:{name:"Failed Verification Email Request",icon:"icon-budicon-311",level:3},scpr:{name:"Success Change Password Request",icon:"icon-budicon-280",level:1},fcpr:{name:"Failed Change Password Request",icon:"icon-budicon-311",level:3},fn:{name:"Failed Sending Notification",icon:"icon-budicon-782",level:3},sapi:{name:"API Operation",icon:"icon-budicon-546",level:1},fapi:{name:"Failed API Operation",icon:"icon-budicon-546",level:3},limit_wc:{name:"Blocked Account",icon:"icon-budicon-313",level:4},limit_mu:{name:"Blocked IP Address",icon:"icon-budicon-313",level:4},limit_ui:{name:"Too Many Calls to /userinfo",icon:"icon-budicon-313",level:4},api_limit:{name:"Rate Limit On API",icon:"icon-budicon-313",level:4},limit_delegation:{name:"Too Many Calls to /delegation",icon:"icon-budicon-313",level:4},sdu:{name:"Successful User Deletion",icon:"icon-budicon-312",level:1},fdu:{name:"Failed User Deletion",icon:"icon-budicon-311",level:3},slo:{name:"Success Logout",icon:"icon-budicon-449",level:1},flo:{name:"Failed Logout",icon:"icon-budicon-449",level:3},sd:{name:"Success Delegation",icon:"icon-budicon-456",level:1},fd:{name:"Failed Delegation",icon:"icon-budicon-456",level:3},gd_unenroll:{name:"Unenroll device account",icon:"icon-budicon-298",level:1},gd_update_device_account:{name:"Update device account",icon:"icon-budicon-257",level:1},gd_module_switch:{name:"Module switch",icon:"icon-budicon-329",level:1},gd_tenant_update:{name:"Guardian tenant update",icon:"icon-budicon-170",level:1},gd_start_auth:{name:"Second factor started",icon:"icon-budicon-285",level:1},gd_start_enroll:{name:"Enroll started",icon:"icon-budicon-299",level:1},gd_user_delete:{name:"User delete",icon:"icon-budicon-298",level:1},gd_auth_succeed:{name:"OTP Auth suceed",icon:"icon-budicon-mfa-login-succeed",level:1},gd_auth_failed:{name:"OTP Auth failed",icon:"icon-budicon-mfa-login-failed",level:3},gd_send_pn:{name:"Push notification sent",icon:"icon-budicon-mfa-send-pn",level:1},gd_auth_rejected:{name:"OTP Auth rejected",icon:"icon-budicon-mfa-login-failed",level:3},gd_recovery_succeed:{name:"Recovery succeed",icon:"icon-budicon-mfa-recovery-succeed",level:1},gd_recovery_failed:{name:"Recovery failed",icon:"icon-budicon-mfa-recovery-failed",level:3},gd_send_sms:{name:"SMS Sent",icon:"icon-budicon-799",level:1},gd_otp_rate_limit_exceed:{name:"Too many failures",icon:"icon-budicon-435",level:2},gd_recovery_rate_limit_exceed:{name:"Too many failures",icon:"icon-budicon-435",level:2},fui:{name:"Users import",icon:"icon-budicon-299",level:2},sui:{name:"Users import",icon:"icon-budicon-299",level:1},pwd_leak:{name:"Breached password",icon:"icon-budicon-313",level:3}};t.exports=n,t.exports.get=function(t){return n[t]&&n[t].name||"Unknown Log Type: "+t}},function(t,e,n){function r(t){if(null===t||void 0===t)throw new s.ArgumentError("Must provide an options object");i.call(this,{objectMode:!0}),this.client=new u(t),this.options=t,this.remaining=50,this.lastBatch=0,this.previousCheckpoint=t.checkpointId||null,this.lastCheckpoint=t.checkpointId||null,this.status={start:new Date,end:null,logsProcessed:0}}const o=n(38),i=n(132).Readable,s=n(0),u=n(19);o.inherits(r,i),r.prototype.getQuery=function(t){return t&&t.length?"type:"+t.join(" OR type:"):""},r.prototype.done=function(){this.status.end=new Date,this.push(null)},r.prototype.next=function(t){const e=this;if(e.remaining<1)e.status.warning="Auth0 Management API rate limit reached.",e.done();else{const n=e.lastCheckpoint?{take:100,from:e.lastCheckpoint}:{per_page:100,page:0};n.q=e.getQuery(e.options.types),n.sort="date:1",e.client.getLogs(n).then(function(n){const r=n.logs;if(e.remaining=n.limits.remaining,r&&r.length){const o=e.options.types&&e.options.types.length?r.filter(function(t){return e.options.types.indexOf(t.type)>=0}).slice(0,t||100):r;o.length?(e.lastCheckpoint=o[o.length-1]._id,e.lastBatch+=o.length,e.push({logs:o,limits:n.limits})):(e.lastCheckpoint=r[r.length-1]._id,e.lastBatch+=0,e.push({logs:[],limits:n.limits}))}else e.status.end=new Date,e.push(null);return r}).catch(function(t){e.emit("error",t)})}},r.prototype.batchSaved=function(){this.status.logsProcessed+=this.lastBatch,this.previousCheckpoint=this.lastCheckpoint,this.lastBatch=0},r.prototype._read=function(){},t.exports=r},function(t,e,n){"use strict";var r=n(117);t.exports=function(t,e,n){return function(o,i,s){var u=r(s);return!0===t||"function"==typeof t&&t(o,i,u)?e(o,i,u):n?n(o,i,u):u()}}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(77),o=n(23);t.exports=function(t){return r(o(t))}},function(t,e){t.exports={title:"Auth0 Logs to CloudWatch",name:"auth0-logs-to-cloudwatch-22",version:"1.6.0",author:"zzzzz",category:"log_export",description:"This extension will continuously export your Auth0 logs to AWS CloudWatch",type:"cron",initialUrlPath:"/login",repository:"https://github.com/TDG-Platform/auth0-logs-to-cloudwatch",keywords:["auth0","extension"],schedule:"0 */5 * * * *",auth0:{createClient:!0,onUninstallPath:"/.extensions/on-uninstall",scopes:"read:logs delete:clients"},secrets:{BATCH_SIZE:{description:"The amount of logs to batch before sending to CloudWatch. A single cron execution will send multiple batches.",default:100},AWS_ACCESS_KEY:{description:"AWS access key",required:!0},AWS_SECRET_KEY:{description:"AWS secret key",required:!0},LOG_GROUP:{description:"AWS CloudWatch log group name",required:!0},START_FROM:{description:"Checkpoint ID of log to start from."},SLACK_INCOMING_WEBHOOK_URL:{description:"Slack Incoming Webhook URL used to report statistics and possible failures"},SLACK_SEND_SUCCESS:{description:"This setting will enable verbose notifications to Slack which are useful for troubleshooting",type:"select",allowMultiple:!1,default:"false",options:[{value:"false",text:"No"},{value:"true",text:"Yes"}]},LOG_LEVEL:{description:"This allows you to specify the log level of events that need to be sent",type:"select",allowMultiple:!0,options:[{value:"-",text:""},{value:"0",text:"Debug"},{value:"1",text:"Info"},{value:"2",text:"Warning"},{value:"3",text:"Error"},{value:"4",text:"Critical"}]},LOG_TYPES:{description:"If you only want to send events with a specific type (eg: failed logins)",type:"select",allowMultiple:!0,options:[{text:"",value:"-"},{text:"Success Login",value:"s"},{text:"Success Exchange",value:"seacft"},{text:"Success Exchange (Client Credentials)",value:"seccft"},{text:"Failed Exchange",value:"feacft"},{text:"Failed Exchange (Client Credentials)",value:"feccft"},{text:"Failed Login",value:"f"},{text:"Warnings During Login",value:"w"},{text:"Deleted User",value:"du"},{text:"Failed Login (invalid email/username)",value:"fu"},{text:"Failed Login (wrong password)",value:"fp"},{text:"Failed by Connector",value:"fc"},{text:"Failed by CORS",value:"fco"},{text:"Connector Online",value:"con"},{text:"Connector Offline",value:"coff"},{text:"Failed Connector Provisioning",value:"fcpro"},{text:"Success Signup",value:"ss"},{text:"Failed Signup",value:"fs"},{text:"Code Sent",value:"cs"},{text:"Code/Link Sent",value:"cls"},{text:"Success Verification Email",value:"sv"},{text:"Failed Verification Email",value:"fv"},{text:"Success Change Password",value:"scp"},{text:"Failed Change Password",value:"fcp"},{text:"Success Change Email",value:"sce"},{text:"Failed Change Email",value:"fce"},{text:"Success Change Username",value:"scu"},{text:"Failed Change Username",value:"fcu"},{text:"Success Change Phone Number",value:"scpn"},{text:"Failed Change Phone Number",value:"fcpn"},{text:"Success Verification Email Request",value:"svr"},{text:"Failed Verification Email Request",value:"fvr"},{text:"Success Change Password Request",value:"scpr"},{text:"Failed Change Password Request",value:"fcpr"},{text:"Failed Sending Notification",value:"fn"},{text:"API Operation",value:"sapi"},{text:"Failed API Operation",value:"fapi"},{text:"Blocked Account",value:"limit_wc"},{text:"Too Many Calls to /userinfo",value:"limit_ui"},{text:"Rate Limit On API",value:"api_limit"},{text:"Successful User Deletion",value:"sdu"},{text:"Failed User Deletion",value:"fdu"},{text:"Blocked Account",value:"limit_wc"},{text:"Blocked IP Address",value:"limit_mu"},{text:"Success Logout",value:"slo"},{text:"Failed Logout",value:"flo"},{text:"Success Delegation",value:"sd"},{text:"Failed Delegation",value:"fd"}]}}}},function(t,e,n){"use strict";function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="ArgumentError",this.message=t}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e,n){"use strict";function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="JwksError",this.message=t}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e,n){"use strict";function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="JwksRateLimitError",this.message=t}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e,n){"use strict";function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="SigningKeyNotFoundError",this.message=t}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e,n){"use strict";function r(t){this.message=t}var o=n(100);r.prototype=new Error,r.prototype.name="InvalidTokenError",t.exports=function(t,e){if("string"!=typeof t)throw new r("Invalid token specified");e=e||{};var n=!0===e.header?0:1;try{return JSON.parse(o(t.split(".")[n]))}catch(t){throw new r("Invalid token specified: "+t.message)}},t.exports.InvalidTokenError=r},function(t,e){var n=function(t,e,n,r){if(this.bucketSize=t,this.tokensPerInterval=e,"string"==typeof n)switch(n){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5}else this.interval=n;this.parentBucket=r,this.content=0,this.lastDrip=+new Date};n.prototype={bucketSize:1,tokensPerInterval:1,interval:1e3,parentBucket:null,content:0,lastDrip:0,removeTokens:function(t,e){function n(){var n=Math.ceil((t-r.content)*(r.interval/r.tokensPerInterval));return setTimeout(function(){r.removeTokens(t,e)},n),!1}var r=this;return this.bucketSize?t>this.bucketSize?(process.nextTick(e.bind(null,"Requested tokens "+t+" exceeds bucket size "+this.bucketSize,null)),!1):(this.drip(),t>this.content?n():this.parentBucket?this.parentBucket.removeTokens(t,function(o,i){return o?e(o,null):t>r.content?n():(r.content-=t,void e(null,Math.min(i,r.content)))}):(this.content-=t,process.nextTick(e.bind(null,null,this.content)),!0)):(process.nextTick(e.bind(null,null,t,Number.POSITIVE_INFINITY)),!0)},tryRemoveTokens:function(t){return!this.bucketSize||!(t>this.bucketSize)&&(this.drip(),!(t>this.content)&&(!(this.parentBucket&&!this.parent.tryRemoveTokens(t))&&(this.content-=t,!0)))},drip:function(){if(!this.tokensPerInterval)return void(this.content=this.bucketSize);var t=+new Date,e=Math.max(t-this.lastDrip,0);this.lastDrip=t;var n=e*(this.tokensPerInterval/this.interval);this.content=Math.min(this.content+n,this.bucketSize)}},t.exports=n},function(t,e){t.exports=require("bluebird@3.4.6")},function(t,e){t.exports=require("express-jwt@3.1.0")},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("request@2.56.0")},function(t,e){t.exports=require("superagent@1.2.0")},function(t,e){t.exports=require("util")},function(t,e,n){"use strict";(function(e){var r=(n(17),n(35)),o=n(129),i=n(5),s=n(121),u=n(0),c=n(4),a=n(59),l=n(60),f=n(57),h=n(6),p=n(3),d=n(56),v=n(26);t.exports=function(t,n){p.setProvider(t);var m=n?new u.WebtaskStorageContext(n,{force:1}):new u.FileStorageContext(r.join(e,"./data.json"),{mergeWrites:!0}),y=new i;y.use(o(":method :url :status :response-time ms - :res[content-length]",{stream:h.stream}));var b=function(t){return function(e,n,r){return e.webtaskContext&&e.webtaskContext.body?(e.body=e.webtaskContext.body,r()):t(e,n,r)}};return y.use(b(s.json())),y.use(b(s.urlencoded({extended:!1}))),y.use("/meta",l()),y.use("/.extensions",f()),y.use(d(m)),y.use(c.routes.dashboardAdmins({secret:p("EXTENSION_SECRET"),audience:"urn:logs-to-cloudwatch",rta:p("AUTH0_RTA").replace("https://",""),domain:p("AUTH0_DOMAIN"),baseUrl:p("PUBLIC_WT_URL")||p("WT_URL"),clientName:"Logs to CloudWatch",urlPrefix:"",sessionStorageKey:"logs-to-cloudwatch:apiToken"})),y.use("/app",i.static(r.join(e,"../dist"))),y.use("/",a(m)),y.use(c.middlewares.errorHandler(h.error.bind(h))),y.get("/meta",function(t,e){e.status(200).send(v)}),y}}).call(e,"/")},function(t,e,n){const r=n(31),o=n(34),i=n(0),s=n(22);t.exports=function(t){if(!t||"object"!=typeof t)throw new i.ArgumentError("Must provide the options");if(null===t.secret||void 0===t.secret)throw new i.ArgumentError("Must provide a valid secret");if("string"!=typeof t.secret||0===t.secret.length)throw new i.ArgumentError("The provided secret is invalid: "+t.secret);if(null===t.audience||void 0===t.audience)throw new i.ArgumentError("Must provide a valid secret");if("string"!=typeof t.audience||0===t.audience.length)throw new i.ArgumentError("The provided audience is invalid: "+t.audience);if(null===t.baseUrl||void 0===t.baseUrl)throw new i.ArgumentError("Must provide a valid base URL");if("string"!=typeof t.baseUrl||0===t.baseUrl.length)throw new i.ArgumentError("The provided base URL is invalid: "+t.baseUrl);const e=o({audience:t.audience,issuer:t.baseUrl,secret:t.secret,algorithms:["HS256"],credentialsRequired:t.credentialsRequired||!0});return function(n,r,o){e(n,r,function(e){return e?o(e):t.onLoginSuccess?t.onLoginSuccess(n,r,o):o()})}},t.exports.optional=function(e){const n=t.exports(e);return s(function(t){if(t&&t.headers&&t.headers.authorization&&0===t.headers.authorization.indexOf("Bearer "))try{const n=r(t.headers.authorization.split(" ")[1]);return n&&n.iss===e.baseUrl}catch(t){return!1}return!1},n)}},function(t,e,n){const r=n(31),o=n(34),i=n(91),s=n(0),u=n(22),c=n(0).UnauthorizedError;t.exports=function(t){if(!t||"object"!=typeof t)throw new s.ArgumentError("Must provide the options");if(null===t.domain||void 0===t.domain)throw new s.ArgumentError("Must provide a valid domain");if("string"!=typeof t.domain||0===t.domain.length)throw new s.ArgumentError("The provided domain is invalid: "+t.domain);if(null===t.audience||void 0===t.audience)throw new s.ArgumentError("Must provide a valid audience");if("string"!=typeof t.audience||0===t.audience.length)throw new s.ArgumentError("The provided audience is invalid: "+t.audience);const e=o({secret:i.expressJwtSecret({cache:!0,rateLimit:!0,jwksRequestsPerMinute:5,jwksUri:"https://"+t.domain+"/.well-known/jwks.json",handleSigningKeyError:function(t,e){return e(t instanceof i.SigningKeyNotFoundError?new c("A token was provided with an invalid kid"):t)}}),audience:t.audience,issuer:"https://"+t.domain+"/",algorithms:["RS256"],credentialsRequired:t&&t.credentialsRequired||!0});return function(n,r,o){e(n,r,function(e){return e?o(e):t.onLoginSuccess?t.onLoginSuccess(n,r,o):o()})}},t.exports.optional=function(e){const n=t.exports(e);return u(function(t){if(t&&t.headers&&t.headers.authorization&&0===t.headers.authorization.indexOf("Bearer "))try{const n=r(t.headers.authorization.split(" ")[1]);return n&&n.iss==="https://"+e.domain+"/"}catch(t){return!1}return!1},n)}},function(t,e,n){t.exports=function(t){return function(e,n,r,o){return t&&t(e),e&&e.status?(r.status(e.status),r.json({error:e.code||e.name,message:e.message||e.name})):(r.status(e.status||500),r.json({error:"InternalServerError",message:e.message||e.name}))}}},function(t,e,n){t.exports.authenticateAdmins=n(40),t.exports.authenticateUsers=n(41),t.exports.requireAuthentication=n(45),t.exports.errorHandler=n(42),t.exports.managementApiClient=n(44),t.exports.validateHookToken=n(46),t.exports.webtaskConfig=n(47)},function(t,e,n){const r=n(0);t.exports=function(t){return function(e,n,o){const i=e,s=e.user&&e.user.access_token&&e.user.access_token.length,u=s?{domain:t.domain,accessToken:e.user.access_token}:t;r.managementApi.getClient(u).then(function(t){return i.auth0=t,o(),null}).catch(function(t){o(t)})}}},function(t,e,n){const r=n(0).UnauthorizedError;t.exports=function(t,e,n){return t.user?n():n(new r("Authentication required for this endpoint."))}},function(t,e,n){const r=n(0);t.exports=function(t,e,n){if(null===t||void 0===t)throw new r.ArgumentError("Must provide the domain");if("string"!=typeof t||0===t.length)throw new r.ArgumentError("The provided domain is invalid: "+t);if(null===e||void 0===e)throw new r.ArgumentError("Must provide the webtaskUrl");if("string"!=typeof e||0===e.length)throw new r.ArgumentError("The provided webtaskUrl is invalid: "+e);if(null===n||void 0===n)throw new r.ArgumentError("Must provide the extensionSecret");if("string"!=typeof n||0===n.length)throw new r.ArgumentError("The provided extensionSecret is invalid: "+n);return function(o){if(null===o||void 0===o)throw new r.ArgumentError("Must provide the hookPath");if("string"!=typeof o||0===o.length)throw new r.ArgumentError("The provided hookPath is invalid: "+o);return function(i,s,u){if(i.headers.authorization&&"Bearer"===i.headers.authorization.split(" ")[0]){const c=i.headers.authorization.split(" ")[1];try{if(r.validateHookToken(t,e,o,n,c))return u()}catch(t){return u(t)}}return u(new r.HookTokenError("Hook token missing for the call to: "+o))}}}},function(t,e,n){const r=n(0);t.exports=function(t){return function(e,n,o){return e.webtaskContext&&t.setProvider(r.configProvider.fromWebtaskContext(e.webtaskContext)),o()}}},function(t,e,n){const r=n(5),o=n(123),i=n(63),s=n(0),u=n(18);t.exports=function(t){if(!t||"object"!=typeof t)throw new s.ArgumentError("Must provide the options");if(null===t.secret||void 0===t.secret)throw new s.ArgumentError("Must provide a valid secret");if("string"!=typeof t.secret||0===t.secret.length)throw new s.ArgumentError("The provided secret is invalid: "+t.secret);if(null===t.audience||void 0===t.audience)throw new s.ArgumentError("Must provide a valid secret");if("string"!=typeof t.audience||0===t.audience.length)throw new s.ArgumentError("The provided audience is invalid: "+t.audience);if(null===t.rta||void 0===t.rta)throw new s.ArgumentError("Must provide a valid rta");if("string"!=typeof t.rta||0===t.rta.length)throw new s.ArgumentError("The provided rta is invalid: "+t.rta);if(null===t.domain||void 0===t.domain)throw new s.ArgumentError("Must provide a valid domain");if("string"!=typeof t.domain||0===t.domain.length)throw new s.ArgumentError("The provided domain is invalid: "+t.domain);if(null===t.baseUrl||void 0===t.baseUrl)throw new s.ArgumentError("Must provide a valid base URL");if("string"!=typeof t.baseUrl||0===t.baseUrl.length)throw new s.ArgumentError("The provided base URL is invalid: "+t.baseUrl);if(null===t.clientName||void 0===t.clientName)throw new s.ArgumentError("Must provide a valid client name");if("string"!=typeof t.clientName||0===t.clientName.length)throw new s.ArgumentError("The provided client name is invalid: "+t.clientName);const e=t.stateKey||"state",n=t.urlPrefix||"",c=t.sessionStorageKey||"apiToken",a=r.Router();return a.get(n+"/login",function(r,i){const c=o.randomBytes(16).toString("hex");i.cookie(e,c);const a=new s.SessionManager(t.rta,t.domain,t.baseUrl),l=a.createAuthorizeUrl({redirectUri:u.getBaseUrl(r)+n+"/login/callback",scopes:t.scopes,expiration:t.expiration});i.redirect(l+"&state="+c)}),a.post(n+"/login/callback",i(),function(n,r,o){return n.cookies&&n.cookies[e]===n.body.state?new s.SessionManager(t.rta,t.domain,t.baseUrl).create(n.body.id_token,n.body.access_token,{secret:t.secret,issuer:t.baseUrl,audience:t.audience}).then(function(t){r.header("Content-Type","text/html"),r.status(200).send('<html><head><script type="text/javascript">sessionStorage.setItem("'+c+'", "'+t+'");window.location.href = "'+u.getBaseUrl(n)+'";<\/script></head></html>')}).catch(function(t){o(t)}):o(new s.ValidationError("Login failed. State mismatch."))}),a.get(n+"/logout",function(e,n){const r=encodeURIComponent(u.getBaseUrl(e));n.header("Content-Type","text/html"),n.status(200).send('<html><head><script type="text/javascript">sessionStorage.removeItem("'+c+'");window.location.href = "https://'+t.rta+"/v2/logout/?returnTo="+r+"&client_id="+r+'";<\/script></head></html>')}),a.get("/.well-known/oauth2-client-configuration",function(e,r){r.header("Content-Type","application/json"),r.status(200).send({redirect_uris:[u.getBaseUrl(e)+n+"/login/callback"],client_name:t.clientName,post_logout_redirect_uris:[u.getBaseUrl(e)]})}),a}},function(t,e,n){t.exports.dashboardAdmins=n(48)},function(t,e,n){const r=n(0),o=n(133);t.exports.createServer=function(t){const e=r.createServer(t);var n=null;return o.fromExpress(function(t,r){return n||(n=e(t.webtaskContext)),n(t,r)})}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){const r=n(54);t.exports.LogsProcessor=n(53),t.exports.LogsApiClient=n(19),t.exports.LogsApiStream=n(21),t.exports.logTypes=n(20),t.exports.reporters={SlackReporter:r}},function(t,e,n){function r(t,e){if(null===e||void 0===e)throw new i.ArgumentError("Must provide an options object");this.storage=new c(t),this.options=o.assign({},{batchSize:100,maxRetries:5,maxRunTimeSeconds:20},e)}const o=n(16),i=n(0),s=n(20),u=n(21),c=n(55);r.prototype.hasTimeLeft=function(t){const e=(new Date).getTime();return t+1e3*this.options.maxRunTimeSeconds>=e},r.prototype.getLogFilter=function(t){var e=t.logTypes||[];if(t.logLevel){const n=o.map(s,function(t,e){const n=t;return n.type=e,n});e=e.concat(o.map(o.filter(n,function(e){return e.level>=t.logLevel}),"type"))}return o.uniq(e)},r.prototype.getReport=function(t,e){const n=new Date(t).getTime(),r=e?new Date(e).getTime():(new Date).getTime();return this.storage.read().then(function(t){return o.filter(t.logs,function(t){const e=new Date(t.start).getTime(),o=new Date(t.end).getTime();return e>=n&&o<=r})}).then(function(t){const e={type:"report",processed:0,warnings:0,errors:0,checkpoint:""};return o.each(t,function(t){e.processed+=t.logsProcessed,e.checkpoint=t.checkpoint,t.error&&(e.errors+=1),t.warning&&(e.warnings+=1)}),e})},r.prototype.createStream=function(t){const e=this;return e.storage.getCheckpoint(t.startFrom).then(function(n){return e.options.logger&&e.options.logger.debug("Starting logs processor from checkpoint:",n),new u({checkpointId:n,types:e.getLogFilter(t),domain:t.domain,clientId:t.clientId,clientSecret:t.clientSecret,tokenCache:e.storage})})},r.prototype.run=function(t){const e=this;return new Promise(function(n,r){const o=(new Date).getTime();var i=0,s=0,u=[];const c=e.storage,a=(e.options,e.options.batchSize),l=e.options.maxRetries,f=function(t,o,i){e.options.logger&&e.options.logger.debug("Processor failed:",t),o.error=t,c.done(o,i).then(function(){return n({status:o,checkpoint:i})}).catch(r)},h=function(t,o){if(e.options.logger&&e.options.logger.debug("Processor run complete. Logs processed:",t.logsProcessed),t.logsProcessed>0){return(new Date).getTime()-s>=6048e5&&(t.warning="Logs are outdated more than for week. Last processed log has date is "+new Date(s)),c.done(t,o).then(function(){return n({status:t,checkpoint:o})}).catch(r)}return n({status:t,checkpoint:o})},p=function(){var t=a;return t-=u.length,t>100&&(t=100),t},d=function(n,r,s){if(!e.hasTimeLeft(o))return f(n,r.status,r.previousCheckpoint);if(i<l)return i+=1,t(u,s);const c=[n,"Skipping logs from "+r.previousCheckpoint+" to "+r.lastCheckpoint+" after "+l+" retries."];return e.options.logger&&e.options.logger.error(c[0],c[1]),f(c,r.status,r.lastCheckpoint)};e.createStream(e.options).then(function(n){const r=p();e.options.logger&&e.options.logger.debug("Loading next batch of logs. Next limit:",r),n.next(r),n.on("data",function(r){const i=r.logs;if(u=u.concat(i),i&&i.length&&(s=new Date(i[i.length-1].date).getTime()),u.length<a&&e.hasTimeLeft(o))return n.next(p());const c=function(t){return t?d(t,n,c):(u=[],e.hasTimeLeft(o)?(n.batchSaved(),n.next(p())):n.done())};return t(u,c)}),n.on("end",function(){const e=function(t){return t?d(t,n,e):(n.batchSaved(),h(n.status,n.lastCheckpoint))};t(u,e)}),n.on("error",function(t){f(t,n.status,n.previousCheckpoint)})}).catch(r)})},t.exports=r},function(t,e,n){function r(t){this.options=t||{}}const o=n(33),i=n(37);r.prototype.send=function(t,e){if(!t||"object"!=typeof t)throw new Error("object status is required");const n=this.options,r=this.createMessage(this.options,t,e);return new o(function(t,e){return n.hook?i.post(n.hook).send(r).set("Accept","application/json").end(function(n){return n?e(n):t()}):t()})},r.prototype.createMessage=function(t,e,n){const r={username:t.username||"auth0-logger",icon_emoji:t.icon||":rocket:",attachments:[]},o=t.title||"Auth0 Logger",i="report"===e.type?o+" Daily Report":e.error?o+" Error":o+" Success",s=e.error||null,u={fallback:t.fallback||i,text:t.text||i,error_field:{title:"Error",value:JSON.stringify(s),short:!1}};"report"===e.type?u.fields=[{title:"Logs processed",value:e.processed,short:!0},{title:"Warnings",value:e.warnings,short:!0},{title:"Errors",value:e.errors,short:!0},{title:"Next checkpoint",value:e.checkpoint,short:!0}]:u.fields=[{title:"Start time",value:e.start,short:!0},{title:"End time",value:e.end,short:!0},{title:"Logs processed",value:e.logsProcessed,short:!0},{title:"Next checkpoint",value:n,short:!0}];const c=t.url?" (<"+t.url+"|Details>)":null,a=u.fields;return e.error&&a.push(u.error_field),r.attachments.push({color:e.error?"#d13f42":"#7cd197",fallback:u.fallback,text:u.fallback+(c||""),fields:a}),r},t.exports=r},function(t,e,n){function r(t,e){if(!t)throw new i("The storageContext is required");this.storageContext=t,this.options=o({},{limit:400},e)}const o=n(16).assign,i=n(0).ArgumentError;r.prototype.read=function(){return this.storageContext.read().then(function(t){const e=t||{};return e.logs=e.logs||[],e})},r.prototype.write=function(t){return this.storageContext.write(t)},r.prototype.getCheckpoint=function(t){const e=this;return e.read().then(function(n){return t&&t!==n.startFrom?(n.startFrom=t,n.checkpointId=t,e.write(n).then(function(){return n.checkpointId||t||null})):n.checkpointId})},r.prototype.getToken=function(){return this.read().then(function(t){return t.logs_access_token||null})},r.prototype.setToken=function(t){const e=this;return e.read().then(function(n){return n.logs_access_token=t,e.write(n)})},r.prototype.done=function(t,e){const n=this;return n.read().then(function(r){return Buffer.byteLength(JSON.stringify(r),"utf8")>=1024*n.options.limit&&r.logs&&r.logs.length&&r.logs.splice(0,5),t.checkpoint=e,r.logs.push(t),r.checkpointId=e,n.write(r)})},t.exports=r},function(t,e,n){"use strict";var r=n(62),o=function(t){return t&&t.__esModule?t:{default:t}}(r),i=n(119),s=(n(36),n(128)),u=(n(17),n(52)),c=(n(101),n(3)),a=n(6);t.exports=function(t){return function(e,n,r){var l=e.webtaskContext&&e.webtaskContext.body||e.body||{},f=e.webtaskContext&&e.webtaskContext.headers||{};if(!(l.schedule&&"active"===l.state||f.referer===c("AUTH0_MANAGE_URL")+"/"&&f["if-none-match"]))return r();var h=Date.now(),p=(c("AWS_ACCESS_KEY"),c("AWS_SECRET_KEY"),c("LOG_GROUP"),c("AUTH0_DOMAIN")),d=function(t,e){if(!t)return e();var n={post_date:h,type_description:u.logTypes.get(t.type)};(0,o.default)(t).forEach(function(e){n[e]=t[e]}),n.message=t,lawger.log(p,n)},v=function(t,e){if(!t||!t.length)return e();a.info("Sending "+t.length+" logs to CloudWatch."),i.eachLimit(t,10,d,e)},m=new u.reporters.SlackReporter({hook:c("SLACK_INCOMING_WEBHOOK_URL"),username:"auth0-logs-to-cloudwatch",title:"Logs To CloudWatch"}),y={domain:c("AUTH0_DOMAIN"),clientId:c("AUTH0_CLIENT_ID"),clientSecret:c("AUTH0_CLIENT_SECRET"),batchSize:parseInt(c("BATCH_SIZE"),10),startFrom:c("START_FROM"),logTypes:c("LOG_TYPES"),logLevel:c("LOG_LEVEL")};(!y.batchSize||y.batchSize>100)&&(y.batchSize=100);var b=new u.LogsProcessor(t,y),g=function(e){var n=new Date,r=n.getTime(),o=r-864e5;b.getReport(o,r).then(function(t){return m.send(t,t.checkpoint)}).then(function(){return t.read()}).then(function(n){return n.lastReportDate=e,t.write(n)})},w=function(){t.read().then(function(t){var e=s().format("DD-MM-YYYY"),n=c("DAILY_REPORT_TIME")||16;t.lastReportDate!==e&&(new Date).getHours()>=n&&g(e)})};return b.run(v).then(function(t){t&&t.status&&t.status.error?m.send(t.status,t.checkpoint):!0!==c("SLACK_SEND_SUCCESS")&&"true"!==c("SLACK_SEND_SUCCESS")||m.send(t.status,t.checkpoint),w(),n.json(t)}).catch(function(t){m.send({error:t,logsProcessed:0},null),w(),r(t)})}}},function(t,e,n){"use strict";var r=n(5).Router,o=n(4).middlewares,i=n(3),s=n(6);t.exports=function(){var t=r(),e=o.validateHookToken(i("AUTH0_DOMAIN"),i("WT_URL"),i("EXTENSION_SECRET"));return t.use("/on-uninstall",e("/.extensions/on-uninstall")),t.use(o.managementApiClient({domain:i("AUTH0_DOMAIN"),clientId:i("AUTH0_CLIENT_ID"),clientSecret:i("AUTH0_CLIENT_SECRET")})),t.delete("/on-uninstall",function(t,e){var n=i("AUTH0_CLIENT_ID");t.auth0.clients.delete({client_id:n}).then(function(){s.debug("Deleted client "+n),e.sendStatus(204)}).catch(function(t){s.debug("Error deleting client: "+i("AUTH0_CLIENT_ID")),s.error(t),e.sendStatus(204)})}),t}},function(t,e,n){"use strict";(function(e){var r=(n(126),n(124)),o=(n(35),n(4).urlHelpers),i=n(3);t.exports=function(){var t='\n  <!DOCTYPE html>\n  <html lang="en">\n  <head>\n    <title><%= config.TITLE %></title>\n    <meta charset="UTF-8" />\n    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <link rel="shortcut icon" href="https://cdn.auth0.com/styleguide/4.6.13/lib/logos/img/favicon.png">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styles/zocial.min.css" />\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/manage/v0.3.1672/css/index.min.css" />\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styleguide/4.6.13/index.min.css" />\n    <% if (assets.style) { %><link rel="stylesheet" type="text/css" href="/app/<%= assets.style %>" /><% } %>\n    <% if (assets.version) { %><link rel="stylesheet" type="text/css" href="//cdn.auth0.com/extensions/auth0-logs-to-cloudwatch/assets/auth0-logs-to-cloudwatch.ui.<%= assets.version %>.css" /><% } %>\n    <% if (assets.customCss) { %><link rel="stylesheet" type="text/css" href="<%= assets.customCss %>" /><% } %>\n  </head>\n  <body>\n    <div id="app"></div>\n    <script type="text/javascript" src="//cdn.auth0.com/w2/auth0-7.0.4.min.js"><\/script>\n    <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.1672/js/bundle.js"><\/script>\n    <script type="text/javascript">window.config = <%- JSON.stringify(config) %>;<\/script>\n    <% if (assets.vendors) { %><script type="text/javascript" src="/app/<%= assets.vendors %>"><\/script><% } %>\n    <% if (assets.app) { %><script type="text/javascript" src="/app/<%= assets.app %>"><\/script><% } %>\n    <% if (assets.version) { %>\n    <script type="text/javascript" src="//cdn.auth0.com/extensions/auth0-logs-to-cloudwatch/assets/auth0-logs-to-cloudwatch.ui.vendors.<%= assets.version %>.js"><\/script>\n    <script type="text/javascript" src="//cdn.auth0.com/extensions/auth0-logs-to-cloudwatch/assets/auth0-logs-to-cloudwatch.ui.<%= assets.version %>.js"><\/script>\n    <% } %>\n  </body>\n  </html>\n  ';return function(e,n,s){if(0===e.url.indexOf("/api"))return s();var u={AUTH0_DOMAIN:i("AUTH0_DOMAIN"),AUTH0_CLIENT_ID:i("EXTENSION_CLIENT_ID"),AUTH0_MANAGE_URL:i("AUTH0_MANAGE_URL")||"https://manage.auth0.com",BASE_URL:o.getBaseUrl(e),BASE_PATH:o.getBasePath(e),TITLE:i("TITLE")};return n.send(r.render(t,{config:u,assets:{customCss:i("CUSTOM_CSS"),version:"1.6.0"}}))}}}).call(e,"/")},function(t,e,n){"use strict";var r=n(16),o=n(5).Router,i=n(4).middlewares,s=n(3),u=n(58);t.exports=function(t){var e=o(),n=i.authenticateAdmins({credentialsRequired:!0,secret:s("EXTENSION_SECRET"),audience:"urn:logs-to-cloudwatch",baseUrl:s("PUBLIC_WT_URL")||s("WT_URL"),onLoginSuccess:function(t,e,n){return n()}});return e.get("/",u()),e.get("/api/report",n,function(e,n,o){return t.read().then(function(t){var o=t&&t.logs?r.sortByOrder(t.logs,"start","desc"):[],i=e.query.filter&&"errors"===e.query.filter?r.filter(o,function(t){return!!t.error}):o,s=e.query.page&&parseInt(e.query.page)?parseInt(e.query.page)-1:0,u=e.query.per_page&&parseInt(e.query.per_page)||10,c=u*s;return n.json({logs:i.slice(c,c+u),total:i.length})}).catch(o)}),e}},function(t,e,n){"use strict";var r=n(5),o=n(26);t.exports=function(){var t=r.Router();return t.get("/",function(t,e){e.status(200).send(o)}),t}},function(t,e,n){"use strict";var r=n(4),o=n(39),i=n(3),s=n(6),u=r.createServer(function(t,e){return s.info("Starting Auth0 Logs to CloudWatch Extension - Version:","1.6.0"),o(t,e)});t.exports=function(t,e,n){i.setValue("PUBLIC_WT_URL",r.urlHelpers.getWebtaskUrl(e)),u(t,e,n)}},function(t,e,n){t.exports={default:n(65),__esModule:!0}},function(t,e,n){"use strict";function r(t,e){return function(n,r,o){if(n.cookies)return o();var s=n.headers.cookie,a=!t||Array.isArray(t)?t||[]:[t];if(n.secret=a[0],n.cookies=Object.create(null),n.signedCookies=Object.create(null),!s)return o();n.cookies=c.parse(s,e),0!==a.length&&(n.signedCookies=u(n.cookies,a),n.signedCookies=i(n.signedCookies)),n.cookies=i(n.cookies),o()}}function o(t){if("string"==typeof t&&"j:"===t.substr(0,2))try{return JSON.parse(t.slice(2))}catch(t){return}}function i(t){for(var e,n,r=Object.keys(t),i=0;i<r.length;i++)e=r[i],(n=o(t[e]))&&(t[e]=n);return t}function s(t,e){if("string"==typeof t){if("s:"!==t.substr(0,2))return t;for(var n=!e||Array.isArray(e)?e||[]:[e],r=0;r<n.length;r++){var o=a.unsign(t.slice(2),n[r]);if(!1!==o)return o}return!1}}function u(t,e){for(var n,r,o,i=Object.keys(t),u=Object.create(null),c=0;c<i.length;c++)r=i[c],o=t[r],n=s(o,e),o!==n&&(u[r]=n,delete t[r]);return u}var c=n(64),a=n(122);t.exports=r,t.exports.JSONCookie=o,t.exports.JSONCookies=i,t.exports.signedCookie=s,t.exports.signedCookies=u},function(t,e,n){"use strict";function r(t,e){if("string"!=typeof t)throw new TypeError("argument str must be a string");for(var n={},r=e||{},o=t.split(c),u=r.decode||s,a=0;a<o.length;a++){var l=o[a],f=l.indexOf("=");if(!(f<0)){var h=l.substr(0,f).trim(),p=l.substr(++f,l.length).trim();'"'==p[0]&&(p=p.slice(1,-1)),void 0==n[h]&&(n[h]=i(p,u))}}return n}function o(t,e,n){var r=n||{},o=r.encode||u;if("function"!=typeof o)throw new TypeError("option encode is invalid");if(!a.test(t))throw new TypeError("argument name is invalid");var i=o(e);if(i&&!a.test(i))throw new TypeError("argument val is invalid");var s=t+"="+i;if(null!=r.maxAge){var c=r.maxAge-0;if(isNaN(c))throw new Error("maxAge should be a Number");s+="; Max-Age="+Math.floor(c)}if(r.domain){if(!a.test(r.domain))throw new TypeError("option domain is invalid");s+="; Domain="+r.domain}if(r.path){if(!a.test(r.path))throw new TypeError("option path is invalid");s+="; Path="+r.path}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");s+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.sameSite){switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return s}function i(t,e){try{return e(t)}catch(e){return t}}e.parse=r,e.serialize=o;var s=decodeURIComponent,u=encodeURIComponent,c=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},function(t,e,n){n(90),t.exports=n(9).Object.keys},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(13);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var r=n(25),o=n(86),i=n(85);t.exports=function(t){return function(e,n,s){var u,c=r(e),a=o(c.length),l=i(s,a);if(t&&n!=n){for(;a>l;)if((u=c[l++])!=u)return!0}else for(;a>l;l++)if((t||l in c)&&c[l]===n)return t||l||0;return!t&&-1}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r=n(66);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r=n(13),o=n(12).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(12),o=n(9),i=n(70),s=n(75),u=function(t,e,n){var c,a,l,f=t&u.F,h=t&u.G,p=t&u.S,d=t&u.P,v=t&u.B,m=t&u.W,y=h?o:o[e]||(o[e]={}),b=y.prototype,g=h?r:p?r[e]:(r[e]||{}).prototype;h&&(n=e);for(c in n)(a=!f&&g&&void 0!==g[c])&&c in y||(l=a?g[c]:n[c],y[c]=h&&"function"!=typeof g[c]?n[c]:v&&a?i(l,r):m&&g[c]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):d&&"function"==typeof l?i(Function.call,l):l,d&&((y.virtual||(y.virtual={}))[c]=l,t&u.R&&b&&!b[c]&&s(b,c,l)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(78),o=n(82);t.exports=n(10)?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){t.exports=!n(10)&&!n(11)(function(){return 7!=Object.defineProperty(n(71)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(69);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(67),o=n(76),i=n(88),s=Object.defineProperty;e.f=n(10)?Object.defineProperty:function(t,e,n){if(r(t),e=i(e,!0),r(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(74),o=n(25),i=n(68)(!1),s=n(83)("IE_PROTO");t.exports=function(t,e){var n,u=o(t),c=0,a=[];for(n in u)n!=s&&r(u,n)&&a.push(n);for(;e.length>c;)r(u,n=e[c++])&&(~i(a,n)||a.push(n));return a}},function(t,e,n){var r=n(79),o=n(72);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e,n){var r=n(73),o=n(9),i=n(11);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],s={};s[t]=e(n),r(r.S+r.F*i(function(){n(1)}),"Object",s)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(84)("keys"),o=n(89);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e,n){var r=n(12),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e,n){var r=n(24),o=Math.max,i=Math.min;t.exports=function(t,e){return t=r(t),t<0?o(t+e,0):i(t,e)}},function(t,e,n){var r=n(24),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n){var r=n(23);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(13);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){var r=n(87),o=n(80);n(81)("keys",function(){return function(t){return o(r(t))}})},function(t,e,n){"use strict";var r=n(7),o=n(8),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),s=n(93),u=n(92),c=n(94);t.exports=function(t){return new r.JwksClient(t)},t.exports.ArgumentError=i.ArgumentError,t.exports.JwksError=i.JwksError,t.exports.JwksRateLimitError=i.JwksRateLimitError,t.exports.SigningKeyNotFoundError=i.SigningKeyNotFoundError,t.exports.expressJwtSecret=u.expressJwtSecret,t.exports.hapiJwt2Key=s.hapiJwt2Key,t.exports.koaJwtSecret=c.koaJwtSecret},function(t,e,n){"use strict";var r=n(8),o=n(7),i=function(t,e){return t&&"SigningKeyNotFoundError"===t.name?e(null):t?e(t):void 0};t.exports.expressJwtSecret=function(t){if(null===t||void 0===t)throw new r.ArgumentError("An options object must be provided when initializing expressJwtSecret");var e=new o.JwksClient(t),n=t.handleSigningKeyError||i;return function(t,r,o,i){if(!r||"RS256"!==r.alg)return i(null,null);e.getSigningKey(r.kid,function(t,e){return t?n(t,function(t){return i(t,null)}):i(null,e.publicKey||e.rsaPublicKey)})}}},function(t,e,n){"use strict";var r=n(8),o=n(7),i=function(t,e){return t&&"SigningKeyNotFoundError"===t.name?e(null,null,null):t?e(t,null,null):void 0};t.exports.hapiJwt2Key=function(t){if(null===t||void 0===t)throw new r.ArgumentError("An options object must be provided when initializing expressJwtSecret");var e=new o.JwksClient(t),n=t.handleSigningKeyError||i;return function(t,r){return t&&t.header?"RS256"!==t.header.alg?r(null,null,null):void e.getSigningKey(t.header.kid,function(t,e){return t?n(t,function(t){return r(t,null,null)}):r(null,e.publicKey||e.rsaPublicKey,e)}):r(null,null,null)}}},function(t,e,n){"use strict";var r=n(8),o=n(7);t.exports.koaJwtSecret=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t.jwksUri)throw new r.ArgumentError("No JWKS URI provided");var e=new o.JwksClient(t);return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.alg,o=n.kid;return new Promise(function(n,i){if("RS256"!==r)return i(new Error("Missing / invalid token algorithm"));e.getSigningKey(o,function(e,r){if(e)return t.handleSigningKeyError?t.handleSigningKeyError(e).then(i):i(e);n(r.publicKey||r.rsaPublicKey)})})}}},function(t,e,n){"use strict";function r(t){return t=t.match(/.{1,64}/g).join("\n"),t="-----BEGIN CERTIFICATE-----\n"+t+"\n-----END CERTIFICATE-----\n"}function o(t){var e=t[0];return e<"0"||e>"7"?"00"+t:t}function i(t){var e=t.toString(16);return e.length%2?"0"+e:e}function s(t){if(t<=127)return i(t);var e=i(t);return i(128+e.length/2)+e}function u(t,e){var n=new Buffer(t,"base64"),r=new Buffer(e,"base64"),i=o(n.toString("hex")),u=o(r.toString("hex")),c=i.length/2,a=u.length/2,l=s(c),f=s(a),h="30"+s(c+a+l.length/2+f.length/2+2)+"02"+l+i+"02"+f+u,p=new Buffer(h,"hex").toString("base64"),d="-----BEGIN RSA PUBLIC KEY-----\n";return d+=""+p.match(/.{1,64}/g).join("\n"),d+="\n-----END RSA PUBLIC KEY-----\n"}Object.defineProperty(e,"__esModule",{value:!0}),e.certToPEM=r,e.rsaPublicKeyToPEM=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:options,n=e.cacheMaxEntries,r=void 0===n?5:n,o=e.cacheMaxAge,s=void 0===o?(0,i.default)("10h"):o,c=(0,u.default)("jwks"),l=t.getSigningKey;return c("Configured caching of singing keys. Max: "+r+" / Age: "+s),(0,a.default)({load:function(t,e){l(t,function(n,r){return n?e(n):(c("Caching signing key for '"+t+"':",r),e(null,r))})},hash:function(t){return t},maxAge:s,max:r})};var o=n(130),i=r(o),s=n(15),u=r(s),c=n(127),a=r(c)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.rateLimitSigningKey=e.cacheSigningKey=void 0;var o=n(96),i=r(o),s=n(98),u=r(s);e.cacheSigningKey=i.default,e.rateLimitSigningKey=u.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:options,n=e.jwksRequestsPerMinute,r=void 0===n?10:n,o=(0,i.default)("jwks"),u=t.getSigningKey,a=new s.RateLimiter(r,"minute",!0);return o("Configured rate limiting to JWKS endpoint at "+r+"/minute"),function(t,e){a.removeTokens(1,function(n,r){return n?e(n):(o("Requests to the JWKS endpoint available for the next minute:",r),r<0?(o("Too many requests to the JWKS endpoint"),e(new c.default("Too many requests to the JWKS endpoint"))):u(t,e))})}};var o=n(15),i=r(o),s=n(114),u=n(29),c=r(u)},function(t,e){function n(t){this.message=t}function r(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,s=0,u=0,c="";i=e.charAt(u++);~i&&(r=s%4?64*r+i:i,s++%4)?c+=String.fromCharCode(255&r>>(-2*s&6)):0)i=o.indexOf(i);return c}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.name="InvalidCharacterError",t.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||r},function(t,e,n){function r(t){return decodeURIComponent(o(t).replace(/(.)/g,function(t,e){var n=e.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}var o=n(99);t.exports=function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return r(e)}catch(t){return o(e)}}},function(t,e,n){function r(t){function e(t){return n(t).then(function(e){if(!e)return r(t)})}function n(t){k("Checking if log group exists:",t);var e=s.defer(),n={logGroupNamePrefix:t};return o.describeLogGroups(n,function(t,n){t?e.reject(t):e.resolve(n.logGroups.length>0)}),e.promise.timeout(d.aws.timeout||h,"Could not communicate with AWS CloudWatch in a timely fashion")}function r(t){k("Creating log group:",t);var e=s.defer();return o.createLogGroup({logGroupName:t},function(n,r){n?e.reject(n):e.resolve(t)}),e.promise.timeout(d.aws.timeout||h,"Could not create log group in a timely fashion")}function l(t,e){return f(t,e).then(function(n){if(!n)return p(t,e)})}function f(t,e){k("Checking if log stream exists:",e);var n=s.defer(),r={logGroupName:t,logStreamNamePrefix:e};return o.describeLogStreams(r,function(t,e){t?n.reject(t):n.resolve(e.logStreams.length>0)}),n.promise.timeout(d.aws.timeout||h,"Could not communicate with AWS in a timely fashion")}function p(t,e){k("Creating log stream:",e);var n=s.defer();return o.createLogStream({logGroupName:t,logStreamName:e},function(t,r){t?n.reject(t):n.resolve(e)}),n.promise.timeout(d.aws.timeout||h,"Could not create log stream in a timely fashion")}function y(t,e,n,r){k("Uploading logs");var i=s.defer(),u={logEvents:n,logGroupName:t,logStreamName:e};return void 0!==r&&"string"==typeof r&&(u.sequenceToken=r),o.putLogEvents(u,function(r,o){if(r)if(r.code===v||r.code===m){var s=r.message.split(": ")[1];k("Getting sequence token",s),i.resolve(y(t,e,n,s))}else console.error(r),i.reject(r);else i.resolve(o)}),i.promise.timeout(d.aws.timeout||h,"Could not communicate with AWS in a timely fashion")}var b=this;this.showDebugLogs=!1,this.uploadMaxTimer=5e3,this.uploadBatchSize=500;var t=t,g=!1,w={},x={},E=new u.Subject,S=E;this.__defineGetter__("settings",function(){return d});var k=function(){b.showDebugLogs&&console.log.apply(b,arguments)},C=function(n){k(t,">> uploadQueuedLogs triggered with ",n.length," logs");var r=s(!0);g||(r=e(t).then(function(){g=!0}).catch(function(t){console.error(t)})),r.then(function(){a.from(n).groupBy("$.type").forEach(function(e){var n=e.key(),r=e.getSource(),o=s(!0);n in w||(o=l(t,n).then(function(){w[n]=!0}).catch(function(t){console.error(t)})),o.then(function(){r.forEach(function(t){delete t.type}),y(t,n,r,x[n]).then(function(t){x[n]=t.nextSequenceToken,k("Logs uploaded"),b.emit("uploaded")}).catch(function(t){console.log(t)})})})})},A=S.subscribe(C),N=function(){"function"==typeof A.dispose&&(A.dispose(),k("Disposed subscription")),S=E.windowWithTimeOrCount(b.uploadMaxTimer,b.uploadBatchSize).selectMany(function(t){return t.toArray()}).where(function(t){return t.length>0}),A=S.subscribe(C),k("Resubscribed")};this.config=function(t){c(this,t),t.settings&&(d=t.settings),i.config.update(d.aws),o=new i.CloudWatchLogs({apiVersion:"2015-01-28"}),N()},this.log=function(t,e){e={message:"string"==typeof e?e:JSON.stringify(e),timestamp:(new Date).getTime(),type:t},E.onNext(e)},this.config({})}var o,i=n(120),s=n(118),u=n(2),c=n(102),a=n(116),l=n(125).EventEmitter,f=n(38),h=5e3,p={},d={aws:{timeout:h},cloudwatch:{}},v="DataAlreadyAcceptedException",m="InvalidSequenceTokenException";f.inherits(r,l),t.exports={getOrCreate:function(t){return p.hasOwnProperty(t)||(p[t]=new r(t)),p[t]},config:function(t){c(!0,d,t)}}},function(t,e){var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===r.call(t)},i=function(t){"use strict";if(!t||"[object Object]"!==r.call(t))return!1;var e=n.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&n.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!o)return!1;var i;for(i in t);return void 0===i||n.call(t,i)};t.exports=function t(){"use strict";var e,n,r,s,u,c,a=arguments[0],l=1,f=arguments.length,h=!1;for("boolean"==typeof a?(h=a,a=arguments[1]||{},l=2):("object"!=typeof a&&"function"!=typeof a||null==a)&&(a={});l<f;++l)if(null!=(e=arguments[l]))for(n in e)r=a[n],s=e[n],a!==s&&(h&&s&&(i(s)||(u=o(s)))?(u?(u=!1,c=r&&o(r)?r:[]):c=r&&i(r)?r:{},a[n]=t(h,c,s)):void 0!==s&&(a[n]=s));return a}},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){function o(){try{return p.apply(this,arguments)}catch(t){return P.e=t,P}}function i(t){if(!k(t))throw new TypeError("fn must be a function");return p=t,o}function s(t,e,n){return new y(function(r){var o=!1,i=null,s=[];return t.subscribe(function(t){var u,c;try{c=e(t)}catch(t){return void r.onError(t)}if(u=0,o)try{u=n(c,i)}catch(t){return void r.onError(t)}else o=!0,i=c;u>0&&(i=c,s=[]),u>=0&&s.push(t)},function(t){r.onError(t)},function(){r.onNext(s),r.onCompleted()})},t)}function u(t){if(0===t.length)throw new D;return t[0]}function c(t,e,n,r){if(e<0)throw new L;return new y(function(o){var i=e;return t.subscribe(function(t){0==i--&&(o.onNext(t),o.onCompleted())},function(t){o.onError(t)},function(){n?(o.onNext(r),o.onCompleted()):o.onError(new L)})},t)}function a(t,e,n){return new y(function(r){var o=n,i=!1;return t.subscribe(function(t){i?r.onError(new Error("Sequence contains more than one element")):(o=t,i=!0)},function(t){r.onError(t)},function(){i||e?(r.onNext(o),r.onCompleted()):r.onError(new D)})},t)}function l(t,e,n){return new y(function(r){return t.subscribe(function(t){r.onNext(t),r.onCompleted()},function(t){r.onError(t)},function(){e?(r.onNext(n),r.onCompleted()):r.onError(new D)})},t)}function f(t,e,n){return new y(function(r){var o=n,i=!1;return t.subscribe(function(t){o=t,i=!0},function(t){r.onError(t)},function(){i||e?(r.onNext(o),r.onCompleted()):r.onError(new D)})},t)}function h(t,e,n,o){var i=R(e,n,3);return new y(function(e){var n=0;return t.subscribe(function(r){var s;try{s=i(r,n,t)}catch(t){return void e.onError(t)}s?(e.onNext(o?n:r),e.onCompleted()):n++},function(t){e.onError(t)},function(){e.onNext(o?-1:r),e.onCompleted()})},t)}var p,d=n.Observable,v=d.prototype,m=n.CompositeDisposable,y=n.AnonymousObservable,b=n.Disposable.empty,g=(n.internals.isEqual,n.helpers),w=g.not,x=g.defaultComparer,E=g.identity,S=g.defaultSubComparer,k=g.isFunction,C=g.isPromise,A=g.isArrayLike,N=g.isIterable,_=n.internals.inherits,T=d.fromPromise,O=d.from,R=n.internals.bindCallback,D=n.EmptyError,j=n.ObservableBase,L=n.ArgumentOutOfRangeError,P={e:{}};v.aggregate=function(){var t,e,n=!1,r=this;return 2===arguments.length?(n=!0,e=arguments[0],t=arguments[1]):t=arguments[0],new y(function(o){var i,s,u;return r.subscribe(function(r){!u&&(u=!0);try{i?s=t(s,r):(s=n?t(e,r):r,i=!0)}catch(t){return o.onError(t)}},function(t){o.onError(t)},function(){u&&o.onNext(s),!u&&n&&o.onNext(e),!u&&!n&&o.onError(new D),o.onCompleted()})},r)};var I=function(t){function e(e,n,r,o){this.source=e,this.acc=n,this.hasSeed=r,this.seed=o,t.call(this)}function n(t,e){this.o=t,this.acc=e.acc,this.hasSeed=e.hasSeed,this.seed=e.seed,this.hasAccumulation=!1,this.result=null,this.hasValue=!1,this.isStopped=!1}return _(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this))},n.prototype.onNext=function(t){this.isStopped||(!this.hasValue&&(this.hasValue=!0),this.hasAccumulation?this.result=i(this.acc)(this.result,t):(this.result=this.hasSeed?i(this.acc)(this.seed,t):t,this.hasAccumulation=!0),this.result===P&&this.o.onError(this.result.e))},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.hasValue&&this.o.onNext(this.result),!this.hasValue&&this.hasSeed&&this.o.onNext(this.seed),!this.hasValue&&!this.hasSeed&&this.o.onError(new D),this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.o.onError(t),!0)},e}(j);return v.reduce=function(t){var e=!1;if(2===arguments.length){e=!0;var n=arguments[1]}return new I(this,t,e,n)},v.some=function(t,e){var n=this;return t?n.filter(t,e).some():new y(function(t){return n.subscribe(function(){t.onNext(!0),t.onCompleted()},function(e){t.onError(e)},function(){t.onNext(!1),t.onCompleted()})},n)},v.any=function(){return this.some.apply(this,arguments)},v.isEmpty=function(){return this.any().map(w)},v.every=function(t,e){return this.filter(function(e){return!t(e)},e).some().map(w)},v.all=function(){return this.every.apply(this,arguments)},v.includes=function(t,e){function n(t,e){return 0===t&&0===e||t===e||isNaN(t)&&isNaN(e)}var r=this;return new y(function(o){var i=0,s=+e||0;return Math.abs(s)===1/0&&(s=0),s<0?(o.onNext(!1),o.onCompleted(),b):r.subscribe(function(e){i++>=s&&n(e,t)&&(o.onNext(!0),o.onCompleted())},function(t){o.onError(t)},function(){o.onNext(!1),o.onCompleted()})},this)},v.contains=function(t,e){v.includes(t,e)},v.count=function(t,e){return t?this.filter(t,e).count():this.reduce(function(t){return t+1},0)},v.indexOf=function(t,e){var n=this;return new y(function(r){var o=0,i=+e||0;return Math.abs(i)===1/0&&(i=0),i<0?(r.onNext(-1),r.onCompleted(),b):n.subscribe(function(e){o>=i&&e===t&&(r.onNext(o),r.onCompleted()),o++},function(t){r.onError(t)},function(){r.onNext(-1),r.onCompleted()})},n)},v.sum=function(t,e){return t&&k(t)?this.map(t,e).sum():this.reduce(function(t,e){return t+e},0)},v.minBy=function(t,e){return e||(e=S),s(this,t,function(t,n){return-1*e(t,n)})},v.min=function(t){return this.minBy(E,t).map(function(t){return u(t)})},v.maxBy=function(t,e){return e||(e=S),s(this,t,e)},v.max=function(t){return this.maxBy(E,t).map(function(t){return u(t)})},v.average=function(t,e){return t&&k(t)?this.map(t,e).average():this.reduce(function(t,e){return{sum:t.sum+e,count:t.count+1}},{sum:0,count:0}).map(function(t){if(0===t.count)throw new D;return t.sum/t.count})},v.sequenceEqual=function(t,e){var n=this;return e||(e=x),new y(function(r){var o=!1,i=!1,s=[],u=[],c=n.subscribe(function(t){var n,o;if(u.length>0){o=u.shift();try{n=e(o,t)}catch(t){return void r.onError(t)}n||(r.onNext(!1),r.onCompleted())}else i?(r.onNext(!1),r.onCompleted()):s.push(t)},function(t){r.onError(t)},function(){o=!0,0===s.length&&(u.length>0?(r.onNext(!1),r.onCompleted()):i&&(r.onNext(!0),r.onCompleted()))});(A(t)||N(t))&&(t=O(t)),C(t)&&(t=T(t));var a=t.subscribe(function(t){var n;if(s.length>0){var i=s.shift();try{n=e(i,t)}catch(t){return void r.onError(t)}n||(r.onNext(!1),r.onCompleted())}else o?(r.onNext(!1),r.onCompleted()):u.push(t)},function(t){r.onError(t)},function(){i=!0,0===u.length&&(s.length>0?(r.onNext(!1),r.onCompleted()):o&&(r.onNext(!0),r.onCompleted()))});return new m(c,a)},n)},v.elementAt=function(t){return c(this,t,!1)},v.elementAtOrDefault=function(t,e){return c(this,t,!0,e)},v.single=function(t,e){return t&&k(t)?this.where(t,e).single():a(this,!1)},v.singleOrDefault=function(t,e,n){return t&&k(t)?this.filter(t,n).singleOrDefault(null,e):a(this,!0,e)},v.first=function(t,e){return t?this.where(t,e).first():l(this,!1)},v.firstOrDefault=function(t,e,n){return t?this.where(t).firstOrDefault(null,e):l(this,!0,e)},v.last=function(t,e){return t?this.where(t,e).last():f(this,!1)},v.lastOrDefault=function(t,e,n){return t?this.where(t,n).lastOrDefault(null,e):f(this,!0,e)},v.find=function(t,e){return h(this,t,e,!1)},v.findIndex=function(t,e){return h(this,t,e,!0)},v.toSet=function(){if(void 0===t.Set)throw new TypeError;var e=this;return new y(function(n){var r=new t.Set;return e.subscribe(function(t){r.add(t)},function(t){n.onError(t)},function(){n.onNext(r),n.onCompleted()})},e)},v.toMap=function(e,n){if(void 0===t.Map)throw new TypeError;var r=this;return new y(function(o){var i=new t.Map;return r.subscribe(function(t){var r;try{r=e(t)}catch(t){return void o.onError(t)}var s=t;if(n)try{s=n(t)}catch(t){return void o.onError(t)}i.set(r,s)},function(t){o.onError(t)},function(){o.onNext(i),o.onCompleted()})},r)},n})}).call(e,n(1)(t))},function(t,e,n){(function(t){(function(r){var o={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},i=o[typeof window]&&window||this,s=o[typeof e]&&e&&!e.nodeType&&e,u=o[typeof t]&&t&&!t.nodeType&&t,c=(u&&u.exports,o[typeof global]&&global);!c||c.global!==c&&c.window!==c||(i=c),"object"==typeof t&&t&&t.exports===s?t.exports=r(i,t.exports,n(14)):i.Rx=r(i,{},i.Rx)}).call(this,function(t,e,n,r){function o(t,e){return Array.isArray(t)?i.call(e,t):a(t)?A(t.call(e)):l(t)?A(t):c(t)?s(t):isPromise(t)?u(t):typeof t===S?t:C(t)||Array.isArray(t)?i.call(e,t):t}function i(t){var e=this;return function(n){var r,i=Object.keys(t),s=i.length,u=new t.constructor;if(!s)return void x.schedule(function(){n(null,u)});for(var c=0,a=i.length;c<a;c++)!function(t,i){if(!r)try{if(typeof(t=o(t,e))!==S)return u[i]=t,--s||n(null,u);t.call(e,function(t,e){if(!r){if(t)return r=!0,n(t);u[i]=e,--s||n(null,u)}})}catch(t){r=!0,n(t)}}(t[i[c]],i[c])}}function s(t){return function(e){var n,r=!1;t.subscribe(function(t){n=t,r=!0},e,function(){r&&e(null,n)})}}function u(t){return function(e){t.then(function(t){e(null,t)},e)}}function c(t){return t&&typeof t.subscribe===S}function a(t){return t&&t.constructor&&"GeneratorFunction"===t.constructor.name}function l(t){return t&&typeof t.next===S&&typeof t[k]===S}function f(t){t&&x.schedule(function(){throw t})}function h(t,e,n){if(t.addEventListener)return t.addEventListener(e,n,!1),g(function(){t.removeEventListener(e,n,!1)});throw new Error("No listener found")}function p(t,e,n){var r=new w,o=Object.prototype.toString;if("[object NodeList]"===o.call(t)||"[object HTMLCollection]"===o.call(t))for(var i=0,s=t.length;i<s;i++)r.add(p(t.item(i),e,n));else t&&r.add(h(t,e,n));return r}var d=n.Observable,v=(d.prototype,d.fromPromise),m=d.throwError,y=n.AnonymousObservable,b=n.AsyncSubject,g=n.Disposable.create,w=n.CompositeDisposable,x=(n.Scheduler.immediate,n.Scheduler.default),E=n.Scheduler.isScheduler,S=(Array.prototype.slice,"function"),k="throw",C=n.internals.isObject,A=n.spawn=function(t){var e=a(t);return function(n){function r(t,e){x.schedule(n.bind(s,t,e))}function i(t,e){var n;if(arguments.length>2)for(var e=[],c=1,a=arguments.length;c<a;c++)e.push(arguments[c]);if(t)try{n=u[k](t)}catch(t){return r(t)}if(!t)try{n=u.next(e)}catch(t){return r(t)}if(n.done)return r(null,n.value);if(n.value=o(n.value,s),typeof n.value!==S)i(new TypeError("Rx.spawn only supports a function, Promise, Observable, Object or Array."));else{var l=!1;try{n.value.call(s,function(){l||(l=!0,i.apply(s,arguments))})}catch(t){x.schedule(function(){l||(l=!0,i.call(s,t))})}}}var s=this,u=t;if(e){for(var c=[],a=0,l=arguments.length;a<l;a++)c.push(arguments[a]);var l=c.length,h=l&&typeof c[l-1]===S;n=h?c.pop():f,u=t.apply(this,c)}else n=n||f;i()}};d.start=function(t,e,n){return N(t,e,n)()};var N=d.toAsync=function(t,e,n){return E(n)||(n=x),function(){var r=arguments,o=new b;return n.schedule(function(){var n;try{n=t.apply(e,r)}catch(t){return void o.onError(t)}o.onNext(n),o.onCompleted()}),o.asObservable()}};d.fromCallback=function(t,e,n){return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return new y(function(r){function i(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];if(n){try{o=n.apply(e,o)}catch(t){return r.onError(t)}r.onNext(o)}else o.length<=1?r.onNext.apply(r,o):r.onNext(o);r.onCompleted()}o.push(i),t.apply(e,o)}).publishLast().refCount()}},d.fromNodeCallback=function(t,e,n){return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return new y(function(r){function i(t){if(t)return void r.onError(t);for(var o=arguments.length,i=[],s=1;s<o;s++)i[s-1]=arguments[s];if(n){try{i=n.apply(e,i)}catch(t){return r.onError(t)}r.onNext(i)}else i.length<=1?r.onNext.apply(r,i):r.onNext(i);r.onCompleted()}o.push(i),t.apply(e,o)}).publishLast().refCount()}},n.config.useNativeEvents=!1,d.fromEvent=function(t,e,r){return t.addListener?_(function(n){t.addListener(e,n)},function(n){t.removeListener(e,n)},r):n.config.useNativeEvents||"function"!=typeof t.on||"function"!=typeof t.off?new y(function(n){return p(t,e,function(t){var e=t;if(r)try{e=r(arguments)}catch(t){return n.onError(t)}n.onNext(e)})}).publish().refCount():_(function(n){t.on(e,n)},function(n){t.off(e,n)},r)};var _=d.fromEventPattern=function(t,e,n){return new y(function(r){function o(t){var e=t;if(n)try{e=n(arguments)}catch(t){return r.onError(t)}r.onNext(e)}var i=t(o);return g(function(){e&&e(o,i)})}).publish().refCount()};return d.startAsync=function(t){var e;try{e=t()}catch(t){return m(t)}return v(e)},n})}).call(e,n(1)(t))},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){function o(){try{return u.apply(this,arguments)}catch(t){return C.e=t,C}}function i(t){if(!k(t))throw new TypeError("fn must be a function");return u=t,o}function s(t,e,n){return new l(function(r){function o(t,e){if(l[e]=t,u[e]=!0,c||(c=u.every(E))){if(s)return r.onError(s);var o=i(n).apply(null,l);if(o===C)return r.onError(o.e);r.onNext(o)}a&&l[1]&&r.onCompleted()}var s,u=[!1,!1],c=!1,a=!1,l=new Array(2);return new h(t.subscribe(function(t){o(t,0)},function(t){l[1]?r.onError(t):s=t},function(){a=!0,l[1]&&r.onCompleted()}),e.subscribe(function(t){o(t,1)},function(t){r.onError(t)},function(){a=!0,o(!0,1)}))},t)}var u,c=n.Observable,a=c.prototype,l=n.AnonymousObservable,f=n.internals.AbstractObserver,h=n.CompositeDisposable,p=n.Notification,d=n.Subject,v=n.Observer,m=n.Disposable.empty,y=n.Disposable.create,b=n.internals.inherits,g=n.internals.addProperties,w=n.Scheduler.timeout,x=n.Scheduler.currentThread,E=n.helpers.identity,S=n.Scheduler.isScheduler,k=n.helpers.isFunction,C=(n.Disposable.checkDisposed,{e:{}});n.Pauser=function(t){function e(){t.call(this)}return b(e,t),e.prototype.pause=function(){this.onNext(!1)},e.prototype.resume=function(){this.onNext(!0)},e}(d);var A=function(t){function e(t){var e=this.source.publish(),n=e.subscribe(t),r=m,o=this.pauser.distinctUntilChanged().subscribe(function(t){t?r=e.connect():(r.dispose(),r=m)});return new h(n,r,o)}function n(n,r){this.source=n,this.controller=new d,r&&r.subscribe?this.pauser=this.controller.merge(r):this.pauser=this.controller,t.call(this,e,n)}return b(n,t),n.prototype.pause=function(){this.controller.onNext(!1)},n.prototype.resume=function(){this.controller.onNext(!0)},n}(c);a.pausable=function(t){return new A(this,t)};var N=function(t){function e(t){function e(){for(;o.length>0;)t.onNext(o.shift())}var n,o=[];return s(this.source,this.pauser.distinctUntilChanged().startWith(!1),function(t,e){return{data:t,shouldFire:e}}).subscribe(function(i){n!==r&&i.shouldFire!=n?(n=i.shouldFire,i.shouldFire&&e()):(n=i.shouldFire,i.shouldFire?t.onNext(i.data):o.push(i.data))},function(n){e(),t.onError(n)},function(){e(),t.onCompleted()})}function n(n,r){this.source=n,this.controller=new d,r&&r.subscribe?this.pauser=this.controller.merge(r):this.pauser=this.controller,t.call(this,e,n)}return b(n,t),n.prototype.pause=function(){this.controller.onNext(!1)},n.prototype.resume=function(){this.controller.onNext(!0)},n}(c);a.pausableBuffered=function(t){return new N(this,t)};var _=function(t){function e(t){return this.source.subscribe(t)}function n(n,r,o){t.call(this,e,n),this.subject=new T(r,o),this.source=n.multicast(this.subject).refCount()}return b(n,t),n.prototype.request=function(t){return this.subject.request(null==t?-1:t)},n}(c),T=function(t){function e(t){return this.subject.subscribe(t)}function n(n,r){null==n&&(n=!0),t.call(this,e),this.subject=new d,this.enableQueue=n,this.queue=n?[]:null,this.requestedCount=0,this.requestedDisposable=m,this.error=null,this.hasFailed=!1,this.hasCompleted=!1,this.scheduler=r||x}return b(n,t),g(n.prototype,v,{onCompleted:function(){this.hasCompleted=!0,this.enableQueue&&0!==this.queue.length?this.queue.push(p.createOnCompleted()):this.subject.onCompleted()},onError:function(t){this.hasFailed=!0,this.error=t,this.enableQueue&&0!==this.queue.length?this.queue.push(p.createOnError(t)):this.subject.onError(t)},onNext:function(t){var e=!1;0===this.requestedCount?this.enableQueue&&this.queue.push(p.createOnNext(t)):(-1!==this.requestedCount&&0==this.requestedCount--&&this.disposeCurrentRequest(),e=!0),e&&this.subject.onNext(t)},_processRequest:function(t){if(this.enableQueue){for(;this.queue.length>=t&&t>0||this.queue.length>0&&"N"!==this.queue[0].kind;){var e=this.queue.shift();e.accept(this.subject),"N"===e.kind?t--:(this.disposeCurrentRequest(),this.queue=[])}return{numberOfItems:t,returnValue:0!==this.queue.length}}return{numberOfItems:t,returnValue:!1}},request:function(t){this.disposeCurrentRequest();var e=this;return this.requestedDisposable=this.scheduler.scheduleWithState(t,function(t,n){var r=e._processRequest(n),o=r.numberOfItems;r.returnValue||(e.requestedCount=o,e.requestedDisposable=y(function(){e.requestedCount=0}))}),this.requestedDisposable},disposeCurrentRequest:function(){this.requestedDisposable.dispose(),this.requestedDisposable=m}}),n}(c);a.controlled=function(t,e){return t&&S(t)&&(e=t,t=!0),null==t&&(t=!0),new _(this,t,e)};var O=function(t){function e(t){this.subscription=this.source.subscribe(new r(t,this,this.subscription));var e=this;return w.schedule(function(){e.source.request(1)}),this.subscription}function n(n){t.call(this,e,n),this.source=n}b(n,t);var r=function(t){function e(e,n,r){t.call(this),this.observer=e,this.observable=n,this.cancel=r}b(e,t);var n=e.prototype;return n.completed=function(){this.observer.onCompleted(),this.dispose()},n.error=function(t){this.observer.onError(t),this.dispose()},n.next=function(t){this.observer.onNext(t);var e=this;w.schedule(function(){e.observable.source.request(1)})},n.dispose=function(){this.observer=null,this.cancel&&(this.cancel.dispose(),this.cancel=null),t.prototype.dispose.call(this)},e}(f);return n}(c);_.prototype.stopAndWait=function(){return new O(this)};var R=function(t){function e(t){this.subscription=this.source.subscribe(new r(t,this,this.subscription));var e=this;return w.schedule(function(){e.source.request(e.windowSize)}),this.subscription}function n(n,r){t.call(this,e,n),this.source=n,this.windowSize=r}b(n,t);var r=function(t){function e(t,e,n){this.observer=t,this.observable=e,this.cancel=n,this.received=0}b(e,t);var n=e.prototype;return n.completed=function(){this.observer.onCompleted(),this.dispose()},n.error=function(t){this.observer.onError(t),this.dispose()},n.next=function(t){if(this.observer.onNext(t),this.received=++this.received%this.observable.windowSize,0===this.received){var e=this;w.schedule(function(){e.observable.source.request(e.observable.windowSize)})}},n.dispose=function(){this.observer=null,this.cancel&&(this.cancel.dispose(),this.cancel=null),t.prototype.dispose.call(this)},e}(f);return n}(c);return _.prototype.windowed=function(t){return new R(this,t)},n})}).call(e,n(1)(t))},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){function o(t){for(var e=t.length,n=new Array(e),r=0;r<e;r++)n[r]=t[r];return n}var i=n.Observable,s=i.prototype,u=n.AnonymousObservable,c=n.Subject,a=n.AsyncSubject,l=n.Observer,f=n.internals.ScheduledObserver,h=n.Disposable.create,p=n.Disposable.empty,d=n.CompositeDisposable,v=n.Scheduler.currentThread,m=n.helpers.isFunction,y=n.internals.inherits,b=n.internals.addProperties,g=n.Disposable.checkDisposed;s.multicast=function(t,e){var n=this;return"function"==typeof t?new u(function(r){var o=n.multicast(t());return new d(e(o).subscribe(r),o.connect())},n):new S(n,t)},s.publish=function(t){return t&&m(t)?this.multicast(function(){return new c},t):this.multicast(new c)},s.share=function(){return this.publish().refCount()},s.publishLast=function(t){return t&&m(t)?this.multicast(function(){return new a},t):this.multicast(new a)},s.publishValue=function(t,e){return 2===arguments.length?this.multicast(function(){return new x(e)},t):this.multicast(new x(t))},s.shareValue=function(t){return this.publishValue(t).refCount()},s.replay=function(t,e,n,r){return t&&m(t)?this.multicast(function(){return new E(e,n,r)},t):this.multicast(new E(e,n,r))},s.shareReplay=function(t,e,n){return this.replay(null,t,e,n).refCount()};var w=function(t,e){this.subject=t,this.observer=e};w.prototype.dispose=function(){if(!this.subject.isDisposed&&null!==this.observer){var t=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(t,1),this.observer=null}};var x=n.BehaviorSubject=function(t){function e(t){return g(this),this.isStopped?(this.hasError?t.onError(this.error):t.onCompleted(),p):(this.observers.push(t),t.onNext(this.value),new w(this,t))}function n(n){t.call(this,e),this.value=n,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return y(n,t),b(n.prototype,l,{getValue:function(){if(g(this),this.hasError)throw this.error;return this.value},hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(g(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=o(this.observers),n=e.length;t<n;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(g(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=o(this.observers),r=n.length;e<r;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(g(this),!this.isStopped){this.value=t;for(var e=0,n=o(this.observers),r=n.length;e<r;e++)n[e].onNext(t)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.exception=null}}),n}(i),E=n.ReplaySubject=function(t){function e(t,e){return h(function(){e.dispose(),!t.isDisposed&&t.observers.splice(t.observers.indexOf(e),1)})}function n(t){var n=new f(this.scheduler,t),r=e(this,n);g(this),this._trim(this.scheduler.now()),this.observers.push(n);for(var o=0,i=this.q.length;o<i;o++)n.onNext(this.q[o].value);return this.hasError?n.onError(this.error):this.isStopped&&n.onCompleted(),n.ensureActive(),r}function r(e,r,o){this.bufferSize=null==e?i:e,this.windowSize=null==r?i:r,this.scheduler=o||v,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,t.call(this,n)}var i=Math.pow(2,53)-1;return y(r,t),b(r.prototype,l.prototype,{hasObservers:function(){return this.observers.length>0},_trim:function(t){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&t-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(t){if(g(this),!this.isStopped){var e=this.scheduler.now();this.q.push({interval:e,value:t}),this._trim(e);for(var n=0,r=o(this.observers),i=r.length;n<i;n++){var s=r[n];s.onNext(t),s.ensureActive()}}},onError:function(t){if(g(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;var e=this.scheduler.now();this._trim(e);for(var n=0,r=o(this.observers),i=r.length;n<i;n++){var s=r[n];s.onError(t),s.ensureActive()}this.observers.length=0}},onCompleted:function(){if(g(this),!this.isStopped){this.isStopped=!0;var t=this.scheduler.now();this._trim(t);for(var e=0,n=o(this.observers),r=n.length;e<r;e++){var i=n[e];i.onCompleted(),i.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),r}(i),S=n.ConnectableObservable=function(t){function e(e,n){var r,o=!1,i=e.asObservable();this.connect=function(){return o||(o=!0,r=new d(i.subscribe(n),h(function(){o=!1}))),r},t.call(this,function(t){return n.subscribe(t)})}return y(e,t),e.prototype.refCount=function(){var t,e=0,n=this;return new u(function(r){var o=1==++e,i=n.subscribe(r);return o&&(t=n.connect()),function(){i.dispose(),0==--e&&t.dispose()}})},e}(i);return s.singleInstance=function(){function t(){return r||(r=!0,e=n.finally(function(){r=!1}).publish().refCount()),e}var e,n=this,r=!1;return new u(function(e){return t().subscribe(e)})},n})}).call(e,n(1)(t))},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){function o(t,e){return t.groupJoin(this,e,d,function(t,e){return e})}function i(t){var e=this;return new m(function(n){var r=new h,o=new c,i=new a(o);return n.onNext(y(r,i)),o.add(e.subscribe(function(t){r.onNext(t)},function(t){r.onError(t),n.onError(t)},function(){r.onCompleted(),n.onCompleted()})),E(t)&&(t=S(t)),o.add(t.subscribe(function(t){r.onCompleted(),r=new h,n.onNext(y(r,i))},function(t){r.onError(t),n.onError(t)},function(){r.onCompleted(),n.onCompleted()})),i},e)}function s(t){var e=this;return new m(function(n){function r(){var e;try{e=t()}catch(t){return void n.onError(t)}E(e)&&(e=S(e));var i=new l;o.setDisposable(i),i.setDisposable(e.take(1).subscribe(w,function(t){u.onError(t),n.onError(t)},function(){u.onCompleted(),u=new h,n.onNext(y(u,s)),r()}))}var o=new f,i=new c(o),s=new a(i),u=new h;return n.onNext(y(u,s)),i.add(e.subscribe(function(t){u.onNext(t)},function(t){u.onError(t),n.onError(t)},function(){u.onCompleted(),n.onCompleted()})),r(),s},e)}var u=n.Observable,c=n.CompositeDisposable,a=n.RefCountDisposable,l=n.SingleAssignmentDisposable,f=n.SerialDisposable,h=n.Subject,p=u.prototype,d=u.empty,v=u.never,m=n.AnonymousObservable,y=(n.Observer.create,n.internals.addRef),b=n.internals.isEqual,g=n.internals.inherits,w=n.helpers.noop,x=n.helpers.identity,E=n.helpers.isPromise,S=u.fromPromise,k=n.ArgumentOutOfRangeError,C=function(){function t(t){if(0==(1&t))return 2===t;for(var e=Math.sqrt(t),n=3;n<=e;){if(t%n==0)return!1;n+=2}return!0}function e(e){var n,r,o;for(n=0;n<u.length;++n)if((r=u[n])>=e)return r;for(o=1|e;o<u[u.length-1];){if(t(o))return o;o+=2}return e}function n(t){var e=757602046;if(!t.length)return e;for(var n=0,r=t.length;n<r;n++){e=(e<<5)-e+t.charCodeAt(n),e&=e}return e}function o(t){return t=61^t^t>>>16,t+=t<<3,t^=t>>>4,t*=668265261,t^=t>>>15}function i(){return{key:null,value:null,next:0,hashCode:0}}function s(t,e){if(t<0)throw new k;t>0&&this._initialize(t),this.comparer=e||b,this.freeCount=0,this.size=0,this.freeList=-1}var u=[1,3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143,4194301,8388593,16777213,33554393,67108859,134217689,268435399,536870909,1073741789,2147483647],c=function(){var t=0;return function(e){if(null==e)throw new Error("no such key");if("string"==typeof e)return n(e);if("number"==typeof e)return o(e);if("boolean"==typeof e)return!0===e?1:0;if(e instanceof Date)return o(e.valueOf());if(e instanceof RegExp)return n(e.toString());if("function"==typeof e.valueOf){var r=e.valueOf();if("number"==typeof r)return o(r);if("string"==typeof r)return n(r)}if(e.hashCode)return e.hashCode();var i=17*t++;return e.hashCode=function(){return i},i}}(),a=s.prototype;return a._initialize=function(t){var n,r=e(t);for(this.buckets=new Array(r),this.entries=new Array(r),n=0;n<r;n++)this.buckets[n]=-1,this.entries[n]=i();this.freeList=-1},a.add=function(t,e){this._insert(t,e,!0)},a._insert=function(t,e,n){this.buckets||this._initialize(0);for(var r,o=2147483647&c(t),i=o%this.buckets.length,s=this.buckets[i];s>=0;s=this.entries[s].next)if(this.entries[s].hashCode===o&&this.comparer(this.entries[s].key,t)){if(n)throw new Error("duplicate key");return void(this.entries[s].value=e)}this.freeCount>0?(r=this.freeList,this.freeList=this.entries[r].next,--this.freeCount):(this.size===this.entries.length&&(this._resize(),i=o%this.buckets.length),r=this.size,++this.size),this.entries[r].hashCode=o,this.entries[r].next=this.buckets[i],this.entries[r].key=t,this.entries[r].value=e,this.buckets[i]=r},a._resize=function(){var t=e(2*this.size),n=new Array(t);for(o=0;o<n.length;++o)n[o]=-1;var r=new Array(t);for(o=0;o<this.size;++o)r[o]=this.entries[o];for(var o=this.size;o<t;++o)r[o]=i();for(var s=0;s<this.size;++s){var u=r[s].hashCode%t;r[s].next=n[u],n[u]=s}this.buckets=n,this.entries=r},a.remove=function(t){if(this.buckets)for(var e=2147483647&c(t),n=e%this.buckets.length,r=-1,o=this.buckets[n];o>=0;o=this.entries[o].next){if(this.entries[o].hashCode===e&&this.comparer(this.entries[o].key,t))return r<0?this.buckets[n]=this.entries[o].next:this.entries[r].next=this.entries[o].next,this.entries[o].hashCode=-1,this.entries[o].next=this.freeList,this.entries[o].key=null,this.entries[o].value=null,this.freeList=o,++this.freeCount,!0;r=o}return!1},a.clear=function(){var t,e;if(!(this.size<=0)){for(t=0,e=this.buckets.length;t<e;++t)this.buckets[t]=-1;for(t=0;t<this.size;++t)this.entries[t]=i();this.freeList=-1,this.size=0}},a._findEntry=function(t){if(this.buckets)for(var e=2147483647&c(t),n=this.buckets[e%this.buckets.length];n>=0;n=this.entries[n].next)if(this.entries[n].hashCode===e&&this.comparer(this.entries[n].key,t))return n;return-1},a.count=function(){return this.size-this.freeCount},a.tryGetValue=function(t){var e=this._findEntry(t);return e>=0?this.entries[e].value:r},a.getValues=function(){var t=0,e=[];if(this.entries)for(var n=0;n<this.size;n++)this.entries[n].hashCode>=0&&(e[t++]=this.entries[n].value);return e},a.get=function(t){var e=this._findEntry(t);if(e>=0)return this.entries[e].value;throw new Error("no such key")},a.set=function(t,e){this._insert(t,e,!1)},a.containskey=function(t){return this._findEntry(t)>=0},s}();p.join=function(t,e,n,r){var o=this;return new m(function(i){var s=new c,u=!1,a=!1,f=0,h=0,p=new C,d=new C;return s.add(o.subscribe(function(t){var n=f++,o=new l;p.add(n,t),s.add(o);var c,a=function(){p.remove(n)&&0===p.count()&&u&&i.onCompleted(),s.remove(o)};try{c=e(t)}catch(t){return void i.onError(t)}o.setDisposable(c.take(1).subscribe(w,i.onError.bind(i),a)),d.getValues().forEach(function(e){var n;try{n=r(t,e)}catch(t){return void i.onError(t)}i.onNext(n)})},i.onError.bind(i),function(){u=!0,(a||0===p.count())&&i.onCompleted()})),s.add(t.subscribe(function(t){var e=h++,o=new l;d.add(e,t),s.add(o);var u,c=function(){d.remove(e)&&0===d.count()&&a&&i.onCompleted(),s.remove(o)};try{u=n(t)}catch(t){return void i.onError(t)}o.setDisposable(u.take(1).subscribe(w,i.onError.bind(i),c)),p.getValues().forEach(function(e){var n;try{n=r(e,t)}catch(t){return void i.onError(t)}i.onNext(n)})},i.onError.bind(i),function(){a=!0,(u||0===d.count())&&i.onCompleted()})),s},o)},p.groupJoin=function(t,e,n,r){var o=this;return new m(function(i){function s(t){return function(e){e.onError(t)}}var u=new c,f=new a(u),p=new C,d=new C,v=0,m=0;return u.add(o.subscribe(function(t){var n=new h,o=v++;p.add(o,n);var c;try{c=r(t,y(n,f))}catch(t){return p.getValues().forEach(s(t)),void i.onError(t)}i.onNext(c),d.getValues().forEach(function(t){n.onNext(t)});var a=new l;u.add(a);var m,b=function(){p.remove(o)&&n.onCompleted(),u.remove(a)};try{m=e(t)}catch(t){return p.getValues().forEach(s(t)),void i.onError(t)}a.setDisposable(m.take(1).subscribe(w,function(t){p.getValues().forEach(s(t)),i.onError(t)},b))},function(t){p.getValues().forEach(s(t)),i.onError(t)},i.onCompleted.bind(i))),u.add(t.subscribe(function(t){var e=m++;d.add(e,t);var r=new l;u.add(r);var o,c=function(){d.remove(e),u.remove(r)};try{o=n(t)}catch(t){return p.getValues().forEach(s(t)),void i.onError(t)}r.setDisposable(o.take(1).subscribe(w,function(t){p.getValues().forEach(s(t)),i.onError(t)},c)),p.getValues().forEach(function(e){e.onNext(t)})},function(t){p.getValues().forEach(s(t)),i.onError(t)})),f},o)},p.buffer=function(t,e){return this.window.apply(this,arguments).selectMany(function(t){return t.toArray()})},p.window=function(t,e){return 1===arguments.length&&"function"!=typeof arguments[0]?i.call(this,t):"function"==typeof t?s.call(this,t):o.call(this,t,e)},p.pairwise=function(){var t=this;return new m(function(e){var n,r=!1;return t.subscribe(function(t){r?e.onNext([n,t]):r=!0,n=t},e.onError.bind(e),e.onCompleted.bind(e))},t)},p.partition=function(t,e){return[this.filter(t,e),this.filter(function(n,r,o){return!t.call(e,n,r,o)})]},p.groupBy=function(t,e,n){return this.groupByUntil(t,e,v,n)},p.groupByUntil=function(t,e,n,r){var o=this;return e||(e=x),r||(r=b),new m(function(i){function s(t){return function(e){e.onError(t)}}var u=new C(0,r),f=new c,p=new a(f);return f.add(o.subscribe(function(r){var o;try{o=t(r)}catch(t){return u.getValues().forEach(s(t)),void i.onError(t)}var c=!1,a=u.tryGetValue(o);if(a||(a=new h,u.set(o,a),c=!0),c){var d=new A(o,a,p),v=new A(o,a);try{duration=n(v)}catch(t){return u.getValues().forEach(s(t)),void i.onError(t)}i.onNext(d);var m=new l;f.add(m);var y=function(){u.remove(o)&&a.onCompleted(),f.remove(m)};m.setDisposable(duration.take(1).subscribe(w,function(t){u.getValues().forEach(s(t)),i.onError(t)},y))}var b;try{b=e(r)}catch(t){return u.getValues().forEach(s(t)),void i.onError(t)}a.onNext(b)},function(t){u.getValues().forEach(s(t)),i.onError(t)},function(){u.getValues().forEach(function(t){t.onCompleted()}),i.onCompleted()})),p},o)};var A=function(t){function e(t){return this.underlyingObservable.subscribe(t)}function n(n,r,o){t.call(this,e),this.key=n,this.underlyingObservable=o?new m(function(t){return new c(o.getDisposable(),r.subscribe(t))}):r}return g(n,t),n}(u);return n})}).call(e,n(1)(t))},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){function o(t,e){return new O(t,e)}var i=n.Observable,s=i.prototype,u=n.AnonymousObservable,c=i.concat,a=i.defer,l=i.empty,f=n.Disposable.empty,h=n.CompositeDisposable,p=n.SerialDisposable,d=n.SingleAssignmentDisposable,v=(n.internals.Enumerator,n.internals.Enumerable),m=v.of,y=n.Scheduler.immediate,b=n.Scheduler.currentThread,g=(Array.prototype.slice,n.AsyncSubject),w=n.Observer,x=n.internals.inherits,E=n.internals.bindCallback,S=n.internals.addProperties,k=n.helpers,C=k.noop,A=k.isPromise,N=n.Scheduler.isScheduler,_=i.fromPromise,T="function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_";t.Set&&"function"==typeof(new t.Set)["@@iterator"]&&(T="@@iterator");n.doneEnumerator={done:!0,value:r},n.helpers.isIterable=function(t){return t[T]!==r},n.helpers.isArrayLike=function(t){return t&&t.length!==r};n.helpers.iterator=T;var O=function(t){function e(t,e){this.c=t,this.s=e}return x(e,t),e.prototype[T]=function(){var t=this;return{next:function(){return t.c()?{done:!1,value:t.s}:{done:!0,value:void 0}}}},e}(v);s.letBind=s.let=function(t){return t(this)},i.if=i.ifThen=function(t,e,n){return a(function(){return n||(n=l()),A(e)&&(e=_(e)),A(n)&&(n=_(n)),"function"==typeof n.now&&(n=l(n)),t()?e:n})},i.for=i.forIn=function(t,e,n){return m(t,e,n).concat()};var R=i.while=i.whileDo=function(t,e){return A(e)&&(e=_(e)),o(t,e).concat()};s.doWhile=function(t){return c([this,R(t,this)])},i.case=i.switchCase=function(t,e,n){return a(function(){A(n)&&(n=_(n)),n||(n=l()),"function"==typeof n.now&&(n=l(n));var r=e[t()];return A(r)&&(r=_(r)),r||n})},s.expand=function(t,e){N(e)||(e=y);var n=this;return new u(function(r){var o=[],i=new p,s=new h(i),u=0,c=!1,a=function(){var n=!1;o.length>0&&(n=!c,c=!0),n&&i.setDisposable(e.scheduleRecursive(function(e){var n;if(!(o.length>0))return void(c=!1);n=o.shift();var i=new d;s.add(i),i.setDisposable(n.subscribe(function(e){r.onNext(e);var n=null;try{n=t(e)}catch(t){r.onError(t)}o.push(n),u++,a()},r.onError.bind(r),function(){s.remove(i),0===--u&&r.onCompleted()})),e()}))};return o.push(n),u++,a(),s},this)},i.forkJoin=function(){var t=[];if(Array.isArray(arguments[0]))t=arguments[0];else for(var e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return new u(function(e){var n=t.length;if(0===n)return e.onCompleted(),f;for(var r=new h,o=!1,i=new Array(n),s=new Array(n),u=new Array(n),c=0;c<n;c++)!function(c){var a=t[c];A(a)&&(a=_(a)),r.add(a.subscribe(function(t){o||(i[c]=!0,u[c]=t)},function(t){o=!0,e.onError(t),r.dispose()},function(){if(!o){if(!i[c])return void e.onCompleted();s[c]=!0;for(var t=0;t<n;t++)if(!s[t])return;o=!0,e.onNext(u),e.onCompleted()}}))}(c);return r})},s.forkJoin=function(t,e){var n=this;return new u(function(r){var o,i,s=!1,u=!1,c=!1,a=!1,l=new d,f=new d;return A(t)&&(t=_(t)),l.setDisposable(n.subscribe(function(t){c=!0,o=t},function(t){f.dispose(),r.onError(t)},function(){if(s=!0,u)if(c)if(a){var t;try{t=e(o,i)}catch(t){return void r.onError(t)}r.onNext(t),r.onCompleted()}else r.onCompleted();else r.onCompleted()})),f.setDisposable(t.subscribe(function(t){a=!0,i=t},function(t){l.dispose(),r.onError(t)},function(){if(u=!0,s)if(c)if(a){var t;try{t=e(o,i)}catch(t){return void r.onError(t)}r.onNext(t),r.onCompleted()}else r.onCompleted();else r.onCompleted()})),new h(l,f)},n)},s.manySelect=s.extend=function(t,e){N(e)||(e=y);var n=this;return a(function(){var r;return n.map(function(t){var e=new D(t);return r&&r.onNext(t),r=e,e}).tap(C,function(t){r&&r.onError(t)},function(){r&&r.onCompleted()}).observeOn(e).map(t)},n)};var D=function(t){function e(t){var e=this,n=new h;return n.add(b.schedule(function(){t.onNext(e.head),n.add(e.tail.mergeAll().subscribe(t))})),n}function n(n){t.call(this,e),this.head=n,this.tail=new g}return x(n,t),S(n.prototype,w,{onCompleted:function(){this.onNext(i.empty())},onError:function(t){this.onNext(i.throwError(t))},onNext:function(t){this.tail.onNext(t),this.tail.onCompleted()}}),n}(i);return s.exclusive=function(){var t=this;return new u(function(e){var n=!1,r=!1,o=new d,i=new h;return i.add(o),o.setDisposable(t.subscribe(function(t){if(!n){n=!0,A(t)&&(t=_(t));var o=new d;i.add(o),o.setDisposable(t.subscribe(e.onNext.bind(e),e.onError.bind(e),function(){i.remove(o),n=!1,r&&1===i.length&&e.onCompleted()}))}},e.onError.bind(e),function(){r=!0,n||1!==i.length||e.onCompleted()})),i},this)},s.exclusiveMap=function(t,e){var n=this,r=E(t,e,3);return new u(function(t){var e=0,o=!1,i=!0,s=new d,u=new h;return u.add(s),s.setDisposable(n.subscribe(function(n){o||(o=!0,innerSubscription=new d,u.add(innerSubscription),A(n)&&(n=_(n)),innerSubscription.setDisposable(n.subscribe(function(o){var i;try{i=r(o,e++,n)}catch(e){return void t.onError(e)}t.onNext(i)},function(e){t.onError(e)},function(){u.remove(innerSubscription),o=!1,i&&1===u.length&&t.onCompleted()})))},function(e){t.onError(e)},function(){i=!0,1!==u.length||o||t.onCompleted()})),u},this)},n})}).call(e,n(1)(t))},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){function o(t){this.patterns=t}function i(t,e){this.expression=t,this.selector=e}function s(t,e,n){var r=t.get(e);if(!r){var o=new g(e,n);return t.set(e,o),o}return r}function u(t,e,n){this.joinObserverArray=t,this.onNext=e,this.onCompleted=n,this.joinObservers=new b;for(var r=0,o=this.joinObserverArray.length;r<o;r++){var i=this.joinObserverArray[r];this.joinObservers.set(i,i)}}var c=n.Observable,a=c.prototype,l=n.AnonymousObservable,f=c.throwError,h=n.Observer.create,p=n.SingleAssignmentDisposable,d=n.CompositeDisposable,v=n.internals.AbstractObserver,m=n.helpers.noop,y=(n.internals.isEqual,n.internals.inherits),b=(n.internals.Enumerable,n.internals.Enumerator,n.iterator,n.doneEnumerator,t.Map||function(){function t(){this._keys=[],this._values=[]}return t.prototype.get=function(t){var e=this._keys.indexOf(t);return-1!==e?this._values[e]:r},t.prototype.set=function(t,e){var n=this._keys.indexOf(t);-1!==n&&(this._values[n]=e),this._values[this._keys.push(t)-1]=e},t.prototype.forEach=function(t,e){for(var n=0,r=this._keys.length;n<r;n++)t.call(e,this._values[n],this._keys[n])},t}());o.prototype.and=function(t){return new o(this.patterns.concat(t))},o.prototype.thenDo=function(t){return new i(this,t)},i.prototype.activate=function(t,e,n){for(var r=this,o=[],i=0,c=this.expression.patterns.length;i<c;i++)o.push(s(t,this.expression.patterns[i],e.onError.bind(e)));var a=new u(o,function(){var t;try{t=r.selector.apply(r,arguments)}catch(t){return void e.onError(t)}e.onNext(t)},function(){for(var t=0,e=o.length;t<e;t++)o[t].removeActivePlan(a);n(a)});for(i=0,c=o.length;i<c;i++)o[i].addActivePlan(a);return a},u.prototype.dequeue=function(){this.joinObservers.forEach(function(t){t.queue.shift()})},u.prototype.match=function(){var t,e,n=!0;for(t=0,e=this.joinObserverArray.length;t<e;t++)if(0===this.joinObserverArray[t].queue.length){n=!1;break}if(n){var r=[],o=!1;for(t=0,e=this.joinObserverArray.length;t<e;t++)r.push(this.joinObserverArray[t].queue[0]),"C"===this.joinObserverArray[t].queue[0].kind&&(o=!0);if(o)this.onCompleted();else{this.dequeue();var i=[];for(t=0,e=r.length;t<r.length;t++)i.push(r[t].value);this.onNext.apply(this,i)}}};var g=function(t){function e(e,n){t.call(this),this.source=e,this.onError=n,this.queue=[],this.activePlans=[],this.subscription=new p,this.isDisposed=!1}y(e,t);var n=e.prototype;return n.next=function(t){if(!this.isDisposed){if("E"===t.kind)return this.onError(t.exception);this.queue.push(t);for(var e=this.activePlans.slice(0),n=0,r=e.length;n<r;n++)e[n].match()}},n.error=m,n.completed=m,n.addActivePlan=function(t){this.activePlans.push(t)},n.subscribe=function(){this.subscription.setDisposable(this.source.materialize().subscribe(this))},n.removeActivePlan=function(t){this.activePlans.splice(this.activePlans.indexOf(t),1),0===this.activePlans.length&&this.dispose()},n.dispose=function(){t.prototype.dispose.call(this),this.isDisposed||(this.isDisposed=!0,this.subscription.dispose())},e}(v);return a.and=function(t){return new o([this,t])},a.thenDo=function(t){return new o([this]).thenDo(t)},c.when=function(){var t,e=arguments.length;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(e);for(var n=0;n<e;n++)t[n]=arguments[n]}return new l(function(e){var n=[],r=new b,o=h(function(t){e.onNext(t)},function(t){r.forEach(function(e){e.onError(t)}),e.onError(t)},function(t){e.onCompleted()});try{for(var i=0,s=t.length;i<s;i++)n.push(t[i].activate(r,o,function(t){var r=n.indexOf(t);n.splice(r,1),0===n.length&&e.onCompleted()}))}catch(t){f(t).subscribe(e)}var u=new d;return r.forEach(function(t){t.subscribe(),u.add(t)}),u})},n})}).call(e,n(1)(t))},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){var o=n.Observable,i=o.prototype,s=n.AnonymousObservable,u=o.never,c=n.internals.isEqual,a=n.helpers.defaultSubComparer;return i.jortSort=function(){return this.jortSortUntil(u())},i.jortSortUntil=function(t){var e=this;return new s(function(n){var r=[];return e.takeUntil(t).subscribe(r.push.bind(r),n.onError.bind(n),function(){var t=r.slice(0).sort(a);n.onNext(c(r,t)),n.onCompleted()})},e)},n})}).call(e,n(1)(t))},function(t,e,n){(function(t){(function(r){var o={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},i=o[typeof window]&&window||this,s=o[typeof e]&&e&&!e.nodeType&&e,u=o[typeof t]&&t&&!t.nodeType&&t,c=(u&&u.exports,o[typeof global]&&global);!c||c.global!==c&&c.window!==c||(i=c),"object"==typeof t&&t&&t.exports===s?t.exports=r(i,t.exports,n(14)):i.Rx=r(i,{},i.Rx)}).call(this,function(t,e,n,r){function o(t){this.predicate=t}function i(t){this.predicate=t}function s(t,e){var n=this;this.scheduler=t,this.messages=e,this.subscriptions=[],this.observers=[];for(var r=0,o=this.messages.length;r<o;r++){var i=this.messages[r],s=i.value;!function(e){t.scheduleAbsoluteWithState(null,i.time,function(){for(var t=n.observers.slice(0),r=0,o=t.length;r<o;r++)e.accept(t[r]);return h})}(s)}}var u=n.Observer,c=n.Observable,a=n.Notification,l=n.VirtualTimeScheduler,f=n.Disposable,h=f.empty,p=f.create,d=n.CompositeDisposable,v=(n.SingleAssignmentDisposable,n.internals.inherits),m=n.internals.isEqual;o.prototype.equals=function(t){return t===this||null!=t&&("N"===t.kind&&this.predicate(t.value))},i.prototype.equals=function(t){return t===this||null!=t&&("E"===t.kind&&this.predicate(t.exception))};var y=n.ReactiveTest={created:100,subscribed:200,disposed:1e3,onNext:function(t,e){return"function"==typeof e?new b(t,new o(e)):new b(t,a.createOnNext(e))},onError:function(t,e){return"function"==typeof e?new b(t,new i(e)):new b(t,a.createOnError(e))},onCompleted:function(t){return new b(t,a.createOnCompleted())},subscribe:function(t,e){return new g(t,e)}},b=n.Recorded=function(t,e,n){this.time=t,this.value=e,this.comparer=n||m};b.prototype.equals=function(t){return this.time===t.time&&this.comparer(this.value,t.value)},b.prototype.toString=function(){return this.value.toString()+"@"+this.time};var g=n.Subscription=function(t,e){this.subscribe=t,this.unsubscribe=e||Number.MAX_VALUE};g.prototype.equals=function(t){return this.subscribe===t.subscribe&&this.unsubscribe===t.unsubscribe},g.prototype.toString=function(){return"("+this.subscribe+", "+(this.unsubscribe===Number.MAX_VALUE?"Infinite":this.unsubscribe)+")"},(n.MockDisposable=function(t){this.scheduler=t,this.disposes=[],this.disposes.push(this.scheduler.clock)}).prototype.dispose=function(){this.disposes.push(this.scheduler.clock)};var w=function(t){function e(e){t.call(this),this.scheduler=e,this.messages=[]}v(e,t);var n=e.prototype;return n.onNext=function(t){this.messages.push(new b(this.scheduler.clock,a.createOnNext(t)))},n.onError=function(t){this.messages.push(new b(this.scheduler.clock,a.createOnError(t)))},n.onCompleted=function(){this.messages.push(new b(this.scheduler.clock,a.createOnCompleted()))},e}(u);s.prototype.then=function(t,e){var o=this;this.subscriptions.push(new g(this.scheduler.clock));var i,u=this.subscriptions.length-1,c=n.Observer.create(function(e){var a=t(e);if(a&&"function"==typeof a.then)i=a;else{var l=o.scheduler.clock;i=new s(o.scheduler,[n.ReactiveTest.onNext(l,r),n.ReactiveTest.onCompleted(l)])}var f=o.observers.indexOf(c);o.observers.splice(f,1),o.subscriptions[u]=new g(o.subscriptions[u].subscribe,o.scheduler.clock)},function(t){e(t);var n=o.observers.indexOf(c);o.observers.splice(n,1),o.subscriptions[u]=new g(o.subscriptions[u].subscribe,o.scheduler.clock)});return this.observers.push(c),i||new s(this.scheduler,this.messages)};var x=function(t){function e(t){var e=this;this.observers.push(t),this.subscriptions.push(new g(this.scheduler.clock));var n=this.subscriptions.length-1;return p(function(){var r=e.observers.indexOf(t);e.observers.splice(r,1),e.subscriptions[n]=new g(e.subscriptions[n].subscribe,e.scheduler.clock)})}function n(n,r){t.call(this,e);var o,i,s=this;this.scheduler=n,this.messages=r,this.subscriptions=[],this.observers=[];for(var u=0,c=this.messages.length;u<c;u++)o=this.messages[u],i=o.value,function(t){n.scheduleAbsoluteWithState(null,o.time,function(){for(var e=s.observers.slice(0),n=0,r=e.length;n<r;n++)t.accept(e[n]);return h})}(i)}return v(n,t),n}(c),E=function(t){function e(t){var e,n,r=this;this.subscriptions.push(new g(this.scheduler.clock));for(var o=this.subscriptions.length-1,i=new d,s=0,u=this.messages.length;s<u;s++)e=this.messages[s],n=e.value,function(n){i.add(r.scheduler.scheduleRelativeWithState(null,e.time,function(){return n.accept(t),h}))}(n);return p(function(){r.subscriptions[o]=new g(r.subscriptions[o].subscribe,r.scheduler.clock),i.dispose()})}function n(n,r){t.call(this,e),this.scheduler=n,this.messages=r,this.subscriptions=[]}return v(n,t),n}(c);return n.TestScheduler=function(t){function e(t,e){return t>e?1:t<e?-1:0}function r(){t.call(this,0,e)}return v(r,t),r.prototype.scheduleAbsoluteWithState=function(e,n,r){return n<=this.clock&&(n=this.clock+1),t.prototype.scheduleAbsoluteWithState.call(this,e,n,r)},r.prototype.add=function(t,e){return t+e},r.prototype.toDateTimeOffset=function(t){return new Date(t).getTime()},r.prototype.toRelative=function(t){return t},r.prototype.startWithTiming=function(t,e,n,r){var o,i,s=this.createObserver();return this.scheduleAbsoluteWithState(null,e,function(){return o=t(),h}),this.scheduleAbsoluteWithState(null,n,function(){return i=o.subscribe(s),h}),this.scheduleAbsoluteWithState(null,r,function(){return i.dispose(),h}),this.start(),s},r.prototype.startWithDispose=function(t,e){return this.startWithTiming(t,y.created,y.subscribed,e)},r.prototype.startWithCreate=function(t){return this.startWithTiming(t,y.created,y.subscribed,y.disposed)},r.prototype.createHotObservable=function(){var t,e=arguments.length;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(e);for(var n=0;n<e;n++)t[n]=arguments[n]}return new x(this,t)},r.prototype.createColdObservable=function(){var t,e=arguments.length;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(e);for(var n=0;n<e;n++)t[n]=arguments[n]}return new E(this,t)},r.prototype.createResolvedPromise=function(t,e){return new s(this,[n.ReactiveTest.onNext(t,e),n.ReactiveTest.onCompleted(t)])},r.prototype.createRejectedPromise=function(t,e){return new s(this,[n.ReactiveTest.onError(t,e)])},r.prototype.createObserver=function(){return new w(this)},r}(l),n})}).call(e,n(1)(t))},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){function o(){try{return p.apply(this,arguments)}catch(t){return j.e=t,j}}function i(t){if(!O(t))throw new TypeError("fn must be a function");return p=t,o}function s(t,e){return new m(function(n){return e.scheduleWithAbsolute(t,function(){n.onNext(0),n.onCompleted()})})}function u(t,e,n){return new m(function(r){var o=t,i=N(e);return n.scheduleRecursiveWithAbsoluteAndState(0,o,function(t,e){if(i>0){var s=n.now();o+=i,o<=s&&(o=s+i)}r.onNext(t),e(t+1,o)})})}function c(t,e){return new m(function(n){return e.scheduleWithRelative(N(t),function(){n.onNext(0),n.onCompleted()})})}function a(t,e,n){return t===e?new m(function(t){return n.schedulePeriodicWithState(0,e,function(e){return t.onNext(e),e+1})}):y(function(){return u(n.now()+t,e,n)})}function l(t,e,n){return new m(function(r){var o,i=!1,s=new E,u=null,c=[],a=!1;return o=t.materialize().timestamp(n).subscribe(function(t){var o,l;"E"===t.value.kind?(c=[],c.push(t),u=t.value.exception,l=!a):(c.push({value:t.value,timestamp:t.timestamp+e}),l=!i,i=!0),l&&(null!==u?r.onError(u):(o=new x,s.setDisposable(o),o.setDisposable(n.scheduleRecursiveWithRelative(e,function(t){var e,o,s,l;if(null===u){a=!0;do{s=null,c.length>0&&c[0].timestamp-n.now()<=0&&(s=c.shift().value),null!==s&&s.accept(r)}while(null!==s);l=!1,o=0,c.length>0?(l=!0,o=Math.max(0,c[0].timestamp-n.now())):i=!1,e=u,a=!1,null!==e?r.onError(e):l&&t(o)}}))))}),new S(o,s)},t)}function f(t,e,n){return y(function(){return l(t,e-n.now(),n)})}function h(t,e){return new m(function(n){function r(){s&&(s=!1,n.onNext(o)),i&&n.onCompleted()}var o,i=!1,s=!1,u=new x;return u.setDisposable(t.subscribe(function(t){s=!0,o=t},function(t){n.onError(t)},function(){i=!0,u.dispose()})),new S(u,e.subscribe(r,function(t){n.onError(t)},r))},t)}var p,d=n.Observable,v=d.prototype,m=n.AnonymousObservable,y=d.defer,b=(d.empty,d.never),g=d.throwException,w=(d.fromArray,n.Scheduler.default),x=n.SingleAssignmentDisposable,E=n.SerialDisposable,S=n.CompositeDisposable,k=n.RefCountDisposable,C=n.Subject,A=n.internals.addRef,N=n.Scheduler.normalize,_=n.helpers,T=_.isPromise,O=_.isFunction,R=n.Scheduler.isScheduler,D=d.fromPromise,j={e:{}},L=d.interval=function(t,e){return a(t,t,R(e)?e:w)};d.timer=function(t,e,n){var o;return R(n)||(n=w),e!==r&&"number"==typeof e?o=e:R(e)&&(n=e),t instanceof Date&&o===r?s(t.getTime(),n):t instanceof Date&&o!==r?(o=e,u(t.getTime(),o,n)):o===r?c(t,n):a(t,o,n)};return v.delay=function(t,e){return R(e)||(e=w),t instanceof Date?f(this,t.getTime(),e):l(this,t,e)},v.debounce=v.throttleWithTimeout=function(t,e){R(e)||(e=w);var n=this;return new m(function(r){var o,i=new E,s=!1,u=0,c=n.subscribe(function(n){s=!0,o=n,u++;var c=u,a=new x;i.setDisposable(a),a.setDisposable(e.scheduleWithRelative(t,function(){s&&u===c&&r.onNext(o),s=!1}))},function(t){i.dispose(),r.onError(t),s=!1,u++},function(){i.dispose(),s&&r.onNext(o),r.onCompleted(),s=!1,u++});return new S(c,i)},this)},v.throttle=function(t,e){return this.debounce(t,e)},v.windowWithTime=function(t,e,n){var r,o=this;return null==e&&(r=t),R(n)||(n=w),"number"==typeof e?r=e:R(e)&&(r=t,n=e),new m(function(e){function i(){var t=new x,o=!1,s=!1;f.setDisposable(t),a===c?(o=!0,s=!0):a<c?o=!0:s=!0;var p=o?a:c,d=p-h;h=p,o&&(a+=r),s&&(c+=r),t.setDisposable(n.scheduleWithRelative(d,function(){if(s){var t=new C;l.push(t),e.onNext(A(t,u))}o&&l.shift().onCompleted(),i()}))}var s,u,c=r,a=t,l=[],f=new E,h=0;return s=new S(f),u=new k(s),l.push(new C),e.onNext(A(l[0],u)),i(),s.add(o.subscribe(function(t){for(var e=0,n=l.length;e<n;e++)l[e].onNext(t)},function(t){for(var n=0,r=l.length;n<r;n++)l[n].onError(t);e.onError(t)},function(){for(var t=0,n=l.length;t<n;t++)l[t].onCompleted();e.onCompleted()})),u},o)},v.windowWithTimeOrCount=function(t,e,n){var r=this;return R(n)||(n=w),new m(function(o){function i(e){var r=new x;s.setDisposable(r),r.setDisposable(n.scheduleWithRelative(t,function(){if(e===l){a=0;var t=++l;f.onCompleted(),f=new C,o.onNext(A(f,c)),i(t)}}))}var s=new E,u=new S(s),c=new k(u),a=0,l=0,f=new C;return o.onNext(A(f,c)),i(0),u.add(r.subscribe(function(t){var n=0,r=!1;f.onNext(t),++a===e&&(r=!0,a=0,n=++l,f.onCompleted(),f=new C,o.onNext(A(f,c))),r&&i(n)},function(t){f.onError(t),o.onError(t)},function(){f.onCompleted(),o.onCompleted()})),c},r)},v.bufferWithTime=function(t,e,n){return this.windowWithTime.apply(this,arguments).selectMany(function(t){return t.toArray()})},v.bufferWithTimeOrCount=function(t,e,n){return this.windowWithTimeOrCount(t,e,n).selectMany(function(t){return t.toArray()})},v.timeInterval=function(t){var e=this;return R(t)||(t=w),y(function(){var n=t.now();return e.map(function(e){var r=t.now(),o=r-n;return n=r,{value:e,interval:o}})})},v.timestamp=function(t){return R(t)||(t=w),this.map(function(e){return{value:e,timestamp:t.now()}})},v.sample=v.throttleLatest=function(t,e){return R(e)||(e=w),"number"==typeof t?h(this,L(t,e)):h(this,t)},v.timeout=function(t,e,n){(null==e||"string"==typeof e)&&(e=g(new Error(e||"Timeout"))),R(n)||(n=w);var r=this,o=t instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative";return new m(function(i){function s(){var r=u;l.setDisposable(n[o](t,function(){u===r&&(T(e)&&(e=D(e)),a.setDisposable(e.subscribe(i)))}))}var u=0,c=new x,a=new E,l=new E;return a.setDisposable(c),s(),c.setDisposable(r.subscribe(function(t){u++,i.onNext(t),s()},function(t){u++,i.onError(t)},function(){u++,i.onCompleted()})),new S(a,l)},r)},d.generateWithAbsoluteTime=function(t,e,n,r,o,i){return R(i)||(i=w),new m(function(s){var u=!0,c=!1;return i.scheduleRecursiveWithAbsoluteAndState(t,i.now(),function(t,i){c&&s.onNext(t);try{if(u?u=!1:t=n(t),c=e(t))var a=r(t),l=o(t)}catch(t){return void s.onError(t)}c?i(a,l):s.onCompleted()})})},d.generateWithRelativeTime=function(t,e,n,r,o,i){return R(i)||(i=w),new m(function(s){var u=!0,c=!1;return i.scheduleRecursiveWithRelativeAndState(t,0,function(t,i){c&&s.onNext(t);try{if(u?u=!1:t=n(t),c=e(t))var a=r(t),l=o(t)}catch(t){return void s.onError(t)}c?i(a,l):s.onCompleted()})})},v.delaySubscription=function(t,e){var n=t instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative",r=this;return R(e)||(e=w),new m(function(o){var i=new E;return i.setDisposable(e[n](t,function(){i.setDisposable(r.subscribe(o))})),i},this)},v.delayWithSelector=function(t,e){var n,r,o=this;return O(t)?r=t:(n=t,r=e),new m(function(t){function e(){a.setDisposable(o.subscribe(function(e){var n=i(r)(e);if(n===j)return t.onError(n.e);var o=new x;u.add(o),o.setDisposable(n.subscribe(function(){t.onNext(e),u.remove(o),s()},function(e){t.onError(e)},function(){t.onNext(e),u.remove(o),s()}))},function(e){t.onError(e)},function(){c=!0,a.dispose(),s()}))}function s(){c&&0===u.length&&t.onCompleted()}var u=new S,c=!1,a=new E;return n?a.setDisposable(n.subscribe(e,function(e){t.onError(e)},e)):e(),new S(a,u)},this)},v.timeoutWithSelector=function(t,e,n){1===arguments.length&&(e=t,t=b()),n||(n=g(new Error("Timeout")));var r=this;return new m(function(o){function i(t){function e(){return l===r}var r=l,i=new x;c.setDisposable(i),i.setDisposable(t.subscribe(function(){e()&&u.setDisposable(n.subscribe(o)),i.dispose()},function(t){e()&&o.onError(t)},function(){e()&&u.setDisposable(n.subscribe(o))}))}function s(){var t=!f;return t&&l++,t}var u=new E,c=new E,a=new x;u.setDisposable(a);var l=0,f=!1;return i(t),a.setDisposable(r.subscribe(function(t){if(s()){o.onNext(t);var n;try{n=e(t)}catch(t){return void o.onError(t)}i(T(n)?D(n):n)}},function(t){s()&&o.onError(t)},function(){s()&&o.onCompleted()})),new S(u,c)},r)},v.debounceWithSelector=function(t){var e=this;return new m(function(n){var r,o=!1,i=new E,s=0,u=e.subscribe(function(e){var u;try{u=t(e)}catch(t){return void n.onError(t)}T(u)&&(u=D(u)),o=!0,r=e,s++;var c=s,a=new x;i.setDisposable(a),a.setDisposable(u.subscribe(function(){o&&s===c&&n.onNext(r),o=!1,a.dispose()},n.onError.bind(n),function(){o&&s===c&&n.onNext(r),o=!1,a.dispose()}))},function(t){i.dispose(),n.onError(t),o=!1,s++},function(){i.dispose(),o&&n.onNext(r),n.onCompleted(),o=!1,s++});return new S(u,i)},e)},v.throttleWithSelector=function(t){return this.debounceWithSelector(t)},v.skipLastWithTime=function(t,e){R(e)||(e=w);var n=this;return new m(function(r){var o=[];return n.subscribe(function(n){var i=e.now();for(o.push({interval:i,value:n});o.length>0&&i-o[0].interval>=t;)r.onNext(o.shift().value)},function(t){r.onError(t)},function(){for(var n=e.now();o.length>0&&n-o[0].interval>=t;)r.onNext(o.shift().value);r.onCompleted()})},n)},v.takeLastWithTime=function(t,e){var n=this;return R(e)||(e=w),new m(function(r){var o=[];return n.subscribe(function(n){var r=e.now();for(o.push({interval:r,value:n});o.length>0&&r-o[0].interval>=t;)o.shift()},function(t){r.onError(t)},function(){for(var n=e.now();o.length>0;){var i=o.shift();n-i.interval<=t&&r.onNext(i.value)}r.onCompleted()})},n)},v.takeLastBufferWithTime=function(t,e){var n=this;return R(e)||(e=w),new m(function(r){var o=[];return n.subscribe(function(n){var r=e.now();for(o.push({interval:r,value:n});o.length>0&&r-o[0].interval>=t;)o.shift()},function(t){r.onError(t)},function(){for(var n=e.now(),i=[];o.length>0;){var s=o.shift();n-s.interval<=t&&i.push(s.value)}r.onNext(i),r.onCompleted()})},n)},v.takeWithTime=function(t,e){var n=this;return R(e)||(e=w),new m(function(r){return new S(e.scheduleWithRelative(t,function(){r.onCompleted()}),n.subscribe(r))},n)},v.skipWithTime=function(t,e){var n=this;return R(e)||(e=w),new m(function(r){var o=!1;return new S(e.scheduleWithRelative(t,function(){o=!0}),n.subscribe(function(t){o&&r.onNext(t)},r.onError.bind(r),r.onCompleted.bind(r)))},n)},v.skipUntilWithTime=function(t,e){R(e)||(e=w);var n=this,r=t instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative";return new m(function(o){var i=!1;return new S(e[r](t,function(){i=!0}),n.subscribe(function(t){i&&o.onNext(t)},function(t){o.onError(t)},function(){o.onCompleted()}))},n)},v.takeUntilWithTime=function(t,e){R(e)||(e=w);var n=this,r=t instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative";return new m(function(o){return new S(e[r](t,function(){o.onCompleted()}),n.subscribe(o))},n)},v.throttleFirst=function(t,e){R(e)||(e=w);var n=+t||0;if(n<=0)throw new RangeError("windowDuration cannot be less or equal zero.");var r=this;return new m(function(t){var o=0;return r.subscribe(function(r){var i=e.now();(0===o||i-o>=n)&&(o=i,t.onNext(r))},function(e){t.onError(e)},function(){t.onCompleted()})},r)},n})}).call(e,n(1)(t))},function(t,e,n){(function(t){var r,o;(function(i){var s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=s[typeof window]&&window||this,c=s[typeof e]&&e&&!e.nodeType&&e,a=s[typeof t]&&t&&!t.nodeType&&t,l=(a&&a.exports,s[typeof global]&&global);!l||l.global!==l&&l.window!==l||(u=l),r=[n(2)],void 0!==(o=function(t,e){return i(u,e,t)}.apply(e,r))&&(t.exports=o)}).call(this,function(t,e,n,r){var o=n.Scheduler,i=n.internals.PriorityQueue,s=n.internals.ScheduledItem,u=n.internals.SchedulePeriodicRecursive,c=n.Disposable.empty,a=n.internals.inherits,l=n.helpers.defaultSubComparer,f=n.helpers.notImplemented;return n.VirtualTimeScheduler=function(t){function e(){return this.toDateTimeOffset(this.clock)}function n(t,e){return this.scheduleAbsoluteWithState(t,this.clock,e)}function r(t,e,n){return this.scheduleRelativeWithState(t,this.toRelative(e),n)}function o(t,e,n){return this.scheduleRelativeWithState(t,this.toRelative(e-this.now()),n)}function l(t,e){return e(),c}function h(s,u){this.clock=s,this.comparer=u,this.isEnabled=!1,this.queue=new i(1024),t.call(this,e,n,r,o)}a(h,t);var p=h.prototype;return p.add=f,p.toDateTimeOffset=f,p.toRelative=f,p.schedulePeriodicWithState=function(t,e,n){return new u(this,t,e,n).start()},p.scheduleRelativeWithState=function(t,e,n){var r=this.add(this.clock,e);return this.scheduleAbsoluteWithState(t,r,n)},p.scheduleRelative=function(t,e){return this.scheduleRelativeWithState(e,t,l)},p.start=function(){if(!this.isEnabled){this.isEnabled=!0;do{var t=this.getNext();null!==t?(this.comparer(t.dueTime,this.clock)>0&&(this.clock=t.dueTime),t.invoke()):this.isEnabled=!1}while(this.isEnabled)}},p.stop=function(){this.isEnabled=!1},p.advanceTo=function(t){var e=this.comparer(this.clock,t);if(this.comparer(this.clock,t)>0)throw new ArgumentOutOfRangeError;if(0!==e&&!this.isEnabled){this.isEnabled=!0;do{var n=this.getNext();null!==n&&this.comparer(n.dueTime,t)<=0?(this.comparer(n.dueTime,this.clock)>0&&(this.clock=n.dueTime),n.invoke()):this.isEnabled=!1}while(this.isEnabled);this.clock=t}},p.advanceBy=function(t){var e=this.add(this.clock,t),n=this.comparer(this.clock,e);if(n>0)throw new ArgumentOutOfRangeError;0!==n&&this.advanceTo(e)},p.sleep=function(t){var e=this.add(this.clock,t);if(this.comparer(this.clock,e)>=0)throw new ArgumentOutOfRangeError;this.clock=e},p.getNext=function(){for(;this.queue.length>0;){var t=this.queue.peek();if(!t.isCancelled())return t;this.queue.dequeue()}return null},p.scheduleAbsolute=function(t,e){return this.scheduleAbsoluteWithState(e,t,l)},p.scheduleAbsoluteWithState=function(t,e,n){function r(t,e){return o.queue.remove(i),n(t,e)}var o=this,i=new s(this,t,r,e,this.comparer);return this.queue.enqueue(i),i.disposable},h}(o),n.HistoricalScheduler=function(t){function e(e,n){var r=null==e?0:e,o=n||l;t.call(this,r,o)}a(e,t);var n=e.prototype;return n.add=function(t,e){return t+e},n.toDateTimeOffset=function(t){return new Date(t).getTime()},n.toRelative=function(t){return t},e}(n.VirtualTimeScheduler),n})}).call(e,n(1)(t))},function(t,e,n){e.RateLimiter=n(115),e.TokenBucket=n(32)},function(t,e,n){var r=n(32),o=function(t,e,n){this.tokenBucket=new r(t,t,e,null),this.tokenBucket.content=t,this.curIntervalStart=+new Date,this.tokensThisInterval=0,this.fireImmediately=n};o.prototype={tokenBucket:null,curIntervalStart:0,tokensThisInterval:0,fireImmediately:!1,removeTokens:function(t,e){function n(n,o){if(n)return e(n,null);r.tokensThisInterval+=t,e(null,o)}if(t>this.tokenBucket.bucketSize)return process.nextTick(e.bind(null,"Requested tokens "+t+" exceeds maximum tokens per interval "+this.tokenBucket.bucketSize,null)),!1;var r=this,o=Date.now();if(o-this.curIntervalStart>=this.tokenBucket.interval&&(this.curIntervalStart=o,this.tokensThisInterval=0),t>this.tokenBucket.tokensPerInterval-this.tokensThisInterval){if(this.fireImmediately)process.nextTick(e.bind(null,null,-1));else{var i=Math.ceil(this.curIntervalStart+this.tokenBucket.interval-o);setTimeout(function(){r.tokenBucket.removeTokens(t,n)},i)}return!1}return this.tokenBucket.removeTokens(t,n)},tryRemoveTokens:function(t){if(t>this.tokenBucket.bucketSize)return!1;var e=Date.now();return e-this.curIntervalStart>=this.tokenBucket.interval&&(this.curIntervalStart=e,this.tokensThisInterval=0),!(t>this.tokenBucket.tokensPerInterval-this.tokensThisInterval)&&this.tokenBucket.tryRemoveTokens(t)},getTokensRemaining:function(){return this.tokenBucket.drip(),this.tokenBucket.content}},t.exports=o},function(t,e,n){var r,o;!function(i,s){var u={Identity:function(t){return t},True:function(){return!0},Blank:function(){}},c={Boolean:typeof!0,Number:"number",String:"string",Object:typeof{},Undefined:"undefined",Function:"function"},a={"":u.Identity},l={createLambda:function(t){if(null==t)return u.Identity;if(typeof t===c.String){var e=a[t];if(null!=e)return e;if(-1===t.indexOf("=>")){for(var n,r=new RegExp("[$]+","g"),o=0;null!=(n=r.exec(t));){var i=n[0].length;i>o&&(o=i)}for(var s=[],l=1;l<=o;l++){for(var f="",h=0;h<l;h++)f+="$";s.push(f)}var p=Array.prototype.join.call(s,",");return e=new Function(p,"return "+t),a[t]=e,e}var d=t.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return e=new Function(d[1],"return "+d[2]),a[t]=e,e}return t},isIEnumerable:function(t){if(typeof Enumerator!==c.Undefined)try{return new Enumerator(t),!0}catch(t){}return!1},defineProperty:null!=Object.defineProperties?function(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:n})}:function(t,e,n){t[e]=n},compare:function(t,e){return t===e?0:t>e?1:-1},dispose:function(t){null!=t&&t.dispose()}},f={Before:0,Running:1,After:2},h=function(t,e,n){var r=new p,o=f.Before;this.current=r.current,this.moveNext=function(){try{switch(o){case f.Before:o=f.Running,t();case f.Running:return!!e.apply(r)||(this.dispose(),!1);case f.After:return!1}}catch(t){throw this.dispose(),t}},this.dispose=function(){if(o==f.Running)try{n()}finally{o=f.After}}},p=function(){var t=null;this.current=function(){return t},this.yieldReturn=function(e){return t=e,!0},this.yieldBreak=function(){return!1}},d=function(t){this.getEnumerator=t};d.Utils={},d.Utils.createLambda=function(t){return l.createLambda(t)},d.Utils.createEnumerable=function(t){return new d(t)},d.Utils.createEnumerator=function(t,e,n){return new h(t,e,n)},d.Utils.extendTo=function(t){var e,n=t.prototype;t===Array?(e=b.prototype,l.defineProperty(n,"getSource",function(){return this})):(e=d.prototype,l.defineProperty(n,"getEnumerator",function(){return d.from(this).getEnumerator()}));for(var r in e){var o=e[r];n[r]!=o&&(null!=n[r]&&(r+="ByLinq",n[r]==o)||o instanceof Function&&l.defineProperty(n,r,o))}},d.choice=function(){var t=arguments;return new d(function(){return new h(function(){t=t[0]instanceof Array?t[0]:null!=t[0].getEnumerator?t[0].toArray():t},function(){return this.yieldReturn(t[Math.floor(Math.random()*t.length)])},u.Blank)})},d.cycle=function(){var t=arguments;return new d(function(){var e=0;return new h(function(){t=t[0]instanceof Array?t[0]:null!=t[0].getEnumerator?t[0].toArray():t},function(){return e>=t.length&&(e=0),this.yieldReturn(t[e++])},u.Blank)})},d.empty=function(){return new d(function(){return new h(u.Blank,function(){return!1},u.Blank)})},d.from=function(t){if(null==t)return d.empty();if(t instanceof d)return t;if(typeof t==c.Number||typeof t==c.Boolean)return d.repeat(t,1);if(typeof t==c.String)return new d(function(){var e=0;return new h(u.Blank,function(){return e<t.length&&this.yieldReturn(t.charAt(e++))},u.Blank)});if(typeof t!=c.Function){if(typeof t.length==c.Number)return new b(t);if(!(t instanceof Object)&&l.isIEnumerable(t))return new d(function(){var e,n=!0;return new h(function(){e=new Enumerator(t)},function(){return n?n=!1:e.moveNext(),!e.atEnd()&&this.yieldReturn(e.item())},u.Blank)});if(typeof Windows===c.Object&&typeof t.first===c.Function)return new d(function(){var e,n=!0;return new h(function(){e=t.first()},function(){return n?n=!1:e.moveNext(),e.hasCurrent?this.yieldReturn(e.current):this.yieldBreak()},u.Blank)})}return new d(function(){var e=[],n=0;return new h(function(){for(var n in t){var r=t[n];r instanceof Function||!Object.prototype.hasOwnProperty.call(t,n)||e.push({key:n,value:r})}},function(){return n<e.length&&this.yieldReturn(e[n++])},u.Blank)})},d.make=function(t){return d.repeat(t,1)},d.matches=function(t,e,n){return null==n&&(n=""),e instanceof RegExp&&(n+=e.ignoreCase?"i":"",n+=e.multiline?"m":"",e=e.source),-1===n.indexOf("g")&&(n+="g"),new d(function(){var r;return new h(function(){r=new RegExp(e,n)},function(){var e=r.exec(t);return!!e&&this.yieldReturn(e)},u.Blank)})},d.range=function(t,e,n){return null==n&&(n=1),new d(function(){var r,o=0;return new h(function(){r=t-n},function(){return o++<e?this.yieldReturn(r+=n):this.yieldBreak()},u.Blank)})},d.rangeDown=function(t,e,n){return null==n&&(n=1),new d(function(){var r,o=0;return new h(function(){r=t+n},function(){return o++<e?this.yieldReturn(r-=n):this.yieldBreak()},u.Blank)})},d.rangeTo=function(t,e,n){return null==n&&(n=1),new d(t<e?function(){var r;return new h(function(){r=t-n},function(){var t=r+=n;return t<=e?this.yieldReturn(t):this.yieldBreak()},u.Blank)}:function(){var r;return new h(function(){r=t+n},function(){var t=r-=n;return t>=e?this.yieldReturn(t):this.yieldBreak()},u.Blank)})},d.repeat=function(t,e){return null!=e?d.repeat(t).take(e):new d(function(){return new h(u.Blank,function(){return this.yieldReturn(t)},u.Blank)})},d.repeatWithFinalize=function(t,e){return t=l.createLambda(t),e=l.createLambda(e),new d(function(){var n;return new h(function(){n=t()},function(){return this.yieldReturn(n)},function(){null!=n&&(e(n),n=null)})})},d.generate=function(t,e){return null!=e?d.generate(t).take(e):(t=l.createLambda(t),new d(function(){return new h(u.Blank,function(){return this.yieldReturn(t())},u.Blank)}))},d.toInfinity=function(t,e){return null==t&&(t=0),null==e&&(e=1),new d(function(){var n;return new h(function(){n=t-e},function(){return this.yieldReturn(n+=e)},u.Blank)})},d.toNegativeInfinity=function(t,e){return null==t&&(t=0),null==e&&(e=1),new d(function(){var n;return new h(function(){n=t+e},function(){return this.yieldReturn(n-=e)},u.Blank)})},d.unfold=function(t,e){return e=l.createLambda(e),new d(function(){var n,r=!0;return new h(u.Blank,function(){return r?(r=!1,n=t,this.yieldReturn(n)):(n=e(n),this.yieldReturn(n))},u.Blank)})},d.defer=function(t){return new d(function(){var e;return new h(function(){e=d.from(t()).getEnumerator()},function(){return e.moveNext()?this.yieldReturn(e.current()):this.yieldBreak()},function(){l.dispose(e)})})},d.prototype.traverseBreadthFirst=function(t,e){var n=this;return t=l.createLambda(t),e=l.createLambda(e),new d(function(){var r,o=0,i=[];return new h(function(){r=n.getEnumerator()},function(){for(;;){if(r.moveNext())return i.push(r.current()),this.yieldReturn(e(r.current(),o));var n=d.from(i).selectMany(function(e){return t(e)});if(!n.any())return!1;o++,i=[],l.dispose(r),r=n.getEnumerator()}},function(){l.dispose(r)})})},d.prototype.traverseDepthFirst=function(t,e){var n=this;return t=l.createLambda(t),e=l.createLambda(e),new d(function(){var r,o=[];return new h(function(){r=n.getEnumerator()},function(){for(;;){if(r.moveNext()){var n=e(r.current(),o.length);return o.push(r),r=d.from(t(r.current())).getEnumerator(),this.yieldReturn(n)}if(o.length<=0)return!1;l.dispose(r),r=o.pop()}},function(){try{l.dispose(r)}finally{d.from(o).forEach(function(t){t.dispose()})}})})},d.prototype.flatten=function(){var t=this;return new d(function(){var e,n=null;return new h(function(){e=t.getEnumerator()},function(){for(;;){if(null!=n){if(n.moveNext())return this.yieldReturn(n.current());n=null}if(e.moveNext()){if(e.current()instanceof Array){l.dispose(n),n=d.from(e.current()).selectMany(u.Identity).flatten().getEnumerator();continue}return this.yieldReturn(e.current())}return!1}},function(){try{l.dispose(e)}finally{l.dispose(n)}})})},d.prototype.pairwise=function(t){var e=this;return t=l.createLambda(t),new d(function(){var n;return new h(function(){n=e.getEnumerator(),n.moveNext()},function(){var e=n.current();return!!n.moveNext()&&this.yieldReturn(t(e,n.current()))},function(){l.dispose(n)})})},d.prototype.scan=function(t,e){var n;null==e?(e=l.createLambda(t),n=!1):(e=l.createLambda(e),n=!0);var r=this;return new d(function(){var o,i,s=!0;return new h(function(){o=r.getEnumerator()},function(){if(s){if(s=!1,n)return this.yieldReturn(i=t);if(o.moveNext())return this.yieldReturn(i=o.current())}return!!o.moveNext()&&this.yieldReturn(i=e(i,o.current()))},function(){l.dispose(o)})})},d.prototype.select=function(t){if(t=l.createLambda(t),t.length<=1)return new w(this,null,t);var e=this;return new d(function(){var n,r=0;return new h(function(){n=e.getEnumerator()},function(){return!!n.moveNext()&&this.yieldReturn(t(n.current(),r++))},function(){l.dispose(n)})})},d.prototype.selectMany=function(t,e){var n=this;return t=l.createLambda(t),null==e&&(e=function(t,e){return e}),e=l.createLambda(e),new d(function(){var r,o=void 0,i=0;return new h(function(){r=n.getEnumerator()},function(){if(void 0===o&&!r.moveNext())return!1;do{if(null==o){var n=t(r.current(),i++);o=d.from(n).getEnumerator()}if(o.moveNext())return this.yieldReturn(e(r.current(),o.current()));l.dispose(o),o=null}while(r.moveNext());return!1},function(){try{l.dispose(r)}finally{l.dispose(o)}})})},d.prototype.where=function(t){if(t=l.createLambda(t),t.length<=1)return new g(this,t);var e=this;return new d(function(){var n,r=0;return new h(function(){n=e.getEnumerator()},function(){for(;n.moveNext();)if(t(n.current(),r++))return this.yieldReturn(n.current());return!1},function(){l.dispose(n)})})},d.prototype.choose=function(t){t=l.createLambda(t);var e=this;return new d(function(){var n,r=0;return new h(function(){n=e.getEnumerator()},function(){for(;n.moveNext();){var e=t(n.current(),r++);if(null!=e)return this.yieldReturn(e)}return this.yieldBreak()},function(){l.dispose(n)})})},d.prototype.ofType=function(t){var e;switch(t){case Number:e=c.Number;break;case String:e=c.String;break;case Boolean:e=c.Boolean;break;case Function:e=c.Function;break;default:e=null}return null===e?this.where(function(e){return e instanceof t}):this.where(function(t){return typeof t===e})},d.prototype.zip=function(){var t=arguments,e=l.createLambda(arguments[arguments.length-1]),n=this;if(2==arguments.length){var r=arguments[0];return new d(function(){var t,o,i=0;return new h(function(){t=n.getEnumerator(),o=d.from(r).getEnumerator()},function(){return!(!t.moveNext()||!o.moveNext())&&this.yieldReturn(e(t.current(),o.current(),i++))},function(){try{l.dispose(t)}finally{l.dispose(o)}})})}return new d(function(){var r,o=0;return new h(function(){var e=d.make(n).concat(d.from(t).takeExceptLast().select(d.from)).select(function(t){return t.getEnumerator()}).toArray();r=d.from(e)},function(){if(r.all(function(t){return t.moveNext()})){var t=r.select(function(t){return t.current()}).toArray();return t.push(o++),this.yieldReturn(e.apply(null,t))}return this.yieldBreak()},function(){d.from(r).forEach(l.dispose)})})},d.prototype.merge=function(){var t=arguments,e=this;return new d(function(){var n,r=-1;return new h(function(){n=d.make(e).concat(d.from(t).select(d.from)).select(function(t){return t.getEnumerator()}).toArray()},function(){for(;n.length>0;){r=r>=n.length-1?0:r+1;var t=n[r];if(t.moveNext())return this.yieldReturn(t.current());t.dispose(),n.splice(r--,1)}return this.yieldBreak()},function(){d.from(n).forEach(l.dispose)})})},d.prototype.join=function(t,e,n,r,o){e=l.createLambda(e),n=l.createLambda(n),r=l.createLambda(r),o=l.createLambda(o);var i=this;return new d(function(){var s,c,a=null,f=0;return new h(function(){s=i.getEnumerator(),c=d.from(t).toLookup(n,u.Identity,o)},function(){for(;;){if(null!=a){var t=a[f++];if(void 0!==t)return this.yieldReturn(r(s.current(),t));t=null,f=0}if(!s.moveNext())return!1;var n=e(s.current());a=c.get(n).toArray()}},function(){l.dispose(s)})})},d.prototype.groupJoin=function(t,e,n,r,o){e=l.createLambda(e),n=l.createLambda(n),r=l.createLambda(r),o=l.createLambda(o);var i=this;return new d(function(){var s=i.getEnumerator(),c=null;return new h(function(){s=i.getEnumerator(),c=d.from(t).toLookup(n,u.Identity,o)},function(){if(s.moveNext()){var t=c.get(e(s.current()));return this.yieldReturn(r(s.current(),t))}return!1},function(){l.dispose(s)})})},d.prototype.all=function(t){t=l.createLambda(t);var e=!0;return this.forEach(function(n){if(!t(n))return e=!1,!1}),e},d.prototype.any=function(t){t=l.createLambda(t);var e=this.getEnumerator();try{if(0==arguments.length)return e.moveNext();for(;e.moveNext();)if(t(e.current()))return!0;return!1}finally{l.dispose(e)}},d.prototype.isEmpty=function(){return!this.any()},d.prototype.concat=function(){var t=this;if(1==arguments.length){var e=arguments[0];return new d(function(){var n,r;return new h(function(){n=t.getEnumerator()},function(){if(null==r){if(n.moveNext())return this.yieldReturn(n.current());r=d.from(e).getEnumerator()}return!!r.moveNext()&&this.yieldReturn(r.current())},function(){try{l.dispose(n)}finally{l.dispose(r)}})})}var n=arguments;return new d(function(){var e;return new h(function(){e=d.make(t).concat(d.from(n).select(d.from)).select(function(t){return t.getEnumerator()}).toArray()},function(){for(;e.length>0;){var t=e[0];if(t.moveNext())return this.yieldReturn(t.current());t.dispose(),e.splice(0,1)}return this.yieldBreak()},function(){d.from(e).forEach(l.dispose)})})},d.prototype.insert=function(t,e){var n=this;return new d(function(){var r,o,i=0,s=!1;return new h(function(){r=n.getEnumerator(),o=d.from(e).getEnumerator()},function(){return i==t&&o.moveNext()?(s=!0,this.yieldReturn(o.current())):r.moveNext()?(i++,this.yieldReturn(r.current())):!(s||!o.moveNext())&&this.yieldReturn(o.current())},function(){try{l.dispose(r)}finally{l.dispose(o)}})})},d.prototype.alternate=function(t){var e=this;return new d(function(){var n,r,o,i;return new h(function(){o=t instanceof Array||null!=t.getEnumerator?d.from(d.from(t).toArray()):d.make(t),r=e.getEnumerator(),r.moveNext()&&(n=r.current())},function(){for(;;){if(null!=i){if(i.moveNext())return this.yieldReturn(i.current());i=null}{if(null!=n||!r.moveNext()){if(null!=n){var t=n;return n=null,this.yieldReturn(t)}return this.yieldBreak()}n=r.current(),i=o.getEnumerator()}}},function(){try{l.dispose(r)}finally{l.dispose(i)}})})},d.prototype.contains=function(t,e){e=l.createLambda(e);var n=this.getEnumerator();try{for(;n.moveNext();)if(e(n.current())===t)return!0;return!1}finally{l.dispose(n)}},d.prototype.defaultIfEmpty=function(t){var e=this;return void 0===t&&(t=null),new d(function(){var n,r=!0;return new h(function(){n=e.getEnumerator()},function(){return n.moveNext()?(r=!1,this.yieldReturn(n.current())):!!r&&(r=!1,this.yieldReturn(t))},function(){l.dispose(n)})})},d.prototype.distinct=function(t){return this.except(d.empty(),t)},d.prototype.distinctUntilChanged=function(t){t=l.createLambda(t);var e=this;return new d(function(){var n,r,o;return new h(function(){n=e.getEnumerator()},function(){for(;n.moveNext();){var e=t(n.current());if(o)return o=!1,r=e,this.yieldReturn(n.current());if(r!==e)return r=e,this.yieldReturn(n.current())}return this.yieldBreak()},function(){l.dispose(n)})})},d.prototype.except=function(t,e){e=l.createLambda(e);var n=this;return new d(function(){var r,o;return new h(function(){r=n.getEnumerator(),o=new x(e),d.from(t).forEach(function(t){o.add(t)})},function(){for(;r.moveNext();){var t=r.current();if(!o.contains(t))return o.add(t),this.yieldReturn(t)}return!1},function(){l.dispose(r)})})},d.prototype.intersect=function(t,e){e=l.createLambda(e);var n=this;return new d(function(){var r,o,i;return new h(function(){r=n.getEnumerator(),o=new x(e),d.from(t).forEach(function(t){o.add(t)}),i=new x(e)},function(){for(;r.moveNext();){var t=r.current();if(!i.contains(t)&&o.contains(t))return i.add(t),this.yieldReturn(t)}return!1},function(){l.dispose(r)})})},d.prototype.sequenceEqual=function(t,e){e=l.createLambda(e);var n=this.getEnumerator();try{var r=d.from(t).getEnumerator();try{for(;n.moveNext();)if(!r.moveNext()||e(n.current())!==e(r.current()))return!1;return!r.moveNext()}finally{l.dispose(r)}}finally{l.dispose(n)}},d.prototype.union=function(t,e){e=l.createLambda(e);var n=this;return new d(function(){var r,o,i;return new h(function(){r=n.getEnumerator(),i=new x(e)},function(){var e;if(void 0===o){for(;r.moveNext();)if(e=r.current(),!i.contains(e))return i.add(e),this.yieldReturn(e);o=d.from(t).getEnumerator()}for(;o.moveNext();)if(e=o.current(),!i.contains(e))return i.add(e),this.yieldReturn(e);return!1},function(){try{l.dispose(r)}finally{l.dispose(o)}})})},d.prototype.orderBy=function(t){return new v(this,t,!1)},d.prototype.orderByDescending=function(t){return new v(this,t,!0)},d.prototype.reverse=function(){var t=this;return new d(function(){var e,n;return new h(function(){e=t.toArray(),n=e.length},function(){return n>0&&this.yieldReturn(e[--n])},u.Blank)})},d.prototype.shuffle=function(){var t=this;return new d(function(){var e;return new h(function(){e=t.toArray()},function(){if(e.length>0){var t=Math.floor(Math.random()*e.length);return this.yieldReturn(e.splice(t,1)[0])}return!1},u.Blank)})},d.prototype.weightedSample=function(t){t=l.createLambda(t);var e=this;return new d(function(){var n,r=0;return new h(function(){n=e.choose(function(e){var n=t(e);return n<=0?null:(r+=n,{value:e,bound:r})}).toArray()},function(){if(n.length>0){for(var t=Math.floor(Math.random()*r)+1,e=-1,o=n.length;o-e>1;){var i=Math.floor((e+o)/2);n[i].bound>=t?o=i:e=i}return this.yieldReturn(n[o].value)}return this.yieldBreak()},u.Blank)})},d.prototype.groupBy=function(t,e,n,r){var o=this;return t=l.createLambda(t),e=l.createLambda(e),null!=n&&(n=l.createLambda(n)),r=l.createLambda(r),new d(function(){var i;return new h(function(){i=o.toLookup(t,e,r).toEnumerable().getEnumerator()},function(){for(;i.moveNext();)return null==n?this.yieldReturn(i.current()):this.yieldReturn(n(i.current().key(),i.current()));return!1},function(){l.dispose(i)})})},d.prototype.partitionBy=function(t,e,n,r){var o=this;t=l.createLambda(t),e=l.createLambda(e),r=l.createLambda(r);var i;return null==n?(i=!1,n=function(t,e){return new S(t,e)}):(i=!0,n=l.createLambda(n)),new d(function(){var s,u,c,a=[];return new h(function(){s=o.getEnumerator(),s.moveNext()&&(u=t(s.current()),c=r(u),a.push(e(s.current())))},function(){for(var o;1==(o=s.moveNext())&&c===r(t(s.current()));)a.push(e(s.current()));if(a.length>0){var l=i?n(u,d.from(a)):n(u,a);return o?(u=t(s.current()),c=r(u),a=[e(s.current())]):a=[],this.yieldReturn(l)}return!1},function(){l.dispose(s)})})},d.prototype.buffer=function(t){var e=this;return new d(function(){var n;return new h(function(){n=e.getEnumerator()},function(){for(var e=[],r=0;n.moveNext();)if(e.push(n.current()),++r>=t)return this.yieldReturn(e);return e.length>0&&this.yieldReturn(e)},function(){l.dispose(n)})})},d.prototype.aggregate=function(t,e,n){return(n=l.createLambda(n))(this.scan(t,e,n).last())},d.prototype.average=function(t){t=l.createLambda(t);var e=0,n=0;return this.forEach(function(r){e+=t(r),++n}),e/n},d.prototype.count=function(t){t=null==t?u.True:l.createLambda(t);var e=0;return this.forEach(function(n,r){t(n,r)&&++e}),e},d.prototype.max=function(t){return null==t&&(t=u.Identity),this.select(t).aggregate(function(t,e){return t>e?t:e})},d.prototype.min=function(t){return null==t&&(t=u.Identity),this.select(t).aggregate(function(t,e){return t<e?t:e})},d.prototype.maxBy=function(t){return t=l.createLambda(t),this.aggregate(function(e,n){return t(e)>t(n)?e:n})},d.prototype.minBy=function(t){return t=l.createLambda(t),this.aggregate(function(e,n){return t(e)<t(n)?e:n})},d.prototype.sum=function(t){return null==t&&(t=u.Identity),this.select(t).aggregate(0,function(t,e){return t+e})},d.prototype.elementAt=function(t){var e,n=!1;if(this.forEach(function(r,o){if(o==t)return e=r,n=!0,!1}),!n)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return e},d.prototype.elementAtOrDefault=function(t,e){void 0===e&&(e=null);var n,r=!1;return this.forEach(function(e,o){if(o==t)return n=e,r=!0,!1}),r?n:e},d.prototype.first=function(t){if(null!=t)return this.where(t).first();var e,n=!1;if(this.forEach(function(t){return e=t,n=!0,!1}),!n)throw new Error("first:No element satisfies the condition.");return e},d.prototype.firstOrDefault=function(t,e){if(t){if(typeof t===c.Function||typeof l.createLambda(t)===c.Function)return this.where(t).firstOrDefault(null,e);e=t}e=e||null;var n,r=!1;return this.forEach(function(t){return n=t,r=!0,!1}),r?n:e},d.prototype.last=function(t){if(null!=t)return this.where(t).last();var e,n=!1;if(this.forEach(function(t){n=!0,e=t}),!n)throw new Error("last:No element satisfies the condition.");return e},d.prototype.lastOrDefault=function(t,e){if(t){if(typeof t===c.Function||typeof l.createLambda(t)===c.Function)return this.where(t).lastOrDefault(null,e);e=t}e=e||null;var n,r=!1;return this.forEach(function(t){r=!0,n=t}),r?n:e},d.prototype.single=function(t){if(null!=t)return this.where(t).single();var e,n=!1;if(this.forEach(function(t){if(n)throw new Error("single:sequence contains more than one element.");n=!0,e=t}),!n)throw new Error("single:No element satisfies the condition.");return e},d.prototype.singleOrDefault=function(t,e){if(void 0===e&&(e=null),null!=t)return this.where(t).singleOrDefault(null,e);var n,r=!1;return this.forEach(function(t){if(r)throw new Error("single:sequence contains more than one element.");r=!0,n=t}),r?n:e},d.prototype.skip=function(t){var e=this;return new d(function(){var n,r=0;return new h(function(){for(n=e.getEnumerator();r++<t&&n.moveNext(););},function(){return!!n.moveNext()&&this.yieldReturn(n.current())},function(){l.dispose(n)})})},d.prototype.skipWhile=function(t){t=l.createLambda(t);var e=this;return new d(function(){var n,r=0,o=!1;return new h(function(){n=e.getEnumerator()},function(){for(;!o;){if(!n.moveNext())return!1;if(!t(n.current(),r++))return o=!0,this.yieldReturn(n.current())}return!!n.moveNext()&&this.yieldReturn(n.current())},function(){l.dispose(n)})})},d.prototype.take=function(t){var e=this;return new d(function(){var n,r=0;return new h(function(){n=e.getEnumerator()},function(){return!!(r++<t&&n.moveNext())&&this.yieldReturn(n.current())},function(){l.dispose(n)})})},d.prototype.takeWhile=function(t){t=l.createLambda(t);var e=this;return new d(function(){var n,r=0;return new h(function(){n=e.getEnumerator()},function(){return!(!n.moveNext()||!t(n.current(),r++))&&this.yieldReturn(n.current())},function(){l.dispose(n)})})},d.prototype.takeExceptLast=function(t){null==t&&(t=1);var e=this;return new d(function(){if(t<=0)return e.getEnumerator();var n,r=[];return new h(function(){n=e.getEnumerator()},function(){for(;n.moveNext();){if(r.length==t)return r.push(n.current()),this.yieldReturn(r.shift());r.push(n.current())}return!1},function(){l.dispose(n)})})},d.prototype.takeFromLast=function(t){if(t<=0||null==t)return d.empty();var e=this;return new d(function(){var n,r,o=[];return new h(function(){n=e.getEnumerator()},function(){for(;n.moveNext();)o.length==t&&o.shift(),o.push(n.current());return null==r&&(r=d.from(o).getEnumerator()),!!r.moveNext()&&this.yieldReturn(r.current())},function(){l.dispose(r)})})},d.prototype.indexOf=function(t){var e=null;return typeof t===c.Function?this.forEach(function(n,r){if(t(n,r))return e=r,!1}):this.forEach(function(n,r){if(n===t)return e=r,!1}),null!==e?e:-1},d.prototype.lastIndexOf=function(t){var e=-1;return typeof t===c.Function?this.forEach(function(n,r){t(n,r)&&(e=r)}):this.forEach(function(n,r){n===t&&(e=r)}),e},d.prototype.cast=function(){return this},d.prototype.asEnumerable=function(){return d.from(this)},d.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},d.prototype.toLookup=function(t,e,n){t=l.createLambda(t),e=l.createLambda(e),n=l.createLambda(n);var r=new x(n);return this.forEach(function(n){var o=t(n),i=e(n),s=r.get(o);void 0!==s?s.push(i):r.add(o,[i])}),new E(r)},d.prototype.toObject=function(t,e){t=l.createLambda(t),e=l.createLambda(e);var n={};return this.forEach(function(r){n[t(r)]=e(r)}),n},d.prototype.toDictionary=function(t,e,n){t=l.createLambda(t),e=l.createLambda(e),n=l.createLambda(n);var r=new x(n);return this.forEach(function(n){r.add(t(n),e(n))}),r},d.prototype.toJSONString=function(t,e){if(typeof JSON===c.Undefined||null==JSON.stringify)throw new Error("toJSONString can't find JSON.stringify. This works native JSON support Browser or include json2.js");return JSON.stringify(this.toArray(),t,e)},d.prototype.toJoinedString=function(t,e){return null==t&&(t=""),null==e&&(e=u.Identity),this.select(e).toArray().join(t)},d.prototype.doAction=function(t){var e=this;return t=l.createLambda(t),new d(function(){var n,r=0;return new h(function(){n=e.getEnumerator()},function(){return!!n.moveNext()&&(t(n.current(),r++),this.yieldReturn(n.current()))},function(){l.dispose(n)})})},d.prototype.forEach=function(t){t=l.createLambda(t);var e=0,n=this.getEnumerator();try{for(;n.moveNext()&&!1!==t(n.current(),e++););}finally{l.dispose(n)}},d.prototype.write=function(t,e){null==t&&(t=""),e=l.createLambda(e);var n=!0;this.forEach(function(r){n?n=!1:document.write(t),document.write(e(r))})},d.prototype.writeLine=function(t){t=l.createLambda(t),this.forEach(function(e){document.writeln(t(e)+"<br />")})},d.prototype.force=function(){var t=this.getEnumerator();try{for(;t.moveNext(););}finally{l.dispose(t)}},d.prototype.letBind=function(t){t=l.createLambda(t);var e=this;return new d(function(){var n;return new h(function(){n=d.from(t(e)).getEnumerator()},function(){return!!n.moveNext()&&this.yieldReturn(n.current())},function(){l.dispose(n)})})},d.prototype.share=function(){var t,e=this,n=!1;return new y(function(){return new h(function(){null==t&&(t=e.getEnumerator())},function(){if(n)throw new Error("enumerator is disposed");return!!t.moveNext()&&this.yieldReturn(t.current())},u.Blank)},function(){n=!0,l.dispose(t)})},d.prototype.memoize=function(){var t,e,n=this,r=!1;return new y(function(){var o=-1;return new h(function(){null==e&&(e=n.getEnumerator(),t=[])},function(){if(r)throw new Error("enumerator is disposed");return o++,t.length<=o?!!e.moveNext()&&this.yieldReturn(t[o]=e.current()):this.yieldReturn(t[o])},u.Blank)},function(){r=!0,l.dispose(e),t=null})},d.prototype.catchError=function(t){t=l.createLambda(t);var e=this;return new d(function(){var n;return new h(function(){n=e.getEnumerator()},function(){try{return!!n.moveNext()&&this.yieldReturn(n.current())}catch(e){return t(e),!1}},function(){l.dispose(n)})})},d.prototype.finallyAction=function(t){t=l.createLambda(t);var e=this;return new d(function(){var n;return new h(function(){n=e.getEnumerator()},function(){return!!n.moveNext()&&this.yieldReturn(n.current())},function(){try{l.dispose(n)}finally{t()}})})},d.prototype.log=function(t){return t=l.createLambda(t),this.doAction(function(e){typeof console!==c.Undefined&&console.log(t(e))})},d.prototype.trace=function(t,e){return null==t&&(t="Trace"),e=l.createLambda(e),this.doAction(function(n){typeof console!==c.Undefined&&console.log(t,e(n))})};var v=function(t,e,n,r){this.source=t,this.keySelector=l.createLambda(e),this.descending=n,this.parent=r};v.prototype=new d,v.prototype.createOrderedEnumerable=function(t,e){return new v(this.source,t,e,this)},v.prototype.thenBy=function(t){return this.createOrderedEnumerable(t,!1)},v.prototype.thenByDescending=function(t){return this.createOrderedEnumerable(t,!0)},v.prototype.getEnumerator=function(){var t,e,n=this,r=0;return new h(function(){t=[],e=[],n.source.forEach(function(n,r){t.push(n),e.push(r)});var r=m.create(n,null);r.GenerateKeys(t),e.sort(function(t,e){return r.compare(t,e)})},function(){return r<e.length&&this.yieldReturn(t[e[r++]])},u.Blank)};var m=function(t,e,n){this.keySelector=t,this.descending=e,this.child=n,this.keys=null};m.create=function(t,e){var n=new m(t.keySelector,t.descending,e);return null!=t.parent?m.create(t.parent,n):n},m.prototype.GenerateKeys=function(t){for(var e=t.length,n=this.keySelector,r=new Array(e),o=0;o<e;o++)r[o]=n(t[o]);this.keys=r,null!=this.child&&this.child.GenerateKeys(t)},m.prototype.compare=function(t,e){var n=l.compare(this.keys[t],this.keys[e]);return 0==n?null!=this.child?this.child.compare(t,e):l.compare(t,e):this.descending?-n:n};var y=function(t,e){this.dispose=e,d.call(this,t)};y.prototype=new d;var b=function(t){this.getSource=function(){return t}};b.prototype=new d,b.prototype.any=function(t){return null==t?this.getSource().length>0:d.prototype.any.apply(this,arguments)},b.prototype.count=function(t){return null==t?this.getSource().length:d.prototype.count.apply(this,arguments)},b.prototype.elementAt=function(t){var e=this.getSource();return 0<=t&&t<e.length?e[t]:d.prototype.elementAt.apply(this,arguments)},b.prototype.elementAtOrDefault=function(t,e){void 0===e&&(e=null);var n=this.getSource();return 0<=t&&t<n.length?n[t]:e},b.prototype.first=function(t){var e=this.getSource();return null==t&&e.length>0?e[0]:d.prototype.first.apply(this,arguments)},b.prototype.firstOrDefault=function(t,e){if(void 0===e&&(e=null),null!=t)return d.prototype.firstOrDefault.apply(this,arguments);var n=this.getSource();return n.length>0?n[0]:e},b.prototype.last=function(t){var e=this.getSource();return null==t&&e.length>0?e[e.length-1]:d.prototype.last.apply(this,arguments)},b.prototype.lastOrDefault=function(t,e){if(void 0===e&&(e=null),null!=t)return d.prototype.lastOrDefault.apply(this,arguments);var n=this.getSource();return n.length>0?n[n.length-1]:e},b.prototype.skip=function(t){var e=this.getSource();return new d(function(){var n;return new h(function(){n=t<0?0:t},function(){return n<e.length&&this.yieldReturn(e[n++])},u.Blank)})},b.prototype.takeExceptLast=function(t){return null==t&&(t=1),this.take(this.getSource().length-t)},b.prototype.takeFromLast=function(t){return this.skip(this.getSource().length-t)},b.prototype.reverse=function(){var t=this.getSource();return new d(function(){var e;return new h(function(){e=t.length},function(){return e>0&&this.yieldReturn(t[--e])},u.Blank)})},b.prototype.sequenceEqual=function(t,e){return(!(t instanceof b||t instanceof Array)||null!=e||d.from(t).count()==this.count())&&d.prototype.sequenceEqual.apply(this,arguments)},b.prototype.toJoinedString=function(t,e){var n=this.getSource();return null==e&&n instanceof Array?(null==t&&(t=""),n.join(t)):d.prototype.toJoinedString.apply(this,arguments)},b.prototype.getEnumerator=function(){var t=this.getSource(),e=-1;return{current:function(){return t[e]},moveNext:function(){return++e<t.length},dispose:u.Blank}};var g=function(t,e){this.prevSource=t,this.prevPredicate=e};g.prototype=new d,g.prototype.where=function(t){if(t=l.createLambda(t),t.length<=1){var e=this.prevPredicate,n=function(n){return e(n)&&t(n)};return new g(this.prevSource,n)}return d.prototype.where.call(this,t)},g.prototype.select=function(t){return t=l.createLambda(t),t.length<=1?new w(this.prevSource,this.prevPredicate,t):d.prototype.select.call(this,t)},g.prototype.getEnumerator=function(){var t,e=this.prevPredicate,n=this.prevSource;return new h(function(){t=n.getEnumerator()},function(){for(;t.moveNext();)if(e(t.current()))return this.yieldReturn(t.current());return!1},function(){l.dispose(t)})};var w=function(t,e,n){this.prevSource=t,this.prevPredicate=e,this.prevSelector=n};w.prototype=new d,w.prototype.where=function(t){return t=l.createLambda(t),t.length<=1?new g(this,t):d.prototype.where.call(this,t)},w.prototype.select=function(t){if(t=l.createLambda(t),t.length<=1){var e=this.prevSelector,n=function(n){return t(e(n))};return new w(this.prevSource,this.prevPredicate,n)}return d.prototype.select.call(this,t)},w.prototype.getEnumerator=function(){var t,e=this.prevPredicate,n=this.prevSelector,r=this.prevSource;return new h(function(){t=r.getEnumerator()},function(){for(;t.moveNext();)if(null==e||e(t.current()))return this.yieldReturn(n(t.current()));return!1},function(){l.dispose(t)})};var x=function(){var t=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e=function(t){return null===t?"null":void 0===t?"undefined":typeof t.toString===c.Function?t.toString():Object.prototype.toString.call(t)},n=function(t,e){this.key=t,this.value=e,this.prev=null,this.next=null},r=function(){this.first=null,this.last=null};r.prototype={addLast:function(t){null!=this.last?(this.last.next=t,t.prev=this.last,this.last=t):this.first=this.last=t},replace:function(t,e){null!=t.prev?(t.prev.next=e,e.prev=t.prev):this.first=e,null!=t.next?(t.next.prev=e,e.next=t.next):this.last=e},remove:function(t){null!=t.prev?t.prev.next=t.next:this.first=t.next,null!=t.next?t.next.prev=t.prev:this.last=t.prev}};var o=function(t){this.countField=0,this.entryList=new r,this.buckets={},this.compareSelector=null==t?u.Identity:t};return o.prototype={add:function(r,o){var i=this.compareSelector(r),s=e(i),u=new n(r,o);if(t(this.buckets,s)){for(var c=this.buckets[s],a=0;a<c.length;a++)if(this.compareSelector(c[a].key)===i)return this.entryList.replace(c[a],u),void(c[a]=u);c.push(u)}else this.buckets[s]=[u];this.countField++,this.entryList.addLast(u)},get:function(n){var r=this.compareSelector(n),o=e(r);if(t(this.buckets,o))for(var i=this.buckets[o],s=0;s<i.length;s++){var u=i[s];if(this.compareSelector(u.key)===r)return u.value}},set:function(r,o){var i=this.compareSelector(r),s=e(i);if(t(this.buckets,s))for(var u=this.buckets[s],c=0;c<u.length;c++)if(this.compareSelector(u[c].key)===i){var a=new n(r,o);return this.entryList.replace(u[c],a),u[c]=a,!0}return!1},contains:function(n){var r=this.compareSelector(n),o=e(r);if(!t(this.buckets,o))return!1;for(var i=this.buckets[o],s=0;s<i.length;s++)if(this.compareSelector(i[s].key)===r)return!0;return!1},clear:function(){this.countField=0,this.buckets={},this.entryList=new r},remove:function(n){var r=this.compareSelector(n),o=e(r);if(t(this.buckets,o))for(var i=this.buckets[o],s=0;s<i.length;s++)if(this.compareSelector(i[s].key)===r)return this.entryList.remove(i[s]),i.splice(s,1),0==i.length&&delete this.buckets[o],void this.countField--},count:function(){return this.countField},toEnumerable:function(){var t=this;return new d(function(){var e;return new h(function(){e=t.entryList.first},function(){if(null!=e){var t={key:e.key,value:e.value};return e=e.next,this.yieldReturn(t)}return!1},u.Blank)})}},o}(),E=function(t){this.count=function(){return t.count()},this.get=function(e){return d.from(t.get(e))},this.contains=function(e){return t.contains(e)},this.toEnumerable=function(){return t.toEnumerable().select(function(t){return new S(t.key,t.value)})}},S=function(t,e){this.key=function(){return t},b.call(this,e)};S.prototype=new b,"function"===c.Function&&n(51)?(r=[],void 0!==(o=function(){return d}.apply(e,r))&&(t.exports=o)):typeof t!==c.Undefined&&t.exports?t.exports=d:i.Enumerable=d}(this)},function(t,e,n){function r(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function o(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},n=t.name||"Function wrapped with `once`";return e.onceError=n+" shouldn't be called more than once",e.called=!1,e}var i=n(135);t.exports=i(r),t.exports.strict=i(o),r.proto=r(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return r(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(t,e,n){!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else{t.exports=e()}}(function(){"use strict";function t(t){return function(){return H.apply(t,arguments)}}function e(t){return t===Object(t)}function r(t){return"[object StopIteration]"===nt(t)||t instanceof z}function o(t,e){if(U&&e.stack&&"object"==typeof t&&null!==t&&t.stack){for(var n=[],r=e;r;r=r.source)r.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>r.stackCounter)&&(Z(t,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),n.unshift(r.stack));n.unshift(t.stack);var o=n.join("\n"+rt+"\n"),s=i(o);Z(t,"stack",{value:s,configurable:!0})}}function i(t){for(var e=t.split("\n"),n=[],r=0;r<e.length;++r){var o=e[r];c(o)||s(o)||!o||n.push(o)}return n.join("\n")}function s(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function u(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function c(t){var e=u(t);if(!e)return!1;var n=e[0],r=e[1];return n===F&&r>=K&&r<=at}function a(){if(U)try{throw new Error}catch(r){var t=r.stack.split("\n"),e=t[0].indexOf("@")>0?t[1]:t[2],n=u(e);if(!n)return;return F=n[0],n[1]}}function l(t){return t instanceof d?t:b(t)?N(t):A(t)}function f(){function t(t){e=t,l.longStackSupport&&U&&(i.source=t),$(n,function(e,n){l.nextTick(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,r=void 0}var e,n=[],r=[],o=X(f.prototype),i=X(d.prototype);if(i.promiseDispatch=function(t,o,i){var s=G(arguments);n?(n.push(s),"when"===o&&i[1]&&r.push(i[1])):l.nextTick(function(){e.promiseDispatch.apply(e,s)})},i.valueOf=function(){if(n)return i;var t=m(e);return y(t)&&(e=t),t},i.inspect=function(){return e?e.inspect():{state:"pending"}},l.longStackSupport&&U)try{throw new Error}catch(t){i.stack=t.stack.substring(t.stack.indexOf("\n")+1),i.stackCounter=ot++}return o.promise=i,o.resolve=function(n){e||t(l(n))},o.fulfill=function(n){e||t(A(n))},o.reject=function(n){e||t(C(n))},o.notify=function(t){e||$(r,function(e,n){l.nextTick(function(){n(t)})},void 0)},o}function h(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=f();try{t(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}return e.promise}function p(t){return h(function(e,n){for(var r=0,o=t.length;r<o;r++)l(t[r]).then(e,n)})}function d(t,e,n){void 0===e&&(e=function(t){return C(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=X(d.prototype);if(r.promiseDispatch=function(n,o,i){var s;try{s=t[o]?t[o].apply(r,i):e.call(r,o,i)}catch(t){s=C(t)}n&&n(s)},r.inspect=n,n){var o=n();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function v(t,e,n,r){return l(t).then(e,n,r)}function m(t){if(y(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function y(t){return t instanceof d}function b(t){return e(t)&&"function"==typeof t.then}function g(t){return y(t)&&"pending"===t.inspect().state}function w(t){return!y(t)||"fulfilled"===t.inspect().state}function x(t){return y(t)&&"rejected"===t.inspect().state}function E(){it.length=0,st.length=0,ct||(ct=!0)}function S(t,e){ct&&("object"==typeof process&&"function"==typeof process.emit&&l.nextTick.runAfter(function(){-1!==Q(st,t)&&(process.emit("unhandledRejection",e,t),ut.push(t))}),st.push(t),e&&void 0!==e.stack?it.push(e.stack):it.push("(no stack) "+e))}function k(t){if(ct){var e=Q(st,t);-1!==e&&("object"==typeof process&&"function"==typeof process.emit&&l.nextTick.runAfter(function(){var n=Q(ut,t);-1!==n&&(process.emit("rejectionHandled",it[e],t),ut.splice(n,1))}),st.splice(e,1),it.splice(e,1))}}function C(t){var e=d({when:function(e){return e&&k(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return S(e,t),e}function A(t){return d({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},delete:function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return et(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function N(t){var e=f();return l.nextTick(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}}),e.promise}function _(t){return d({isDef:function(){}},function(e,n){return L(t,e,n)},function(){return l(t).inspect()})}function T(t,e,n){return l(t).spread(e,n)}function O(t){return function(){function e(t,e){var s;if("undefined"==typeof StopIteration){try{s=n[t](e)}catch(t){return C(t)}return s.done?l(s.value):v(s.value,o,i)}try{s=n[t](e)}catch(t){return r(t)?l(t.value):C(t)}return v(s,o,i)}var n=t.apply(this,arguments),o=e.bind(e,"next"),i=e.bind(e,"throw");return o()}}function R(t){l.done(l.async(t)())}function D(t){throw new z(t)}function j(t){return function(){return T([this,P(arguments)],function(e,n){return t.apply(e,n)})}}function L(t,e,n){return l(t).dispatch(e,n)}function P(t){return v(t,function(t){var e=0,n=f();return $(t,function(r,o,i){var s;y(o)&&"fulfilled"===(s=o.inspect()).state?t[i]=s.value:(++e,v(o,function(r){t[i]=r,0==--e&&n.resolve(t)},n.reject,function(t){n.notify({index:i,value:t})}))},void 0),0===e&&n.resolve(t),n.promise})}function I(t){if(0===t.length)return l.resolve();var e=l.defer(),n=0;return $(t,function(r,o,i){function s(t){e.resolve(t)}function u(t){0===--n&&(t.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+t.message,e.reject(t))}function c(t){e.notify({index:i,value:t})}var a=t[i];n++,v(a,s,u,c)},void 0),e.promise}function q(t){return v(t,function(t){return t=Y(t,l),v(P(Y(t,function(t){return v(t,V,V)})),function(){return t})})}function W(t){return l(t).allSettled()}function M(t,e){return l(t).then(void 0,void 0,e)}function B(t,e){return l(t).nodeify(e)}var U=!1;try{throw new Error}catch(t){U=!!t.stack}var F,z,K=a(),V=function(){},J=function(){function t(){for(var t,r;n.next;)n=n.next,t=n.task,n.task=void 0,r=n.domain,r&&(n.domain=void 0,r.enter()),e(t,r);for(;u.length;)t=u.pop(),e(t);o=!1}function e(e,n){try{e()}catch(e){if(s)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),e;setTimeout(function(){throw e},0)}n&&n.exit()}var n={task:void 0,next:null},r=n,o=!1,i=void 0,s=!1,u=[];if(J=function(t){r=r.next={task:t,domain:s&&process.domain,next:null},o||(o=!0,i())},"object"==typeof process&&"[object process]"===process.toString()&&process.nextTick)s=!0,i=function(){process.nextTick(t)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var c=new MessageChannel;c.port1.onmessage=function(){i=a,c.port1.onmessage=t,t()};var a=function(){c.port2.postMessage(0)};i=function(){setTimeout(t,0),a()}}else i=function(){setTimeout(t,0)};return J.runAfter=function(t){u.push(t),o||(o=!0,i())},J}(),H=Function.call,G=t(Array.prototype.slice),$=t(Array.prototype.reduce||function(t,e){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(e=t(e,this[n],n));return e}),Q=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),Y=t(Array.prototype.map||function(t,e){var n=this,r=[];return $(n,function(o,i,s){r.push(t.call(e,i,s,n))},void 0),r}),X=Object.create||function(t){function e(){}return e.prototype=t,new e},Z=Object.defineProperty||function(t,e,n){return t[e]=n.value,t},tt=t(Object.prototype.hasOwnProperty),et=Object.keys||function(t){var e=[];for(var n in t)tt(t,n)&&e.push(n);return e},nt=t(Object.prototype.toString);z="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var rt="From previous event:";l.resolve=l,l.nextTick=J,l.longStackSupport=!1;var ot=1;"object"==typeof process&&process&&n.i({NODE_ENV:"production",CLIENT_VERSION:"1.6.0"})&&n.i({NODE_ENV:"production",CLIENT_VERSION:"1.6.0"}).Q_DEBUG&&(l.longStackSupport=!0),l.defer=f,f.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(G(arguments,1)):t.resolve(n)}},l.Promise=h,l.promise=h,h.race=p,h.all=P,h.reject=C,h.resolve=l,l.passByCopy=function(t){return t},d.prototype.passByCopy=function(){return this},l.join=function(t,e){return l(t).join(e)},d.prototype.join=function(t){return l([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Q can't join: not the same: "+t+" "+e)})},l.race=p,d.prototype.race=function(){return this.then(l.race)},l.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(t,e,n){function r(e){try{return"function"==typeof t?t(e):e}catch(t){return C(t)}}function i(t){if("function"==typeof e){o(t,u);try{return e(t)}catch(t){return C(t)}}return C(t)}function s(t){return"function"==typeof n?n(t):t}var u=this,c=f(),a=!1;return l.nextTick(function(){u.promiseDispatch(function(t){a||(a=!0,c.resolve(r(t)))},"when",[function(t){a||(a=!0,c.resolve(i(t)))}])}),u.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=s(t)}catch(t){if(n=!0,!l.onerror)throw t;l.onerror(t)}n||c.notify(e)}]),c.promise},l.tap=function(t,e){return l(t).tap(e)},d.prototype.tap=function(t){return t=l(t),this.then(function(e){return t.fcall(e).thenResolve(e)})},l.when=v,d.prototype.thenResolve=function(t){return this.then(function(){return t})},l.thenResolve=function(t,e){return l(t).thenResolve(e)},d.prototype.thenReject=function(t){return this.then(function(){throw t})},l.thenReject=function(t,e){return l(t).thenReject(e)},l.nearer=m,l.isPromise=y,l.isPromiseAlike=b,l.isPending=g,d.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=w,d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=x,d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var it=[],st=[],ut=[],ct=!0;l.resetUnhandledRejections=E,l.getUnhandledReasons=function(){return it.slice()},l.stopUnhandledRejectionTracking=function(){E(),ct=!1},E(),l.reject=C,l.fulfill=A,l.master=_,l.spread=T,d.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},l.async=O,l.spawn=R,l.return=D,l.promised=j,l.dispatch=L,d.prototype.dispatch=function(t,e){var n=this,r=f();return l.nextTick(function(){n.promiseDispatch(r.resolve,t,e)}),r.promise},l.get=function(t,e){return l(t).dispatch("get",[e])},d.prototype.get=function(t){return this.dispatch("get",[t])},l.set=function(t,e,n){return l(t).dispatch("set",[e,n])},d.prototype.set=function(t,e){return this.dispatch("set",[t,e])},l.del=l.delete=function(t,e){return l(t).dispatch("delete",[e])},d.prototype.del=d.prototype.delete=function(t){return this.dispatch("delete",[t])},l.mapply=l.post=function(t,e,n){return l(t).dispatch("post",[e,n])},d.prototype.mapply=d.prototype.post=function(t,e){return this.dispatch("post",[t,e])},l.send=l.mcall=l.invoke=function(t,e){return l(t).dispatch("post",[e,G(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(t){return this.dispatch("post",[t,G(arguments,1)])},l.fapply=function(t,e){return l(t).dispatch("apply",[void 0,e])},d.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},l.try=l.fcall=function(t){return l(t).dispatch("apply",[void 0,G(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,G(arguments)])},l.fbind=function(t){var e=l(t),n=G(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(G(arguments))])}},d.prototype.fbind=function(){var t=this,e=G(arguments);return function(){return t.dispatch("apply",[this,e.concat(G(arguments))])}},l.keys=function(t){return l(t).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},l.all=P,d.prototype.all=function(){return P(this)},l.any=I,d.prototype.any=function(){return I(this)},l.allResolved=function(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",new Error("").stack),t.apply(t,arguments)}}(q,"allResolved","allSettled"),d.prototype.allResolved=function(){return q(this)},l.allSettled=W,d.prototype.allSettled=function(){return this.then(function(t){return P(Y(t,function(t){function e(){return t.inspect()}return t=l(t),t.then(e,e)}))})},l.fail=l.catch=function(t,e){return l(t).then(void 0,e)},d.prototype.fail=d.prototype.catch=function(t){return this.then(void 0,t)},l.progress=M,d.prototype.progress=function(t){return this.then(void 0,void 0,t)},l.fin=l.finally=function(t,e){return l(t).finally(e)},d.prototype.fin=d.prototype.finally=function(t){if(!t||"function"!=typeof t.apply)throw new Error("Q can't apply finally callback");return t=l(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},l.done=function(t,e,n,r){return l(t).done(e,n,r)},d.prototype.done=function(t,e,n){var r=function(t){l.nextTick(function(){if(o(t,i),!l.onerror)throw t;l.onerror(t)})},i=t||e||n?this.then(t,e,n):this;"object"==typeof process&&process&&process.domain&&(r=process.domain.bind(r)),i.then(void 0,r)},l.timeout=function(t,e,n){return l(t).timeout(e,n)},d.prototype.timeout=function(t,e){var n=f(),r=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+t+" ms"),e.code="ETIMEDOUT"),n.reject(e)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},l.delay=function(t,e){return void 0===e&&(e=t,t=void 0),l(t).delay(e)},d.prototype.delay=function(t){return this.then(function(e){var n=f();return setTimeout(function(){n.resolve(e)},t),n.promise})},l.nfapply=function(t,e){return l(t).nfapply(e)},d.prototype.nfapply=function(t){var e=f(),n=G(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},l.nfcall=function(t){var e=G(arguments,1);return l(t).nfapply(e)},d.prototype.nfcall=function(){var t=G(arguments),e=f();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},l.nfbind=l.denodeify=function(t){if(void 0===t)throw new Error("Q can't wrap an undefined function");var e=G(arguments,1);return function(){var n=e.concat(G(arguments)),r=f();return n.push(r.makeNodeResolver()),l(t).fapply(n).fail(r.reject),r.promise}},d.prototype.nfbind=d.prototype.denodeify=function(){var t=G(arguments);return t.unshift(this),l.denodeify.apply(void 0,t)},l.nbind=function(t,e){var n=G(arguments,2);return function(){function r(){return t.apply(e,arguments)}var o=n.concat(G(arguments)),i=f();return o.push(i.makeNodeResolver()),l(r).fapply(o).fail(i.reject),i.promise}},d.prototype.nbind=function(){var t=G(arguments,0);return t.unshift(this),l.nbind.apply(void 0,t)},l.nmapply=l.npost=function(t,e,n){return l(t).npost(e,n)},d.prototype.nmapply=d.prototype.npost=function(t,e){var n=G(e||[]),r=f();return n.push(r.makeNodeResolver()),this.dispatch("post",[t,n]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(t,e){var n=G(arguments,2),r=f();return n.push(r.makeNodeResolver()),l(t).dispatch("post",[e,n]).fail(r.reject),r.promise},d.prototype.nsend=d.prototype.nmcall=d.prototype.ninvoke=function(t){var e=G(arguments,1),n=f();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},l.nodeify=B,d.prototype.nodeify=function(t){if(!t)return this;this.then(function(e){l.nextTick(function(){t(null,e)})},function(e){l.nextTick(function(){t(e)})})},l.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var at=a();return l})},function(t,e){t.exports=require("async@2.1.2")},function(t,e){t.exports=require("aws-sdk")},function(t,e){t.exports=require("body-parser@1.12.4")},function(t,e){t.exports=require("cookie-signature")},function(t,e){t.exports=require("crypto")},function(t,e){t.exports=require("ejs@2.3.1")},function(t,e){t.exports=require("events")},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("lru-memoizer@1.10.0")},function(t,e){t.exports=require("moment@2.10.3")},function(t,e){t.exports=require("morgan@1.5.3")},function(t,e){t.exports=require("ms@0.7.1")},function(t,e){t.exports=require("querystring")},function(t,e){t.exports=require("stream")},function(t,e){t.exports=require("webtask-tools")},function(t,e){t.exports=require("winston@1.0.0")},function(t,e){t.exports=require("wrappy")}]);